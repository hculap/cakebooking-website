<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wizualizator Tort√≥w AI | CakeBooking</title>
  <meta name="description" content="Zaprojektuj sw√≥j wymarzony tort z AI! Interaktywny wizualizator generuje realistyczne obrazy na podstawie Twoich wybor√≥w.">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  

  
  <!-- Custom CSS -->
  <link rel="stylesheet" href="styles.css">
  <style>
    #image-container {
      border-radius: 16px;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    }
    
    .control-panel {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 16px;
      border: 1px solid rgba(244, 114, 182, 0.2);
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
    }
    
    .control-section {
      border-bottom: 1px solid rgba(244, 114, 182, 0.1);
    }
    
    .control-section:last-child {
      border-bottom: none;
    }
    
    .option-button {
      transition: all 0.3s ease;
      border: 2px solid transparent;
      background: rgba(244, 114, 182, 0.1);
      color: #2d3748;
    }
    
    .option-button:hover {
      background: rgba(244, 114, 182, 0.2);
      transform: translateY(-2px);
    }
    
    .option-button.active {
      background: linear-gradient(135deg, var(--champagne-gold-start), var(--playful-pink));
      color: white;
      border-color: var(--playful-pink);
      box-shadow: 0 8px 25px rgba(244, 114, 182, 0.3);
    }
    
    .color-swatch {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 3px solid white;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .color-swatch:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    }
    
    .color-swatch.active {
      border-color: var(--playful-pink);
      border-width: 4px;
      transform: scale(1.15);
    }

    /* Navigation Dropdown Styles */
    .group:hover .group-hover\:rotate-180 {
      transform: rotate(180deg);
    }

    /* Ensure dropdowns appear above other content */
    .relative.group {
      z-index: 50;
    }

    /* Smooth dropdown animations */
    .group:hover .group-hover\:opacity-100 {
      transition-delay: 0.1s;
    }

    /* Mobile menu improvements */
    #mobile-menu {
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    /* Sticky positioning improvements */
    .sticky {
      position: -webkit-sticky;
      position: sticky;
    }
    
    /* Ensure the sticky element has proper z-index */
    .sticky.top-0 {
      z-index: 10;
    }
  </style>
</head>
<body class="font-sans text-midnight-navy pb-24 md:pb-0">
  <!-- Navigation -->
  <nav class="fixed w-full nav-midnight shadow-sm z-50">
    <div class="max-w-7xl mx-auto px-6 lg:px-8">
      <div class="flex justify-between h-16">
        <div class="flex items-center">
          <a href="index.html" aria-label="CakeBooking - Strona g≈Ç√≥wna" class="flex-shrink-0 flex items-center">
            <i class="fa-solid fa-cake-candles icon-gradient-gold-pink text-3xl mr-3"></i>
            <span class="font-display font-bold text-3xl text-pure-white">CakeBooking</span>
          </a>
        </div>
        
        <!-- Desktop Navigation -->
        <div class="hidden lg:flex items-center space-x-6">
          <!-- Main Menu Items -->
          <div class="relative group">
            <button class="flex items-center text-dove-gray hover:text-playful-pink px-3 py-2 text-sm font-medium transition-colors">
              <span>Produkty</span>
              <i class="fa-solid fa-chevron-down ml-1 text-xs transition-transform group-hover:rotate-180"></i>
            </button>
            <!-- Dropdown Menu -->
            <div class="absolute top-full left-0 mt-2 w-64 bg-white rounded-xl shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 transform origin-top scale-95 group-hover:scale-100 border border-gray-100">
              <div class="py-2">
                <a href="wizualizator-tortow.html" class="flex items-center px-4 py-3 text-sm text-midnight-navy hover:bg-playful-pink/10 transition-colors">
                  <i class="fa-solid fa-palette w-5 h-5 mr-3 icon-gradient-gold-pink"></i>
                  <div>
                    <div class="font-medium">Wizualizator 3D</div>
                    <div class="text-xs text-dove-gray">Projektuj w≈Çasny tort</div>
                  </div>
                </a>
                <a href="gotowy-tort.html" class="flex items-center px-4 py-3 text-sm text-midnight-navy hover:bg-playful-pink/10 transition-colors">
                  <i class="fa-solid fa-thumbs-up w-5 h-5 mr-3 icon-gradient-gold-pink"></i>
                  <div>
                    <div class="font-medium">Gotowe torty</div>
                    <div class="text-xs text-dove-gray">Wybierz z gotowych propozycji</div>
                  </div>
                </a>
                <a href="index.html#features" class="flex items-center px-4 py-3 text-sm text-midnight-navy hover:bg-playful-pink/10 transition-colors">
                  <i class="fa-solid fa-star w-5 h-5 mr-3 icon-gradient-gold-pink"></i>
                  <div>
                    <div class="font-medium">Funkcje</div>
                    <div class="text-xs text-dove-gray">Poznaj mo≈ºliwo≈õci</div>
                  </div>
                </a>
              </div>
            </div>
          </div>

          <div class="relative group">
            <button class="flex items-center text-dove-gray hover:text-playful-pink px-3 py-2 text-sm font-medium transition-colors">
              <span>Firma</span>
              <i class="fa-solid fa-chevron-down ml-1 text-xs transition-transform group-hover:rotate-180"></i>
            </button>
            <!-- Dropdown Menu -->
            <div class="absolute top-full left-0 mt-2 w-64 bg-white rounded-xl shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 transform origin-top scale-95 group-hover:scale-100 border border-gray-100">
              <div class="py-2">
                <a href="o-nas.html" class="flex items-center px-4 py-3 text-sm text-midnight-navy hover:bg-playful-pink/10 transition-colors">
                  <i class="fa-solid fa-users w-5 h-5 mr-3 icon-gradient-gold-pink"></i>
                  <div>
                    <div class="font-medium">O nas</div>
                    <div class="text-xs text-dove-gray">Poznaj naszƒÖ historiƒô</div>
                  </div>
                </a>
                <a href="index.html#for-bakers-section" class="flex items-center px-4 py-3 text-sm text-midnight-navy hover:bg-playful-pink/10 transition-colors">
                  <i class="fa-solid fa-store w-5 h-5 mr-3 icon-gradient-gold-pink"></i>
                  <div>
                    <div class="font-medium">Dla cukiernik√≥w</div>
                    <div class="text-xs text-dove-gray">Do≈ÇƒÖcz do platformy</div>
                  </div>
                </a>
                <a href="blog.html" class="flex items-center px-4 py-3 text-sm text-midnight-navy hover:bg-playful-pink/10 transition-colors">
                  <i class="fa-solid fa-blog w-5 h-5 mr-3 icon-gradient-gold-pink"></i>
                  <div>
                    <div class="font-medium">Blog</div>
                    <div class="text-xs text-dove-gray">Inspiracje i porady</div>
                  </div>
                </a>
              </div>
            </div>
          </div>

          <a href="index.html#how-it-works" class="text-dove-gray hover:text-playful-pink px-3 py-2 text-sm font-medium transition-colors">Jak to dzia≈Ça</a>
          <a href="index.html#faq" class="text-dove-gray hover:text-playful-pink px-3 py-2 text-sm font-medium transition-colors">FAQ</a>
          <a href="kontakt.html" class="text-dove-gray hover:text-playful-pink px-3 py-2 text-sm font-medium transition-colors">Kontakt</a>
          
          <!-- CTA Button -->
          <a href="zamowienie.html" class="pill-button-pink flex items-center justify-center text-white no-underline">
            <i class="fa-solid fa-cake-candles h-4 w-4 mr-2"></i>
            Zam√≥w tort
          </a>
        </div>

        <!-- Mobile menu button -->
        <div class="lg:hidden flex items-center">
          <button id="mobile-menu-button"
                  aria-label="Otw√≥rz menu nawigacyjne"
                  aria-expanded="false"
                  aria-controls="mobile-menu"
                  class="inline-flex items-center justify-center p-2 rounded-md text-dove-gray hover:text-playful-pink hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-playful-pink transition-colors">
            <i class="fa-solid fa-bars h-6 w-6"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Mobile menu -->
    <div id="mobile-menu" class="hidden lg:hidden bg-midnight-navy shadow-lg">
      <div class="px-4 py-6 space-y-4">
        <!-- Products Section -->
        <div class="space-y-2">
          <div class="text-xs font-semibold icon-gradient-gold-pink uppercase tracking-wider mb-3">Produkty</div>
          <a href="wizualizator-tortow.html" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-palette w-5 h-5 mr-3"></i>
            Wizualizator 3D
          </a>
          <a href="gotowy-tort.html" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-thumbs-up w-5 h-5 mr-3"></i>
            Gotowe torty
          </a>
          <a href="index.html#features" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-star w-5 h-5 mr-3"></i>
            Funkcje
          </a>
        </div>

        <!-- Company Section -->
        <div class="space-y-2">
          <div class="text-xs font-semibold icon-gradient-gold-pink uppercase tracking-wider mb-3">Firma</div>
          <a href="o-nas.html" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-users w-5 h-5 mr-3"></i>
            O nas
          </a>
          <a href="index.html#for-bakers-section" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-store w-5 h-5 mr-3"></i>
            Dla cukiernik√≥w
          </a>
          <a href="blog.html" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-blog w-5 h-5 mr-3"></i>
            Blog
          </a>
        </div>

        <!-- Other Links -->
        <div class="space-y-2">
          <div class="text-xs font-semibold icon-gradient-gold-pink uppercase tracking-wider mb-3">Pomoc</div>
          <a href="index.html#how-it-works" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-circle-info w-5 h-5 mr-3"></i>
            Jak to dzia≈Ça
          </a>
          <a href="index.html#faq" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-question-circle w-5 h-5 mr-3"></i>
            FAQ
          </a>
          <a href="kontakt.html" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-envelope w-5 h-5 mr-3"></i>
            Kontakt
          </a>
        </div>

        <!-- CTA Button -->
        <div class="pt-4 border-t border-dove-gray/20">
          <a href="zamowienie.html" class="w-full pill-button-pink flex items-center justify-center text-white text-base font-medium px-6 py-3 shadow-lg no-underline">
            <i class="fa-solid fa-cake-candles h-5 w-5 mr-3"></i>
            Zam√≥w tort
          </a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="pt-32 pb-16 hero-gradient text-pure-white relative overflow-hidden">
    <!-- Art Deco Elements -->
    <div class="parallax-element" data-speed="0.3" style="position: absolute; left: 48px; top: 128px; z-index: 1;">
      <div class="art-deco-line"></div>
    </div>
    <div class="parallax-element" data-speed="0.4" style="position: absolute; right: 48px; top: 160px; z-index: 1;">
      <div class="art-deco-line"></div>
    </div>
    
    <!-- Sparkles -->
    <div class="parallax-element" data-speed="0.5" style="position: absolute; top: 20%; left: 10%;">
      <div class="sparkle sparkle-enhanced" style="animation-delay: 0s;">‚ú¶</div>
    </div>
    <div class="parallax-element" data-speed="0.3" style="position: absolute; top: 30%; right: 15%;">
      <div class="sparkle sparkle-enhanced" style="animation-delay: 0.3s;">‚úß</div>
    </div>
    
    <div class="max-w-7xl mx-auto px-6 lg:px-8 relative z-10">
      <div class="text-center">
        <h1 class="font-display text-4xl md:text-5xl lg:text-6xl font-bold text-pure-white leading-tight mb-6">
          Wizualizator <span class="icon-gradient-gold-pink">Tort√≥w 3D</span>
        </h1>
        <p class="text-xl text-dove-gray leading-relaxed max-w-3xl mx-auto mb-8">
          Zaprojektuj sw√≥j wymarzony tort w interaktywnym ≈õrodowisku 3D. Wybierz rozmiar, smak, kolor i dekoracje, a zobaczysz rezultat w czasie rzeczywistym.
        </p>
        <div class="flex items-center justify-center space-x-6 text-sm text-dove-gray">
          <span><i class="fa-solid fa-robot mr-2 icon-gradient-gold-pink"></i>Generowanie AI</span>
          <span><i class="fa-solid fa-palette mr-2 icon-gradient-gold-pink"></i>Personalizacja</span>
          <span><i class="fa-solid fa-magic mr-2 icon-gradient-gold-pink"></i>Realistyczne obrazy</span>
        </div>
      </div>
    </div>
  </section>

  <!-- Main Visualizer Section -->
  <section class="py-20 pb-40 bg-porcelain-white relative">
    <!-- Art Deco Elements -->
    <div class="parallax-element" data-speed="0.2" style="position: absolute; left: 32px; top: 200px; z-index: 0; opacity: 0.5;">
      <div class="art-deco-dot"></div>
    </div>
    <div class="parallax-element" data-speed="0.6" style="position: absolute; right: 32px; bottom: 200px; z-index: 0; opacity: 0.5;">
      <div class="art-deco-dot"></div>
    </div>
    
    <div class="max-w-7xl mx-auto px-6 lg:px-8">
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        
        <!-- AI Image Generator -->
        <div class="lg:col-span-2">
          <div class="relative sticky top-32">
            <!-- Image Display Area -->
            <div id="image-container" class="w-full bg-gray-100 rounded-2xl overflow-hidden" style="aspect-ratio: 1; max-width: 600px; margin: 0 auto; display: flex; align-items: center; justify-content: center;">
              <!-- Placeholder -->
              <div id="placeholder" class="text-center">
                <div class="w-32 h-32 mx-auto mb-4 bg-gray-200 rounded-full flex items-center justify-center">
                  <i class="fa-solid fa-cake-candles text-6xl text-gray-400"></i>
                </div>
                <h3 class="text-xl font-semibold text-gray-600 mb-2">Wizualizacja Twojego tortu</h3>
                <p class="text-gray-500">Wybierz opcje i kliknij "Generuj obraz" aby zobaczyƒá sw√≥j tort</p>
              </div>
              
              <!-- Loading State -->
              <div id="loading" class="text-center hidden">
                <div class="w-32 h-32 mx-auto mb-4 bg-champagne-gold/20 rounded-full flex items-center justify-center">
                  <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-playful-pink"></div>
                </div>
                <h3 class="text-xl font-semibold text-midnight-navy mb-2">Generujƒô obraz...</h3>
                <p class="text-dove-gray">To mo≈ºe potrwaƒá kilka sekund</p>
              </div>
              
              <!-- Generated Image -->
              <img id="generated-image" class="w-full h-full object-cover hidden" alt="Wygenerowany tort">
            </div>
            
            <!-- Generate Button -->
            <div class="mt-6 text-center">
              <button 
                id="generate-btn" 
                class="pill-button-pink text-white no-underline inline-flex items-center justify-center">
                <i class="fa-solid fa-magic h-5 w-5 mr-3"></i>
                Generuj obraz tortu
              </button>
              <p class="text-sm text-dove-gray mt-2">
                <i class="fa-solid fa-info-circle mr-1"></i>
                Obraz zostanie wygenerowany przez AI na podstawie Twoich wybor√≥w
              </p>
            </div>
          </div>
          

        </div>

        <!-- Control Panel -->
        <div class="lg:col-span-1">
          <div class="control-panel p-6 overflow-y-auto">
            <h3 class="font-display text-2xl font-bold text-midnight-navy mb-6 text-center">
              <i class="fa-solid fa-sliders mr-3 icon-gradient-gold-pink"></i>
              Personalizuj Tort
            </h3>

            <!-- Size Selection -->
            <div class="control-section pb-6 mb-6">
              <h4 class="font-semibold text-midnight-navy mb-4 flex items-center">
                <i class="fa-solid fa-resize mr-3 icon-gradient-gold-pink"></i>
                Rozmiar
              </h4>
              <div class="grid grid-cols-3 gap-3">
                <button class="option-button active py-3 px-4 rounded-lg text-sm font-medium" data-size="small">
                  <div class="text-center">
                    <div class="text-lg mb-1">üç∞</div>
                    <div>Ma≈Çy</div>
                    <div class="text-xs opacity-75">6-8 os√≥b</div>
                  </div>
                </button>
                <button class="option-button py-3 px-4 rounded-lg text-sm font-medium" data-size="medium">
                  <div class="text-center">
                    <div class="text-lg mb-1">üéÇ</div>
                    <div>≈öredni</div>
                    <div class="text-xs opacity-75">10-12 os√≥b</div>
                  </div>
                </button>
                <button class="option-button py-3 px-4 rounded-lg text-sm font-medium" data-size="large">
                  <div class="text-center">
                    <div class="text-lg mb-1">üéÇ</div>
                    <div>Du≈ºy</div>
                    <div class="text-xs opacity-75">15-20 os√≥b</div>
                  </div>
                </button>
              </div>
            </div>

            <!-- Number of Layers -->
            <div class="control-section pb-6 mb-6">
              <h4 class="font-semibold text-midnight-navy mb-4 flex items-center">
                <i class="fa-solid fa-layer-group mr-3 icon-gradient-gold-pink"></i>
                Liczba warstw <span class="text-red-500">*</span>
              </h4>
              <div class="relative">
                <input 
                  type="number" 
                  id="cake-layers" 
                  min="1" 
                  max="5" 
                  value="2" 
                  class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-playful-pink focus:border-transparent"
                  placeholder="Wprowad≈∫ liczbƒô warstw (1-5)">
                <div class="mt-2 text-xs text-dove-gray">
                  1-5 warstw ‚Ä¢ Wp≈Çywa na wysoko≈õƒá i strukturƒô tortu
                </div>
              </div>
            </div>

            <!-- Cake Text -->
            <div class="control-section pb-6 mb-6">
              <h4 class="font-semibold text-midnight-navy mb-4 flex items-center">
                <i class="fa-solid fa-font mr-3 icon-gradient-gold-pink"></i>
                Napis na torcie <span class="text-gray-400">(opcjonalnie)</span>
              </h4>
              <input 
                type="text" 
                id="cake-text" 
                maxlength="50" 
                class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-playful-pink focus:border-transparent"
                placeholder="np. Wszystkiego najlepszego, Gratulacje...">
              <div class="mt-2 text-xs text-dove-gray">
                Maksymalnie 50 znak√≥w ‚Ä¢ Zostanie umieszczony na g√≥rze tortu
              </div>
            </div>

            <!-- Occasion Selection -->
            <div class="control-section pb-6 mb-6">
              <h4 class="font-semibold text-midnight-navy mb-4 flex items-center">
                <i class="fa-solid fa-star mr-3 icon-gradient-gold-pink"></i>
                Okazja
              </h4>
              <div class="space-y-2">
                <button class="option-button active w-full py-3 px-4 rounded-lg text-sm font-medium text-left" data-occasion="birthday">
                  üéâ Urodziny
                </button>
                <button class="option-button w-full py-3 px-4 rounded-lg text-sm font-medium text-left" data-occasion="wedding">
                  üíí ≈ölub
                </button>
                <button class="option-button w-full py-3 px-4 rounded-lg text-sm font-medium text-left" data-occasion="anniversary">
                  üíï Rocznica
                </button>
                <button class="option-button w-full py-3 px-4 rounded-lg text-sm font-medium text-left" data-occasion="graduation">
                  üéì Uko≈Ñczenie szko≈Çy
                </button>
                <button class="option-button w-full py-3 px-4 rounded-lg text-sm font-medium text-left" data-occasion="celebration">
                  üåü Inna okazja
                </button>
              </div>
            </div>

            <!-- Color Selection -->
            <div class="control-section pb-6 mb-6">
              <h4 class="font-semibold text-midnight-navy mb-4 flex items-center">
                <i class="fa-solid fa-palette mr-3 icon-gradient-gold-pink"></i>
                Kolor g≈Ç√≥wny
              </h4>
              <div class="grid grid-cols-5 gap-3">
                <div class="color-swatch active" style="background: #ffffff;" data-color="white" title="Bia≈Çy"></div>
                <div class="color-swatch" style="background: #f8b4d1;" data-color="pink" title="R√≥≈ºowy"></div>
                <div class="color-swatch" style="background: #6b73ff;" data-color="blue" title="Niebieski"></div>
                <div class="color-swatch" style="background: #9ccc65;" data-color="green" title="Zielony"></div>
                <div class="color-swatch" style="background: #ffa726;" data-color="orange" title="Pomara≈Ñczowy"></div>
                <div class="color-swatch" style="background: #8d6e63;" data-color="brown" title="BrƒÖzowy"></div>
                <div class="color-swatch" style="background: #e91e63;" data-color="red" title="Czerwony"></div>
                <div class="color-swatch" style="background: #9c27b0;" data-color="purple" title="Fioletowy"></div>
                <div class="color-swatch" style="background: #ffeb3b;" data-color="yellow" title="≈ª√≥≈Çty"></div>
                <div class="color-swatch" style="background: #424242;" data-color="black" title="Czarny"></div>
              </div>
            </div>

            <!-- Additional Color -->
            <div class="control-section pb-6 mb-6">
              <h4 class="font-semibold text-midnight-navy mb-4 flex items-center">
                <i class="fa-solid fa-brush mr-3 icon-gradient-gold-pink"></i>
                Kolor dodatkowy <span class="text-gray-400">(opcjonalnie)</span>
              </h4>
              <select 
                id="additional-color" 
                class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-playful-pink focus:border-transparent">
                <option value="">Brak dodatkowego koloru</option>
                <option value="gold">Z≈Çoty</option>
                <option value="silver">Srebrny</option>
                <option value="rose-gold">R√≥≈ºowe z≈Çoto</option>
                <option value="pearl">Per≈Çowy</option>
                <option value="copper">Miedziany</option>
                <option value="mint">Miƒôtowy</option>
                <option value="lavender">Lawendowy</option>
                <option value="coral">Koralowy</option>
                <option value="turquoise">Turkusowy</option>
                <option value="burgundy">Bordowy</option>
              </select>
              <div class="mt-2 text-xs text-dove-gray">
                Kolor akcent√≥w, obramowa≈Ñ lub dodatkowych element√≥w dekoracyjnych
              </div>
            </div>

            <!-- Special Theme -->
            <div class="control-section pb-6 mb-6">
              <h4 class="font-semibold text-midnight-navy mb-4 flex items-center">
                <i class="fa-solid fa-magic mr-3 icon-gradient-gold-pink"></i>
                Specjalny motyw <span class="text-gray-400">(opcjonalnie)</span>
              </h4>
              <input 
                type="text" 
                id="special-theme" 
                maxlength="100" 
                class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-playful-pink focus:border-transparent"
                placeholder="np. Jednoro≈ºce, Superheroes, Vintage, Minimalistyczny...">
              <div class="mt-2 text-xs text-dove-gray">
                Maksymalnie 100 znak√≥w ‚Ä¢ Opisz specjalny motyw lub styl tortu
              </div>
            </div>

            <!-- Flavor Selection -->
            <div class="control-section pb-6 mb-6">
              <h4 class="font-semibold text-midnight-navy mb-4 flex items-center">
                <i class="fa-solid fa-ice-cream mr-3 icon-gradient-gold-pink"></i>
                Smak
              </h4>
              <div class="space-y-2">
                <button class="option-button active w-full py-3 px-4 rounded-lg text-sm font-medium text-left" data-flavor="vanilla">
                  üç¶ Waniliowy
                </button>
                <button class="option-button w-full py-3 px-4 rounded-lg text-sm font-medium text-left" data-flavor="chocolate">
                  üç´ Czekoladowy
                </button>
                <button class="option-button w-full py-3 px-4 rounded-lg text-sm font-medium text-left" data-flavor="strawberry">
                  üçì Truskawkowy
                </button>
                <button class="option-button w-full py-3 px-4 rounded-lg text-sm font-medium text-left" data-flavor="lemon">
                  üçã Cytrynowy
                </button>
                <button class="option-button w-full py-3 px-4 rounded-lg text-sm font-medium text-left" data-flavor="carrot">
                  ü•ï Marchewkowy
                </button>
              </div>
            </div>

            <!-- Decorations -->
            <div class="control-section pb-6">
              <h4 class="font-semibold text-midnight-navy mb-4 flex items-center">
                <i class="fa-solid fa-magic mr-3 icon-gradient-gold-pink"></i>
                Dodatki
              </h4>
              <div class="space-y-2">
                <label class="flex items-center space-x-3 cursor-pointer">
                  <input type="checkbox" class="decoration-checkbox" data-decoration="candles" checked>
                  <span class="text-sm">üïØÔ∏è ≈öwieczki</span>
                </label>
                <label class="flex items-center space-x-3 cursor-pointer">
                  <input type="checkbox" class="decoration-checkbox" data-decoration="flowers">
                  <span class="text-sm">üå∏ Kwiaty cukrowe</span>
                </label>
                <label class="flex items-center space-x-3 cursor-pointer">
                  <input type="checkbox" class="decoration-checkbox" data-decoration="berries">
                  <span class="text-sm">ü´ê Owoce</span>
                </label>
                <label class="flex items-center space-x-3 cursor-pointer">
                  <input type="checkbox" class="decoration-checkbox" data-decoration="sprinkles">
                  <span class="text-sm">‚ú® Posypka</span>
                </label>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="pt-6 space-y-3">
              <button id="order-cake" class="w-full pill-button-secondary py-3 text-base font-medium">
                <i class="fa-solid fa-shopping-cart mr-2"></i>
                Zam√≥w ten tort
              </button>
            </div>

            <!-- Extra content for scroll space -->
            <div class="pt-12 pb-8">
              <div class="text-center text-dove-gray text-sm">
                <i class="fa-solid fa-info-circle mr-2"></i>
                Przewi≈Ñ w d√≥≈Ç, aby zobaczyƒá wiƒôcej opcji
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-midnight-navy text-dove-gray py-12">
    <div class="max-w-7xl mx-auto px-6 lg:px-8">
      <div class="grid grid-cols-1 lg:grid-cols-5 gap-8 mb-8">
        <!-- Brand -->
        <div class="lg:col-span-2">
          <div class="flex items-center mb-4">
            <a href="index.html" aria-label="CakeBooking - Strona g≈Ç√≥wna" class="flex items-center">
              <i class="fa-solid fa-cake-candles icon-gradient-gold-pink text-3xl mr-3"></i>
              <span class="font-display font-bold text-3xl text-pure-white">CakeBooking</span>
            </a>
          </div>
          <p class="text-dove-gray leading-relaxed mb-6 max-w-md">
            Koncepcja aplikacji ≈ÇƒÖczƒÖcej mi≈Ço≈õnik√≥w tort√≥w z najlepszymi cukierniami. Projektuj, zamawiaj i ciesz siƒô wymarzonym tortem.
          </p>
          <div class="flex space-x-3">
            <a href="#" aria-label="Facebook" class="text-dove-gray hover:text-playful-pink transition-colors">
              <i class="fa-brands fa-facebook-f h-5 w-5"></i>
            </a>
            <a href="#" aria-label="Twitter" class="text-dove-gray hover:text-playful-pink transition-colors">
              <i class="fa-brands fa-x-twitter h-5 w-5"></i>
            </a>
            <a href="#" aria-label="Instagram" class="text-dove-gray hover:text-playful-pink transition-colors">
              <i class="fa-brands fa-instagram h-5 w-5"></i>
            </a>
          </div>
        </div>

        <!-- Produkty -->
        <div>
          <h4 class="text-pure-white font-medium mb-4 flex items-center">
            <i class="fa-solid fa-cube mr-2 icon-gradient-gold-pink"></i>
            Produkty
          </h4>
          <ul class="space-y-2">
            <li><a href="wizualizator-tortow.html" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-palette mr-2 text-xs"></i>
              Wizualizator 3D
            </a></li>
            <li><a href="gotowy-tort.html" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-thumbs-up mr-2 text-xs"></i>
              Gotowe torty
            </a></li>
            <li><a href="index.html#features" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-star mr-2 text-xs"></i>
              Funkcje
            </a></li>
            <li><a href="zamowienie.html" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-cake-candles mr-2 text-xs"></i>
              Zam√≥w tort
            </a></li>
          </ul>
        </div>

        <!-- Firma -->
        <div>
          <h4 class="text-pure-white font-medium mb-4 flex items-center">
            <i class="fa-solid fa-building mr-2 icon-gradient-gold-pink"></i>
            Firma
          </h4>
          <ul class="space-y-2">
            <li><a href="o-nas.html" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-users mr-2 text-xs"></i>
              O nas
            </a></li>
            <li><a href="index.html#for-bakers-section" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-store mr-2 text-xs"></i>
              Dla cukiernik√≥w
            </a></li>
            <li><a href="blog.html" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-blog mr-2 text-xs"></i>
              Blog
            </a></li>
            <li><a href="#" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-handshake mr-2 text-xs"></i>
              Partnerzy
            </a></li>
          </ul>
        </div>

        <!-- Pomoc -->
        <div>
          <h4 class="text-pure-white font-medium mb-4 flex items-center">
            <i class="fa-solid fa-life-ring mr-2 icon-gradient-gold-pink"></i>
            Pomoc
          </h4>
          <ul class="space-y-2">
            <li><a href="index.html#how-it-works" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-circle-info mr-2 text-xs"></i>
              Jak to dzia≈Ça
            </a></li>
            <li><a href="index.html#faq" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-question-circle mr-2 text-xs"></i>
              FAQ
            </a></li>
            <li><a href="#" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-headset mr-2 text-xs"></i>
              Wsparcie
            </a></li>
            <li><a href="kontakt.html" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-envelope mr-2 text-xs"></i>
              Kontakt
            </a></li>
          </ul>
        </div>
      </div>

      <!-- Legal Links -->
      <div class="pt-6 border-t border-dove-gray/20 mb-6">
        <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
          <div class="flex flex-wrap justify-center md:justify-start space-x-6 text-sm">
            <a href="polityka-prywatnosci.html" class="hover:text-playful-pink transition-colors">Polityka prywatno≈õci</a>
            <a href="warunki-uzytkowania.html" class="hover:text-playful-pink transition-colors">Warunki u≈ºytkowania</a>
            <a href="regulamin.html" class="hover:text-playful-pink transition-colors">Regulamin</a>
            <a href="cookies.html" class="hover:text-playful-pink transition-colors">Cookies</a>
          </div>
          <div class="flex space-x-3">
            <a href="#" aria-label="LinkedIn" class="text-dove-gray hover:text-playful-pink transition-colors">
              <i class="fa-brands fa-linkedin h-4 w-4"></i>
            </a>
            <a href="#" aria-label="YouTube" class="text-dove-gray hover:text-playful-pink transition-colors">
              <i class="fa-brands fa-youtube h-4 w-4"></i>
            </a>
          </div>
        </div>
      </div>

      <!-- Copyright -->
      <div class="pt-6 border-t border-dove-gray/20 text-center md:text-left">
        <p class="text-dove-gray text-sm">
          ¬© <span id="current-year">2025</span> CakeBooking. Koncepcja aplikacji - prezentacja projektu.
        </p>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="scripts.js"></script>
  <script src="cookies.js"></script>
  <script src="cake-visualizer-ai.js"></script>
  <script>
    // Cake Visualizer 3D Application
    let scene, camera, renderer, controls;
    let cake = {};
    let decorations = {};
    
    // Configuration
    const config = {
      size: 'small',
      layers: 2,
      cakeText: '',
      occasion: 'birthday',
      color: 'white',
      additionalColor: '',
      specialTheme: '',
      flavor: 'vanilla',
      decorations: {
        candles: true,
        flowers: false,
        berries: false,
        sprinkles: false
      }
    };

    // Colors mapping
    const colors = {
      white: 0xffffff,
      pink: 0xf8b4d1,
      blue: 0x6b73ff,
      green: 0x9ccc65,
      orange: 0xffa726,
      brown: 0x8d6e63,
      red: 0xe91e63,
      purple: 0x9c27b0,
      yellow: 0xffeb3b,
      black: 0x424242
    };

    // Size configurations (diameter/radius only)
    const sizes = {
      small: { radius: 1.5, baseHeight: 0.6 },
      medium: { radius: 2, baseHeight: 0.8 },
      large: { radius: 2.5, baseHeight: 1.0 }
    };

    function init() {
      const canvas = document.getElementById('cake-canvas');
      const container = canvas.parentElement;
      
      // Scene setup
      scene = new THREE.Scene();
      scene.background = new THREE.Color(0xf8f9fa);
      
      // Camera setup
      camera = new THREE.PerspectiveCamera(75, container.clientWidth / 600, 0.1, 1000);
      camera.position.set(4, 4, 4);
      
      // Renderer setup
      renderer = new THREE.WebGLRenderer({ 
        canvas: canvas, 
        antialias: true,
        alpha: true 
      });
      renderer.setSize(container.clientWidth, 600);
      renderer.shadowMap.enabled = true;
      renderer.shadowMap.type = THREE.PCFSoftShadowMap;
      
      // Controls
      controls = new THREE.OrbitControls(camera, renderer.domElement);
      controls.enableDamping = true;
      controls.dampingFactor = 0.05;
      controls.screenSpacePanning = false;
      controls.minDistance = 2;
      controls.maxDistance = 10;
      controls.maxPolarAngle = Math.PI / 2;
      
      // Lighting
      setupLighting();
      
      // Initial cake
      createCake();
      
      // Event listeners
      setupEventListeners();
      
      // Generate initial AI prompt
      updateAIPrompt();
      
      // Animation loop
      animate();
    }

    function setupLighting() {
      // Ambient light
      const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
      scene.add(ambientLight);
      
      // Main directional light
      const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
      directionalLight.position.set(10, 10, 5);
      directionalLight.castShadow = true;
      directionalLight.shadow.mapSize.width = 2048;
      directionalLight.shadow.mapSize.height = 2048;
      directionalLight.shadow.camera.near = 0.5;
      directionalLight.shadow.camera.far = 50;
      scene.add(directionalLight);
      
      // Fill light
      const fillLight = new THREE.DirectionalLight(0xffffff, 0.3);
      fillLight.position.set(-5, 5, -5);
      scene.add(fillLight);
      
      // Ground plane for shadows
      const planeGeometry = new THREE.PlaneGeometry(20, 20);
      const planeMaterial = new THREE.ShadowMaterial({ opacity: 0.2 });
      const plane = new THREE.Mesh(planeGeometry, planeMaterial);
      plane.rotation.x = -Math.PI / 2;
      plane.position.y = -0.1;
      plane.receiveShadow = true;
      scene.add(plane);
    }

    function createCake() {
      // Clear existing cake
      if (cake.group) {
        scene.remove(cake.group);
      }
      
      cake.group = new THREE.Group();
      
      const sizeConfig = sizes[config.size];
      const color = colors[config.color];
      const numLayers = Math.max(1, Math.min(5, config.layers)); // Ensure 1-5 layers
      
      // Calculate layer heights based on number of layers
      const totalHeight = sizeConfig.baseHeight * numLayers;
      const layerHeight = totalHeight / numLayers;
      
      // Create cake layers
      for (let i = 0; i < numLayers; i++) {
        const layerRadius = sizeConfig.radius - (i * 0.2); // Smaller reduction for more layers
        
        // Base layer
        const geometry = new THREE.CylinderGeometry(layerRadius, layerRadius, layerHeight, 32);
        const material = new THREE.MeshPhongMaterial({ 
          color: color,
          shininess: 30 
        });
        const layer = new THREE.Mesh(geometry, material);
        layer.position.y = i * layerHeight + layerHeight / 2;
        layer.castShadow = true;
        layer.receiveShadow = true;
        
        cake.group.add(layer);
        
        // Frosting edge
        const edgeGeometry = new THREE.TorusGeometry(layerRadius, 0.08, 8, 16);
        const edgeMaterial = new THREE.MeshPhongMaterial({ 
          color: 0xffffff,
          shininess: 60 
        });
        const edge = new THREE.Mesh(edgeGeometry, edgeMaterial);
        edge.position.y = i * layerHeight + layerHeight;
        edge.rotation.x = Math.PI / 2;
        
        cake.group.add(edge);
      }
      
      // Add cake text if provided
      if (config.cakeText && config.cakeText.trim()) {
        addCakeText(totalHeight);
      }
      
      scene.add(cake.group);
      updateDecorations();
    }

    function addCakeText(cakeHeight) {
      // Create a simple representation of text (using a box for now)
      // In a real implementation, you might use TextGeometry or a texture
      const textGeometry = new THREE.BoxGeometry(1, 0.1, 0.2);
      const textMaterial = new THREE.MeshPhongMaterial({ 
        color: 0x333333,
        shininess: 30 
      });
      const textMesh = new THREE.Mesh(textGeometry, textMaterial);
      textMesh.position.y = cakeHeight + 0.1;
      cake.group.add(textMesh);
    }

    function updateDecorations() {
      // Clear existing decorations
      Object.values(decorations).forEach(decoration => {
        if (decoration) scene.remove(decoration);
      });
      decorations = {};
      
      const sizeConfig = sizes[config.size];
      const numLayers = Math.max(1, Math.min(5, config.layers));
      const totalHeight = sizeConfig.baseHeight * numLayers;
      
      // Candles
      if (config.decorations.candles) {
        decorations.candles = new THREE.Group();
        const candleCount = config.size === 'small' ? 3 : (config.size === 'medium' ? 5 : 8);
        
        for (let i = 0; i < candleCount; i++) {
          const angle = (i / candleCount) * Math.PI * 2;
          const radius = sizeConfig.radius * 0.6;
          
          // Candle body
          const candleGeometry = new THREE.CylinderGeometry(0.03, 0.03, 0.4, 8);
          const candleMaterial = new THREE.MeshPhongMaterial({ color: 0xffffcc });
          const candle = new THREE.Mesh(candleGeometry, candleMaterial);
          
          candle.position.x = Math.cos(angle) * radius;
          candle.position.z = Math.sin(angle) * radius;
          candle.position.y = totalHeight + 0.2;
          
          // Flame
          const flameGeometry = new THREE.SphereGeometry(0.05, 8, 6);
          const flameMaterial = new THREE.MeshBasicMaterial({ 
            color: 0xff6600,
            emissive: 0xff3300,
            emissiveIntensity: 0.5
          });
          const flame = new THREE.Mesh(flameGeometry, flameMaterial);
          flame.position.y = 0.25;
          flame.scale.y = 1.5;
          
          candle.add(flame);
          decorations.candles.add(candle);
        }
        
        scene.add(decorations.candles);
      }
      
      // Flowers
      if (config.decorations.flowers) {
        decorations.flowers = new THREE.Group();
        const flowerCount = 4;
        
        for (let i = 0; i < flowerCount; i++) {
          const angle = (i / flowerCount) * Math.PI * 2;
          const radius = sizeConfig.radius * 0.8;
          
          const flowerGeometry = new THREE.SphereGeometry(0.1, 8, 6);
          const flowerMaterial = new THREE.MeshPhongMaterial({ color: 0xff69b4 });
          const flower = new THREE.Mesh(flowerGeometry, flowerMaterial);
          
          flower.position.x = Math.cos(angle) * radius;
          flower.position.z = Math.sin(angle) * radius;
          flower.position.y = totalHeight + 0.05;
          
          decorations.flowers.add(flower);
        }
        
        scene.add(decorations.flowers);
      }
      
      // Berries
      if (config.decorations.berries) {
        decorations.berries = new THREE.Group();
        const berryCount = 8;
        
        for (let i = 0; i < berryCount; i++) {
          const angle = Math.random() * Math.PI * 2;
          const radius = Math.random() * sizeConfig.radius * 0.7;
          
          const berryGeometry = new THREE.SphereGeometry(0.04, 8, 6);
          const berryMaterial = new THREE.MeshPhongMaterial({ color: 0x8b0000 });
          const berry = new THREE.Mesh(berryGeometry, berryMaterial);
          
          berry.position.x = Math.cos(angle) * radius;
          berry.position.z = Math.sin(angle) * radius;
          berry.position.y = totalHeight + 0.02;
          
          decorations.berries.add(berry);
        }
        
        scene.add(decorations.berries);
      }
      
      // Sprinkles
      if (config.decorations.sprinkles) {
        decorations.sprinkles = new THREE.Group();
        const sprinkleCount = 20;
        
        for (let i = 0; i < sprinkleCount; i++) {
          const angle = Math.random() * Math.PI * 2;
          const radius = Math.random() * sizeConfig.radius;
          
          const sprinkleGeometry = new THREE.CylinderGeometry(0.01, 0.01, 0.08, 4);
          const sprinkleColors = [0xff0000, 0x00ff00, 0x0000ff, 0xffff00, 0xff00ff];
          const sprinkleMaterial = new THREE.MeshPhongMaterial({ 
            color: sprinkleColors[Math.floor(Math.random() * sprinkleColors.length)]
          });
          const sprinkle = new THREE.Mesh(sprinkleGeometry, sprinkleMaterial);
          
          sprinkle.position.x = Math.cos(angle) * radius;
          sprinkle.position.z = Math.sin(angle) * radius;
          sprinkle.position.y = totalHeight + 0.01;
          sprinkle.rotation.x = Math.random() * Math.PI;
          sprinkle.rotation.z = Math.random() * Math.PI;
          
          decorations.sprinkles.add(sprinkle);
        }
        
        scene.add(decorations.sprinkles);
      }
    }

    function setupEventListeners() {
      // Size buttons
      document.querySelectorAll('[data-size]').forEach(btn => {
        btn.addEventListener('click', (e) => {
          document.querySelectorAll('[data-size]').forEach(b => b.classList.remove('active'));
          e.target.closest('button').classList.add('active');
          config.size = e.target.closest('button').dataset.size;
          createCake();
          updateAIPrompt();
        });
      });
      
      // Occasion buttons
      document.querySelectorAll('[data-occasion]').forEach(btn => {
        btn.addEventListener('click', (e) => {
          document.querySelectorAll('[data-occasion]').forEach(b => b.classList.remove('active'));
          e.target.classList.add('active');
          config.occasion = e.target.dataset.occasion;
          updateAIPrompt();
        });
      });
      
      // Color swatches
      document.querySelectorAll('[data-color]').forEach(swatch => {
        swatch.addEventListener('click', (e) => {
          document.querySelectorAll('[data-color]').forEach(s => s.classList.remove('active'));
          e.target.classList.add('active');
          config.color = e.target.dataset.color;
          createCake();
          updateAIPrompt();
        });
      });
      
      // Flavor buttons
      document.querySelectorAll('[data-flavor]').forEach(btn => {
        btn.addEventListener('click', (e) => {
          document.querySelectorAll('[data-flavor]').forEach(b => b.classList.remove('active'));
          e.target.classList.add('active');
          config.flavor = e.target.dataset.flavor;
          updateAIPrompt();
        });
      });
      
      // Decoration checkboxes
      document.querySelectorAll('.decoration-checkbox').forEach(checkbox => {
        checkbox.addEventListener('change', (e) => {
          config.decorations[e.target.dataset.decoration] = e.target.checked;
          updateDecorations();
          updateAIPrompt();
        });
      });
      
      // Action buttons
      // Note: save-design button has been removed
      // Order functionality is handled in the modal script below
      
      // Copy prompt button
      document.getElementById('copy-prompt').addEventListener('click', copyPromptToClipboard);

      // Helper functions for webhook integration
      function generateAIPrompt() {
        const promptElement = document.getElementById('ai-prompt');
        return promptElement ? promptElement.textContent : '';
      }

      function getCanvasImageData() {
        const canvas = document.querySelector('canvas');
        return canvas ? canvas.toDataURL('image/png') : null;
      }
      
      // New input event listeners
      document.getElementById('cake-layers').addEventListener('input', (e) => {
        config.layers = parseInt(e.target.value) || 2;
        createCake();
        updateAIPrompt();
      });
      
      document.getElementById('cake-text').addEventListener('input', (e) => {
        config.cakeText = e.target.value;
        createCake();
        updateAIPrompt();
      });
      
      document.getElementById('additional-color').addEventListener('change', (e) => {
        config.additionalColor = e.target.value;
        updateAIPrompt();
      });
      
      document.getElementById('special-theme').addEventListener('input', (e) => {
        config.specialTheme = e.target.value;
        updateAIPrompt();
      });
      
      // Window resize
      window.addEventListener('resize', onWindowResize, false);
    }

    function onWindowResize() {
      const canvas = document.getElementById('cake-canvas');
      const container = canvas.parentElement;
      
      camera.aspect = container.clientWidth / 600;
      camera.updateProjectionMatrix();
      renderer.setSize(container.clientWidth, 600);
    }

    function animate() {
      requestAnimationFrame(animate);
      controls.update();
      
      // Animate flame flicker
      if (decorations.candles) {
        decorations.candles.children.forEach(candle => {
          const flame = candle.children[0];
          if (flame) {
            flame.scale.y = 1.5 + Math.sin(Date.now() * 0.01) * 0.2;
            flame.material.emissiveIntensity = 0.5 + Math.sin(Date.now() * 0.008) * 0.2;
          }
        });
      }
      
      renderer.render(scene, camera);
    }

    // Generate AI prompt based on current configuration
    function generateAIPrompt() {
      const sizeConfig = sizes[config.size];
      const numLayers = Math.max(1, Math.min(5, config.layers));
      
      // Size and layers description
      const sizeText = config.size === 'small' ? 'small diameter' : 
                      config.size === 'medium' ? 'medium diameter' : 
                      'large diameter';
      
      const layerText = numLayers === 1 ? 'single-layer' : 
                       numLayers === 2 ? 'two-tier' :
                       numLayers === 3 ? 'three-tier' :
                       numLayers === 4 ? 'four-tier' :
                       'five-tier';
      
      const occasionText = {
        birthday: 'birthday celebration',
        wedding: 'elegant wedding',
        anniversary: 'romantic anniversary',
        graduation: 'graduation celebration',
        celebration: 'special celebration'
      }[config.occasion];
      
      const colorText = {
        white: 'pure white',
        pink: 'soft pink',
        blue: 'sky blue',
        green: 'fresh green',
        orange: 'warm orange',
        brown: 'rich chocolate brown',
        red: 'vibrant red',
        purple: 'royal purple',
        yellow: 'sunny yellow',
        black: 'elegant black'
      }[config.color];
      
      const flavorText = {
        vanilla: 'vanilla sponge',
        chocolate: 'rich chocolate',
        strawberry: 'strawberry',
        lemon: 'lemon',
        carrot: 'carrot cake'
      }[config.flavor];
      
      // Additional color text
      const additionalColorText = {
        '': '',
        'gold': 'with gold accents',
        'silver': 'with silver details',
        'rose-gold': 'with rose gold highlights',
        'pearl': 'with pearl finish details',
        'copper': 'with copper metallic accents',
        'mint': 'with mint green accents',
        'lavender': 'with lavender purple details',
        'coral': 'with coral colored accents',
        'turquoise': 'with turquoise blue details',
        'burgundy': 'with burgundy red accents'
      }[config.additionalColor];
      
      // Build decorations text
      const decorations = [];
      if (config.decorations.candles) decorations.push('birthday candles with flickering flames');
      if (config.decorations.flowers) decorations.push('delicate sugar flowers');
      if (config.decorations.berries) decorations.push('fresh berries');
      if (config.decorations.sprinkles) decorations.push('colorful sprinkles');
      
      const decorationText = decorations.length > 0 ? 
        `decorated with ${decorations.join(', ')}` : 
        'with elegant smooth frosting';
      
      // Cake text
      const cakeTextPart = config.cakeText && config.cakeText.trim() ? 
        `, featuring "${config.cakeText.trim()}" written in elegant lettering on top` : '';
      
      // Special theme
      const themePart = config.specialTheme && config.specialTheme.trim() ? 
        `, incorporating ${config.specialTheme.trim()} theme elements` : '';
      
      // Professional photography description
      const photographyStyle = ', professional food photography, studio lighting setup with soft diffused lighting, high-end DSLR camera shot, macro lens detail, bokeh background, pristine white background or elegant marble surface, commercial bakery quality presentation, ultra-high resolution 8K, photorealistic rendering, magazine-quality food styling, perfect focus and clarity, rich texture details, appetizing and mouthwatering presentation, luxury confectionery advertisement style';
      
      // Generate the complete prompt
      const prompt = `Stunning ${sizeText} ${layerText} ${flavorText} cake with ${colorText} frosting${additionalColorText}, ${decorationText}${cakeTextPart}${themePart}, perfect for ${occasionText}, placed on elegant cake stand${photographyStyle}`;
      
      return prompt;
    }

    // Update AI prompt display
    function updateAIPrompt() {
      const promptTextarea = document.getElementById('ai-prompt');
      if (promptTextarea) {
        promptTextarea.value = generateAIPrompt();
      }
    }

    // Copy prompt to clipboard
    function copyPromptToClipboard() {
      const promptTextarea = document.getElementById('ai-prompt');
      if (promptTextarea) {
        promptTextarea.select();
        promptTextarea.setSelectionRange(0, 99999); // For mobile devices
        
        try {
          document.execCommand('copy');
          
          // Show feedback
          const copyButton = document.getElementById('copy-prompt');
          const originalText = copyButton.innerHTML;
          copyButton.innerHTML = '<i class="fa-solid fa-check mr-1"></i>Skopiowano!';
          copyButton.style.backgroundColor = '#4ade80';
          
          setTimeout(() => {
            copyButton.innerHTML = originalText;
            copyButton.style.backgroundColor = '';
          }, 2000);
          
        } catch (err) {
          console.error('Failed to copy text: ', err);
        }
      }
    }

    // Initialize when page loads
    document.addEventListener('DOMContentLoaded', init);
  </script>

  <!-- Order Modal for Cake Visualizer -->
  <div id="order-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden opacity-0 transition-opacity duration-300">
    <div class="flex items-center justify-center min-h-screen p-4">
      <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto transform scale-95 transition-transform duration-300">
        <div class="p-8">
          <!-- Header -->
          <div class="text-center mb-6">
            <h3 class="text-2xl font-display font-bold text-gray-900 mb-2">
              Zam√≥w wygenerowany tort
            </h3>
            <p class="text-gray-600">
              Wype≈Çnij dane zam√≥wienia dla Twojego spersonalizowanego tortu
            </p>
          </div>

          <!-- Order Form -->
          <form id="order-form" class="space-y-6">
            <!-- Customer Information -->
            <div class="bg-gray-50 rounded-xl p-6">
              <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                <i class="fa-solid fa-user mr-2 text-playful-pink"></i>
                Dane osobowe
              </h4>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">Imiƒô *</label>
                  <input type="text" id="first-name" name="first-name" required
                         class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-playful-pink focus:border-transparent transition-all">
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">Nazwisko *</label>
                  <input type="text" id="last-name" name="last-name" required
                         class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-playful-pink focus:border-transparent transition-all">
                </div>
              </div>

              <div class="mt-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">Email *</label>
                <input type="email" id="email" name="email" required
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-playful-pink focus:border-transparent transition-all">
              </div>

              <div class="mt-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">Telefon *</label>
                <input type="tel" id="phone" name="phone" required
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-playful-pink focus:border-transparent transition-all">
              </div>
            </div>

            <!-- Delivery Information -->
            <div class="bg-gray-50 rounded-xl p-6">
              <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                <i class="fa-solid fa-truck mr-2 text-playful-pink"></i>
                Dostawa
              </h4>

              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">Adres dostawy</label>
                  <input type="text" id="street" name="street" placeholder="Ulica i numer"
                         class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-playful-pink focus:border-transparent transition-all">
                </div>

                <div class="grid grid-cols-2 gap-4">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Kod pocztowy</label>
                    <input type="text" id="postal-code" name="postal-code" placeholder="00-000"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-playful-pink focus:border-transparent transition-all">
                  </div>

                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Miasto</label>
                    <input type="text" id="city" name="city"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-playful-pink focus:border-transparent transition-all">
                  </div>
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">Data dostawy</label>
                  <input type="date" id="delivery-date" name="delivery-date"
                         class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-playful-pink focus:border-transparent transition-all">
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">Uwagi do zam√≥wienia</label>
                  <textarea id="notes" name="notes" rows="3" placeholder="Dodatkowe informacje..."
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-playful-pink focus:border-transparent transition-all resize-none"></textarea>
                </div>
              </div>
            </div>

            <!-- Order Summary -->
            <div class="bg-gradient-to-r from-playful-pink/10 to-champagne-gold/10 rounded-xl p-6">
              <h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                <i class="fa-solid fa-clipboard-list mr-2 text-playful-pink"></i>
                Podsumowanie zam√≥wienia
              </h4>

              <div class="space-y-2 text-sm">
                <p><strong>Tort:</strong> Wygenerowany na podstawie Twoich preferencji</p>
                <p><strong>Rozmiar:</strong> <span id="summary-size">≈öredni</span></p>
                <p><strong>Kolor:</strong> <span id="summary-color">Wybrany</span></p>
                <p><strong>Smak:</strong> <span id="summary-flavor">Wybrany</span></p>
                <p><strong>Okazja:</strong> <span id="summary-occasion">Wybrana</span></p>
                <p class="text-playful-pink font-semibold"><strong>Warto≈õƒá:</strong> Cena ustalana indywidualnie</p>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex space-x-4 pt-4">
              <button type="button" id="cancel-order" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-3 px-6 rounded-xl transition-all duration-300">
                Anuluj
              </button>

              <button type="submit" id="submit-order" class="flex-1 pill-button-pink text-white font-medium py-3 px-6 shadow-lg">
                <i class="fa-solid fa-paper-plane mr-2"></i>
                Wy≈õlij zam√≥wienie
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Success Modal for Order -->
  <div id="order-success-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden opacity-0 transition-opacity duration-300">
    <div class="flex items-center justify-center min-h-screen p-4">
      <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full transform scale-95 transition-transform duration-300">
        <div class="p-8 text-center">
          <div class="w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-r from-playful-pink to-champagne-gold flex items-center justify-center">
            <i class="fa-solid fa-check text-3xl text-gray-900"></i>
          </div>

          <h3 class="text-2xl font-display font-bold text-gray-900 mb-4">
            Zam√≥wienie wys≈Çane!
          </h3>

          <p class="text-gray-700 leading-relaxed mb-6">
            Dziƒôkujemy za zam√≥wienie spersonalizowanego tortu! Nasz zesp√≥≈Ç przeanalizuje Twoje zam√≥wienie i skontaktuje siƒô wkr√≥tce w sprawie szczeg√≥≈Ç√≥w i ceny.
          </p>

          <div class="bg-gray-50 rounded-xl p-4 mb-6">
            <p class="text-sm text-gray-700 mb-2">
              <i class="fa-solid fa-clock mr-2 text-playful-pink"></i>
              <strong class="text-gray-900">Czas realizacji:</strong> 3-5 dni roboczych
            </p>
            <p class="text-sm text-gray-700">
              <i class="fa-solid fa-envelope mr-2 text-playful-pink"></i>
              <strong class="text-gray-900">Kontakt:</strong> kontakt@cakebooking.pl
            </p>
          </div>

          <button id="close-order-success" class="w-full pill-button-pink text-white font-medium py-3 px-6 shadow-lg">
            <i class="fa-solid fa-check mr-2"></i>
            Rozumiem
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Modal management functions
    function showModal(modalId) {
      const modal = document.getElementById(modalId);
      if (modal) {
        modal.classList.remove('hidden');
        setTimeout(() => {
          modal.classList.remove('opacity-0');
          const modalContent = modal.querySelector('.transform');
          if (modalContent) {
            modalContent.classList.remove('scale-95');
          }
        }, 10);
      }
    }

    function hideModal(modalId) {
      const modal = document.getElementById(modalId);
      if (modal) {
        modal.classList.add('opacity-0');
        const modalContent = modal.querySelector('.transform');
        if (modalContent) {
          modalContent.classList.add('scale-95');
        }
        setTimeout(() => {
          modal.classList.add('hidden');
        }, 300);
      }
    }

    // Order modal functionality
    document.addEventListener('DOMContentLoaded', function() {
      const orderCakeBtn = document.getElementById('order-cake');
      const orderModal = document.getElementById('order-modal');
      const orderForm = document.getElementById('order-form');
      const cancelOrderBtn = document.getElementById('cancel-order');
      const closeOrderSuccessBtn = document.getElementById('close-order-success');

      // Show order modal when "Zam√≥w ten tort" is clicked
      if (orderCakeBtn) {
        orderCakeBtn.addEventListener('click', function() {
          // Update summary with current config
          updateOrderSummary();
          showModal('order-modal');
        });
      }

      // Cancel order
      if (cancelOrderBtn) {
        cancelOrderBtn.addEventListener('click', function() {
          hideModal('order-modal');
        });
      }

      // Close success modal
      if (closeOrderSuccessBtn) {
        closeOrderSuccessBtn.addEventListener('click', function() {
          hideModal('order-success-modal');
        });
      }

      // Close modals when clicking outside
      [orderModal, document.getElementById('order-success-modal')].forEach(modal => {
        if (modal) {
          modal.addEventListener('click', function(e) {
            if (e.target === modal) {
              hideModal(modal.id);
            }
          });
        }
      });

      // Handle order form submission
      if (orderForm) {
        orderForm.addEventListener('submit', function(e) {
          e.preventDefault();
          submitCakeOrder();
        });
      }
    });

    // Update order summary with current cake configuration
    function updateOrderSummary() {
      const sizeNames = { small: 'Ma≈Çy', medium: '≈öredni', large: 'Du≈ºy' };
      const colorNames = {
        white: 'bia≈Çy', pink: 'r√≥≈ºowy', blue: 'niebieski', green: 'zielony',
        orange: 'pomara≈Ñczowy', brown: 'brƒÖzowy', red: 'czerwony',
        purple: 'fioletowy', yellow: '≈º√≥≈Çty', black: 'czarny'
      };
      const occasionNames = {
        birthday: 'urodzinowy', wedding: '≈õlubny', anniversary: 'rocznicowy',
        graduation: 'na uko≈Ñczenie szko≈Çy', celebration: '≈õwiƒÖteczny'
      };
      const flavorNames = {
        vanilla: 'waniliowy', chocolate: 'czekoladowy', strawberry: 'truskawkowy',
        lemon: 'cytrynowy', caramel: 'karmelowy'
      };

      document.getElementById('summary-size').textContent = sizeNames[config.size] || config.size;
      document.getElementById('summary-color').textContent = colorNames[config.color] || config.color;
      document.getElementById('summary-flavor').textContent = flavorNames[config.flavor] || config.flavor;
      document.getElementById('summary-occasion').textContent = occasionNames[config.occasion] || config.occasion;
    }

    // Submit cake order to webhook
    async function submitCakeOrder() {
      const submitBtn = document.getElementById('submit-order');
      const originalText = submitBtn.innerHTML;

      // Show loading state
      submitBtn.disabled = true;
      submitBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin mr-2"></i>Wysy≈Çanie...';

      try {
        // Get generated image as base64
        const generatedImage = document.getElementById('generated-image');
        let imageBase64 = null;

        if (generatedImage && generatedImage.src) {
          if (generatedImage.src.startsWith('data:image/')) {
            // Extract base64 from data URL
            imageBase64 = generatedImage.src.split(',')[1];
          }
        }

        // Prepare customer data
        const customerData = {
          firstName: document.getElementById('first-name').value,
          lastName: document.getElementById('last-name').value,
          email: document.getElementById('email').value,
          phone: document.getElementById('phone').value
        };

        // Prepare delivery data
        const deliveryData = {
          street: document.getElementById('street').value,
          postalCode: document.getElementById('postal-code').value,
          city: document.getElementById('city').value,
          deliveryDate: document.getElementById('delivery-date').value,
          notes: document.getElementById('notes').value
        };

        // Prepare order data
        const orderData = {
          cake: {
            type: 'generated_visualizer',
            config: config,
            generatedImageBase64: imageBase64,
            generatedPrompt: generatePrompt()
          },
          size: config.size,
          customer: customerData,
          delivery: deliveryData,
          orderType: 'generated_cake',
          timestamp: new Date().toISOString()
        };

        // Send to webhook
        const success = await sendCakeOrderToWebhook(orderData, customerData);

        if (success) {
          console.log('‚úÖ Generated cake order sent successfully');
          hideModal('order-modal');
          showModal('order-success-modal');
        } else {
          throw new Error('Failed to send order to webhook');
        }

      } catch (error) {
        console.error('‚ùå Error submitting cake order:', error);
        alert('WystƒÖpi≈Ç b≈ÇƒÖd podczas wysy≈Çania zam√≥wienia. Spr√≥buj ponownie.');
      } finally {
        // Reset button state
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalText;
      }
    }

    // Send cake order to webhook
    async function sendCakeOrderToWebhook(orderData, customerData) {
      const data = {
        orderData: orderData,
        customerData: customerData,
        formType: 'generated_cake_order',
        orderDate: new Date().toISOString()
      };

      // Create formatted message for order processing
      const orderMessage = formatGeneratedCakeOrderMessage(orderData, customerData);

      // Add formatted message to webhook data
      const webhookData = {
        ...data,
        orderMessage: orderMessage
      };

      return await sendToWebhook(webhookData, 'generated_cake_order');
    }

    // Format order message for generated cake
    function formatGeneratedCakeOrderMessage(orderData, customerData) {
      const { cake, customer, delivery, size } = orderData;
      const { config, generatedPrompt, generatedImageBase64 } = cake;

      let message = `üßÅ NOWE ZAM√ìWIENIE TORTU WYGENEROWANEGO\n\n`;
      message += `üìÖ Data zam√≥wienia: ${new Date().toLocaleString('pl-PL')}\n\n`;

      // Cake Configuration
      message += `üéÇ KONFIGURACJA TORTU:\n`;
      const sizeNames = { small: 'Ma≈Çy (do 8 os√≥b)', medium: '≈öredni (do 12 os√≥b)', large: 'Du≈ºy (do 16 os√≥b)' };
      message += `‚Ä¢ Rozmiar: ${sizeNames[size] || size}\n`;
      message += `‚Ä¢ Warstwy: ${config.layers || 2}\n`;
      message += `‚Ä¢ Kolor podstawowy: ${config.color || 'Niezdefiniowany'}\n`;
      if (config.additionalColor) {
        message += `‚Ä¢ Kolor dodatkowy: ${config.additionalColor}\n`;
      }
      message += `‚Ä¢ Smak: ${config.flavor || 'Niezdefiniowany'}\n`;
      message += `‚Ä¢ Okazja: ${config.occasion || 'Niezdefiniowana'}\n`;
      if (config.cakeText) {
        message += `‚Ä¢ Napis na torcie: "${config.cakeText}"\n`;
      }

      // Decorations
      if (config.decorations && Object.keys(config.decorations).length > 0) {
        message += `\n‚ú® DEKORACJE:\n`;
        const decorationNames = {
          candles: '≈öwieczki', flowers: 'Kwiaty', berries: 'Jagody', sprinkles: 'Posypka'
        };
        Object.entries(config.decorations).forEach(([key, value]) => {
          if (value === true) {
            message += `‚Ä¢ ${decorationNames[key] || key}\n`;
          }
        });
      }

      // AI Generation Info
      message += `\nü§ñ INFORMACJE O GENEROWANIU:\n`;
      message += `‚Ä¢ Status generowania: Wygenerowany przez AI\n`;
      if (generatedPrompt) {
        message += `‚Ä¢ Prompt AI: ${generatedPrompt}\n`;
      }
      message += `‚Ä¢ Obraz wygenerowany: ${generatedImageBase64 ? 'Tak (base64)' : 'Nie'}\n`;

      // Customer Information
      if (customer && Object.keys(customer).length > 0) {
        message += `\nüë§ DANE KLIENTA:\n`;
        if (customer.firstName || customer.lastName) {
          message += `‚Ä¢ Imiƒô i nazwisko: ${customer.firstName || ''} ${customer.lastName || ''}\n`;
        }
        if (customer.email) {
          message += `‚Ä¢ Email: ${customer.email}\n`;
        }
        if (customer.phone) {
          message += `‚Ä¢ Telefon: ${customer.phone}\n`;
        }
      }

      // Delivery Information
      if (delivery && Object.keys(delivery).length > 0) {
        message += `\nüöö DOSTAWA:\n`;
        if (delivery.street) {
          message += `‚Ä¢ Adres: ${delivery.street}\n`;
        }
        if (delivery.postalCode || delivery.city) {
          message += `‚Ä¢ Kod pocztowy i miasto: ${delivery.postalCode || ''} ${delivery.city || ''}\n`;
        }
        if (delivery.deliveryDate) {
          message += `‚Ä¢ Data dostawy: ${delivery.deliveryDate}\n`;
        }
        if (delivery.notes) {
          message += `‚Ä¢ Uwagi: ${delivery.notes}\n`;
        }
      }

      message += `\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n`;
      message += `‚ö° Prosimy o szybkie przygotowanie oferty dla klienta!\n`;

      return message;
    }
  </script>
</body>
</html> 