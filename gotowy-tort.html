<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gotowy Tort - Wybierz idealny tort dla swojej okazji | CakeBooking</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="styles.css">
  <style>
    body {
      scrollbar-width: thin;
      scrollbar-color: rgba(191, 202, 217, 0.7) transparent;
    }

    body::-webkit-scrollbar {
      width: 12px;
    }

    body::-webkit-scrollbar-track {
      background: transparent;
    }

    body::-webkit-scrollbar-thumb {
      background-color: rgba(191, 202, 217, 0);
      border-radius: 20px;
      border: 3px solid transparent;
      background-clip: content-box;
    }

    body:hover::-webkit-scrollbar-thumb {
      background-color: rgba(191, 202, 217, 0.7);
    }

    .occasion-card {
      transition: all 0.3s ease;
    }

    .occasion-card:hover {
      transform: translateY(-2px);
    }

    .occasion-card.selected {
      border-color: var(--champagne-gold-start);
      background: linear-gradient(135deg, rgba(247, 245, 242, 0.1), rgba(247, 245, 242, 0.05));
    }

    .taste-option {
      transition: all 0.3s ease;
    }

    .taste-option:hover {
      background-color: rgba(247, 245, 242, 0.1);
    }

    .taste-option.selected {
      background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));
      color: var(--midnight-navy);
    }

    .size-option.selected {
      border-color: rgb(212, 175, 55) !important;
      background-color: rgba(212, 175, 55, 0.1) !important;
      box-shadow: 0 0 0 2px rgba(212, 175, 55, 0.2) !important;
    }

    .size-option:hover {
      border-color: rgb(212, 175, 55) !important;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(212, 175, 55, 0.15);
    }

    .delivery-option.selected {
      border-color: rgb(212, 175, 55) !important;
      background-color: rgba(212, 175, 55, 0.1) !important;
      box-shadow: 0 0 0 2px rgba(212, 175, 55, 0.2) !important;
    }

    .delivery-option:hover {
      border-color: rgb(212, 175, 55) !important;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(212, 175, 55, 0.15);
    }

    /* Ensure sticky positioning works properly */
    .sticky {
      position: -webkit-sticky;
      position: sticky;
    }

    /* Navigation Dropdown Styles */
    .group:hover .group-hover\:rotate-180 {
      transform: rotate(180deg);
    }

    /* Ensure dropdowns appear above other content */
    .relative.group {
      z-index: 50;
    }

    /* Smooth dropdown animations */
    .group:hover .group-hover\:opacity-100 {
      transition-delay: 0.1s;
    }

    /* Mobile menu improvements */
    #mobile-menu {
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
  </style>
</head>
<body class="font-sans text-midnight-navy pb-24 md:pb-0">
  <!-- Navigation -->
  <nav class="fixed w-full nav-midnight shadow-sm z-50">
    <div class="max-w-7xl mx-auto px-6 lg:px-8">
      <div class="flex justify-between h-16">
        <div class="flex items-center">
          <a href="index.html" aria-label="CakeBooking - Strona główna" class="flex-shrink-0 flex items-center">
            <i class="fa-solid fa-cake-candles icon-gradient-gold-pink text-3xl mr-3"></i>
            <span class="font-display font-bold text-3xl text-pure-white">CakeBooking</span>
          </a>
        </div>
        
        <!-- Desktop Navigation -->
        <div class="hidden lg:flex items-center space-x-6">
          <!-- Main Menu Items -->
          <div class="relative group">
            <button class="flex items-center text-dove-gray hover:text-playful-pink px-3 py-2 text-sm font-medium transition-colors">
              <span>Produkty</span>
              <i class="fa-solid fa-chevron-down ml-1 text-xs transition-transform group-hover:rotate-180"></i>
            </button>
            <!-- Dropdown Menu -->
            <div class="absolute top-full left-0 mt-2 w-64 bg-white rounded-xl shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 transform origin-top scale-95 group-hover:scale-100 border border-gray-100">
              <div class="py-2">
                <a href="wizualizator-tortow.html" class="flex items-center px-4 py-3 text-sm text-midnight-navy hover:bg-playful-pink/10 transition-colors">
                  <i class="fa-solid fa-palette w-5 h-5 mr-3 icon-gradient-gold-pink"></i>
                  <div>
                    <div class="font-medium">Wizualizator 3D</div>
                    <div class="text-xs text-dove-gray">Projektuj własny tort</div>
                  </div>
                </a>
                <a href="gotowy-tort.html" class="flex items-center px-4 py-3 text-sm text-midnight-navy hover:bg-playful-pink/10 transition-colors">
                  <i class="fa-solid fa-thumbs-up w-5 h-5 mr-3 icon-gradient-gold-pink"></i>
                  <div>
                    <div class="font-medium">Gotowe torty</div>
                    <div class="text-xs text-dove-gray">Wybierz z gotowych propozycji</div>
                  </div>
                </a>
                <a href="index.html#features" class="flex items-center px-4 py-3 text-sm text-midnight-navy hover:bg-playful-pink/10 transition-colors">
                  <i class="fa-solid fa-star w-5 h-5 mr-3 icon-gradient-gold-pink"></i>
                  <div>
                    <div class="font-medium">Funkcje</div>
                    <div class="text-xs text-dove-gray">Poznaj możliwości</div>
                  </div>
                </a>
              </div>
            </div>
          </div>

          <div class="relative group">
            <button class="flex items-center text-dove-gray hover:text-playful-pink px-3 py-2 text-sm font-medium transition-colors">
              <span>Firma</span>
              <i class="fa-solid fa-chevron-down ml-1 text-xs transition-transform group-hover:rotate-180"></i>
            </button>
            <!-- Dropdown Menu -->
            <div class="absolute top-full left-0 mt-2 w-64 bg-white rounded-xl shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 transform origin-top scale-95 group-hover:scale-100 border border-gray-100">
              <div class="py-2">
                <a href="o-nas.html" class="flex items-center px-4 py-3 text-sm text-midnight-navy hover:bg-playful-pink/10 transition-colors">
                  <i class="fa-solid fa-users w-5 h-5 mr-3 icon-gradient-gold-pink"></i>
                  <div>
                    <div class="font-medium">O nas</div>
                    <div class="text-xs text-dove-gray">Poznaj naszą historię</div>
                  </div>
                </a>
                <a href="index.html#for-bakers-section" class="flex items-center px-4 py-3 text-sm text-midnight-navy hover:bg-playful-pink/10 transition-colors">
                  <i class="fa-solid fa-store w-5 h-5 mr-3 icon-gradient-gold-pink"></i>
                  <div>
                    <div class="font-medium">Dla cukierników</div>
                    <div class="text-xs text-dove-gray">Dołącz do platformy</div>
                  </div>
                </a>
                <a href="blog.html" class="flex items-center px-4 py-3 text-sm text-midnight-navy hover:bg-playful-pink/10 transition-colors">
                  <i class="fa-solid fa-blog w-5 h-5 mr-3 icon-gradient-gold-pink"></i>
                  <div>
                    <div class="font-medium">Blog</div>
                    <div class="text-xs text-dove-gray">Inspiracje i porady</div>
                  </div>
                </a>
              </div>
            </div>
          </div>

          <a href="index.html#how-it-works" class="text-dove-gray hover:text-playful-pink px-3 py-2 text-sm font-medium transition-colors">Jak to działa</a>
          <a href="index.html#faq" class="text-dove-gray hover:text-playful-pink px-3 py-2 text-sm font-medium transition-colors">FAQ</a>
          <a href="kontakt.html" class="text-dove-gray hover:text-playful-pink px-3 py-2 text-sm font-medium transition-colors">Kontakt</a>
          
          <!-- CTA Button -->
          <a href="zamowienie.html" class="pill-button-pink flex items-center justify-center text-white no-underline">
            <i class="fa-solid fa-cake-candles h-4 w-4 mr-2"></i>
            Zamów tort
          </a>
        </div>

        <!-- Mobile menu button -->
        <div class="lg:hidden flex items-center">
          <button id="mobile-menu-button"
                  aria-label="Otwórz menu nawigacyjne"
                  aria-expanded="false"
                  aria-controls="mobile-menu"
                  class="inline-flex items-center justify-center p-2 rounded-md text-dove-gray hover:text-playful-pink hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-playful-pink transition-colors">
            <i class="fa-solid fa-bars h-6 w-6"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Mobile menu -->
    <div id="mobile-menu" class="hidden lg:hidden bg-midnight-navy shadow-lg">
      <div class="px-4 py-6 space-y-4">
        <!-- Products Section -->
        <div class="space-y-2">
          <div class="text-xs font-semibold icon-gradient-gold-pink uppercase tracking-wider mb-3">Produkty</div>
          <a href="wizualizator-tortow.html" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-palette w-5 h-5 mr-3"></i>
            Wizualizator 3D
          </a>
          <a href="gotowy-tort.html" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-thumbs-up w-5 h-5 mr-3"></i>
            Gotowe torty
          </a>
          <a href="index.html#features" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-star w-5 h-5 mr-3"></i>
            Funkcje
          </a>
        </div>

        <!-- Company Section -->
        <div class="space-y-2">
          <div class="text-xs font-semibold icon-gradient-gold-pink uppercase tracking-wider mb-3">Firma</div>
          <a href="o-nas.html" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-users w-5 h-5 mr-3"></i>
            O nas
          </a>
          <a href="index.html#for-bakers-section" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-store w-5 h-5 mr-3"></i>
            Dla cukierników
          </a>
          <a href="blog.html" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-blog w-5 h-5 mr-3"></i>
            Blog
          </a>
        </div>

        <!-- Other Links -->
        <div class="space-y-2">
          <div class="text-xs font-semibold icon-gradient-gold-pink uppercase tracking-wider mb-3">Pomoc</div>
          <a href="index.html#how-it-works" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-circle-info w-5 h-5 mr-3"></i>
            Jak to działa
          </a>
          <a href="index.html#faq" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-question-circle w-5 h-5 mr-3"></i>
            FAQ
          </a>
          <a href="kontakt.html" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-envelope w-5 h-5 mr-3"></i>
            Kontakt
          </a>
        </div>

        <!-- CTA Button -->
        <div class="pt-4 border-t border-dove-gray/20">
          <a href="zamowienie.html" class="w-full pill-button-pink flex items-center justify-center text-white text-base font-medium px-6 py-3 shadow-lg no-underline">
            <i class="fa-solid fa-cake-candles h-5 w-5 mr-3"></i>
            Zamów tort
          </a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="pt-32 pb-20 md:pb-32 hero-gradient relative overflow-hidden">
    <!-- Art Deco Elements -->
    <div class="parallax-element" data-speed="0.3" style="position: absolute; left: 48px; top: 128px; z-index: 1;">
      <div class="art-deco-line"></div>
    </div>
    <div class="parallax-element" data-speed="0.4" style="position: absolute; right: 48px; top: 160px; z-index: 1;">
      <div class="art-deco-line"></div>
    </div>
    <div class="parallax-element" data-speed="0.2" style="position: absolute; left: 64px; top: 208px; z-index: 1;">
      <div class="art-deco-dot"></div>
    </div>
    <div class="parallax-element" data-speed="0.6" style="position: absolute; right: 64px; top: 240px; z-index: 1;">
      <div class="art-deco-dot"></div>
    </div>
    
    <!-- Sparkles -->
    <div class="parallax-element" data-speed="0.5" style="position: absolute; top: 20%; left: 10%;">
      <div class="sparkle sparkle-enhanced" style="animation-delay: 0s;">✦</div>
    </div>
    <div class="parallax-element" data-speed="0.3" style="position: absolute; top: 30%; right: 15%;">
      <div class="sparkle sparkle-enhanced" style="animation-delay: 0.3s;">✧</div>
    </div>
    <div class="parallax-element" data-speed="0.7" style="position: absolute; top: 50%; left: 20%;">
      <div class="sparkle sparkle-enhanced" style="animation-delay: 0.6s;">✦</div>
    </div>
    
    <div class="max-w-7xl mx-auto px-6 lg:px-8 relative z-10">
      <div class="text-center max-w-4xl mx-auto">
                  <div class="font-script text-gradient-gold text-2xl mb-4">Gotowe torty dla każdej okazji</div>
        <h1 class="font-display text-4xl md:text-5xl lg:text-6xl font-bold text-pure-white leading-tight mb-6">
          Wybierz idealny tort <span class="icon-gradient-gold-pink">w kilka kliknięć</span>
        </h1>
        <p class="text-xl text-dove-gray max-w-2xl mx-auto leading-relaxed mb-8">
          Sprawdzone smaki, eleganckie dekoracje i szybka dostawa. Znajdź tort idealny dla swojej okazji.
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a href="#occasion-selector" class="pill-button-pink flex items-center justify-center text-white no-underline">
            <i class="fa-solid fa-thumbs-up h-5 w-5 mr-3"></i>
            Wybierz okazję
          </a>
          <a href="wizualizator-tortow.html" class="pill-button-secondary ghost-button flex items-center justify-center text-lg font-medium px-8 py-4 no-underline">
            <i class="fa-solid fa-palette h-5 w-5 mr-3"></i>
            Projektuj własny
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Occasion Selector -->
  <section id="occasion-selector" class="py-20 bg-porcelain-white relative overflow-hidden">
    <!-- Art Deco Elements -->
    <div class="parallax-element" data-speed="0.3" style="position: absolute; left: 32px; top: 80px; z-index: 0; opacity: 0.5;">
      <div class="art-deco-line"></div>
    </div>
    <div class="parallax-element" data-speed="0.4" style="position: absolute; right: 32px; bottom: 80px; z-index: 0; opacity: 0.5;">
      <div class="art-deco-line"></div>
    </div>
    
    <div class="max-w-7xl mx-auto px-6 lg:px-8 relative z-10">
      <div class="text-center mb-16">
        <h2 class="font-display text-3xl md:text-4xl font-bold text-midnight-navy mb-6">Wybierz okazję</h2>
        <p class="text-xl text-dove-gray max-w-3xl mx-auto leading-relaxed">
          Każda okazja ma swój charakter. Wybierz kategorię, która najlepiej pasuje do Twojej uroczystości.
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-16">
        <!-- Communion Cakes -->
        <div class="occasion-card vitreous-card p-6 text-center cursor-pointer" data-occasion="communion">
          <div class="w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));">
            <i class="fa-solid fa-church text-2xl text-midnight-navy"></i>
          </div>
          <h3 class="text-lg font-bold text-midnight-navy mb-2">Torty komunijne</h3>
          <p class="text-sm text-dove-gray">Delikatne i eleganckie</p>
        </div>

        <!-- Baptism Cakes -->
        <div class="occasion-card vitreous-card p-6 text-center cursor-pointer" data-occasion="baptism">
          <div class="w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));">
            <i class="fa-solid fa-baby text-2xl text-midnight-navy"></i>
          </div>
          <h3 class="text-lg font-bold text-midnight-navy mb-2">Torty na chrzest</h3>
          <p class="text-sm text-dove-gray">Urocze i subtelne</p>
        </div>

        <!-- Wedding Cakes -->
        <div class="occasion-card vitreous-card p-6 text-center cursor-pointer" data-occasion="wedding">
          <div class="w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));">
            <i class="fa-solid fa-heart text-2xl text-midnight-navy"></i>
          </div>
          <h3 class="text-lg font-bold text-midnight-navy mb-2">Torty weselne</h3>
          <p class="text-sm text-dove-gray">Wielopiętrowe i eleganckie</p>
        </div>

        <!-- Children's Cakes -->
        <div class="occasion-card vitreous-card p-6 text-center cursor-pointer" data-occasion="children">
          <div class="w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));">
            <i class="fa-solid fa-child text-2xl text-midnight-navy"></i>
          </div>
          <h3 class="text-lg font-bold text-midnight-navy mb-2">Torty dziecięce</h3>
          <p class="text-sm text-dove-gray">Kolorowe i zabawne</p>
        </div>

        <!-- Baby Shower Cakes -->
        <div class="occasion-card vitreous-card p-6 text-center cursor-pointer" data-occasion="babyshower">
          <div class="w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));">
            <i class="fa-solid fa-baby-carriage text-2xl text-midnight-navy"></i>
          </div>
          <h3 class="text-lg font-bold text-midnight-navy mb-2">Baby shower</h3>
          <p class="text-sm text-dove-gray">Pastelowe i urocze</p>
        </div>

        <!-- Bachelorette Cakes -->
        <div class="occasion-card vitreous-card p-6 text-center cursor-pointer" data-occasion="bachelorette">
          <div class="w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));">
            <i class="fa-solid fa-glass-cheers text-2xl text-midnight-navy"></i>
          </div>
          <h3 class="text-lg font-bold text-midnight-navy mb-2">Wieczór panieński</h3>
          <p class="text-sm text-dove-gray">Zabawne i eleganckie</p>
        </div>

        <!-- Women's Cakes -->
        <div class="occasion-card vitreous-card p-6 text-center cursor-pointer" data-occasion="women">
          <div class="w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));">
            <i class="fa-solid fa-female text-2xl text-midnight-navy"></i>
          </div>
          <h3 class="text-lg font-bold text-midnight-navy mb-2">Dla kobiet</h3>
          <p class="text-sm text-dove-gray">Eleganckie i wyrafinowane</p>
        </div>

        <!-- Men's Cakes -->
        <div class="occasion-card vitreous-card p-6 text-center cursor-pointer" data-occasion="men">
          <div class="w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));">
            <i class="fa-solid fa-male text-2xl text-midnight-navy"></i>
          </div>
          <h3 class="text-lg font-bold text-midnight-navy mb-2">Dla mężczyzn</h3>
          <p class="text-sm text-dove-gray">Minimalistyczne i eleganckie</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Cake Gallery (Hidden by default) -->
  <section id="cake-gallery" class="py-20 bg-porcelain-white relative overflow-hidden hidden">
    <!-- Art Deco Elements -->
    <div class="parallax-element" data-speed="0.3" style="position: absolute; left: 32px; top: 80px; z-index: 0; opacity: 0.5;">
      <div class="art-deco-line"></div>
    </div>
    <div class="parallax-element" data-speed="0.4" style="position: absolute; right: 32px; bottom: 80px; z-index: 0; opacity: 0.5;">
      <div class="art-deco-line"></div>
    </div>
    
    <div class="max-w-7xl mx-auto px-6 lg:px-8 relative z-10">
      <div class="text-center mb-16">
        <h2 class="font-display text-3xl md:text-4xl font-bold text-midnight-navy mb-6">Wybierz swój tort</h2>
        <p class="text-xl text-dove-gray max-w-3xl mx-auto leading-relaxed">
          Przejrzyj nasze propozycje i wybierz tort, który najbardziej Ci się podoba.
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-16" id="cake-images">
        <!-- Cake images will be populated by JavaScript -->
      </div>

      <div class="text-center">
        <button id="back-to-occasions-from-gallery" class="pill-button-secondary flex items-center justify-center text-lg font-medium px-8 py-4 mx-auto no-underline">
          <i class="fa-solid fa-arrow-left h-5 w-5 mr-3"></i>
          Wróć do okazji
        </button>
      </div>
    </div>
  </section>

  <!-- Cake Configuration (Hidden by default) -->
  <section id="cake-configuration" class="py-20 bg-porcelain-white relative overflow-hidden hidden">
    <div id="cake-config-anchor"></div>
    <!-- Art Deco Elements -->
    <div class="parallax-element" data-speed="0.3" style="position: absolute; left: 32px; top: 80px; z-index: 0; opacity: 0.5;">
      <div class="art-deco-line"></div>
    </div>
    <div class="parallax-element" data-speed="0.4" style="position: absolute; right: 32px; bottom: 80px; z-index: 0; opacity: 0.5;">
      <div class="art-deco-line"></div>
    </div>
    
    <div class="max-w-7xl mx-auto px-6 lg:px-8 relative z-10">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-start">
        <!-- Cake Preview -->
        <div>
          <div class="vitreous-card p-8">
            <h3 class="text-2xl font-bold text-midnight-navy mb-6">Twój wybrany tort</h3>
                         <div id="selected-cake-preview" class="w-full aspect-[3/4] rounded-lg bg-gradient-to-br from-champagne-gold/10 to-blush-rose/10 flex items-center justify-center mb-6">
               <i class="fa-solid fa-cake-candles text-6xl icon-gradient-gold-pink opacity-50"></i>
             </div>
            <div id="cake-info" class="space-y-4">
              <!-- Cake info will be populated by JavaScript -->
            </div>
          </div>
        </div>

        <!-- Configuration Options -->
        <div class="space-y-8">
          <!-- Size Selection -->
          <div class="vitreous-card p-8">
            <h3 class="text-xl font-bold text-midnight-navy mb-6">Wybierz rozmiar</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4" id="size-options">
              <div class="size-option vitreous-card p-4 text-center cursor-pointer border-2 border-transparent hover:border-playful-pink transition-colors" data-size="small">
                <div class="w-12 h-12 rounded-full mx-auto mb-3 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));">
                  <span class="text-xl font-bold text-midnight-navy">S</span>
                </div>
                <h4 class="font-bold text-midnight-navy mb-1">Mały</h4>
                <p class="text-sm text-dove-gray">8-10 osób</p>
                <p class="text-lg font-bold icon-gradient-gold-pink mt-2">120 zł</p>
              </div>
              <div class="size-option vitreous-card p-4 text-center cursor-pointer border-2 border-transparent hover:border-playful-pink transition-colors" data-size="medium">
                <div class="w-12 h-12 rounded-full mx-auto mb-3 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));">
                  <span class="text-xl font-bold text-midnight-navy">M</span>
                </div>
                <h4 class="font-bold text-midnight-navy mb-1">Średni</h4>
                <p class="text-sm text-dove-gray">15-20 osób</p>
                <p class="text-lg font-bold icon-gradient-gold-pink mt-2">180 zł</p>
              </div>
              <div class="size-option vitreous-card p-4 text-center cursor-pointer border-2 border-transparent hover:border-playful-pink transition-colors" data-size="large">
                <div class="w-12 h-12 rounded-full mx-auto mb-3 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));">
                  <span class="text-xl font-bold text-midnight-navy">L</span>
                </div>
                <h4 class="font-bold text-midnight-navy mb-1">Duży</h4>
                <p class="text-sm text-dove-gray">25-30 osób</p>
                <p class="text-lg font-bold icon-gradient-gold-pink mt-2">250 zł</p>
              </div>
            </div>
          </div>

          <!-- Taste Selection -->
          <div class="vitreous-card p-8">
            <h3 class="text-xl font-bold text-midnight-navy mb-6">Wybierz smak</h3>
            <div class="relative">
              <select id="taste-select" class="w-full p-4 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy font-medium focus:border-playful-pink focus:outline-none transition-colors">
                <option value="">Wybierz smak tortu</option>
                <!-- Taste options will be populated by JavaScript -->
              </select>
              <div class="absolute inset-y-0 right-0 flex items-center pr-4 pointer-events-none">
                <i class="fa-solid fa-chevron-down icon-gradient-gold-pink"></i>
              </div>
            </div>
          </div>

          <!-- Additional Decorations -->
          <div class="vitreous-card p-8">
            <h3 class="text-xl font-bold text-midnight-navy mb-6">Dodatkowe dekoracje</h3>
            <div class="space-y-4" id="decoration-options">
              <div class="flex items-center justify-between p-4 vitreous-card">
                <div>
                  <h4 class="font-bold text-midnight-navy">Żywe kwiaty</h4>
                  <p class="text-sm text-dove-gray">Dodaj świeże kwiaty do dekoracji</p>
                </div>
                <div class="flex items-center space-x-4">
                  <span class="text-lg font-bold icon-gradient-gold-pink">+30 zł</span>
                  <input type="checkbox" class="decoration-checkbox w-5 h-5 icon-gradient-gold-pink bg-transparent border-2 border-playful-pink rounded focus:ring-playful-pink" data-decoration="flowers" data-price="30">
                </div>
              </div>
              <div class="flex items-center justify-between p-4 vitreous-card">
                <div>
                  <h4 class="font-bold text-midnight-navy">Figurki z masy cukrowej</h4>
                  <p class="text-sm text-dove-gray">Spersonalizowane figurki</p>
                </div>
                <div class="flex items-center space-x-4">
                  <span class="text-lg font-bold icon-gradient-gold-pink">+25 zł</span>
                  <input type="checkbox" class="decoration-checkbox w-5 h-5 icon-gradient-gold-pink bg-transparent border-2 border-playful-pink rounded focus:ring-playful-pink" data-decoration="figures" data-price="25">
                </div>
              </div>
              <div class="flex items-center justify-between p-4 vitreous-card">
                <div>
                  <h4 class="font-bold text-midnight-navy">Napisy personalizowane</h4>
                  <p class="text-sm text-dove-gray">Imię, data, życzenia</p>
                </div>
                <div class="flex items-center space-x-4">
                  <span class="text-lg font-bold icon-gradient-gold-pink">+15 zł</span>
                  <input type="checkbox" class="decoration-checkbox w-5 h-5 icon-gradient-gold-pink bg-transparent border-2 border-playful-pink rounded focus:ring-playful-pink" data-decoration="text" data-price="15">
                </div>
              </div>
              <div id="custom-text-input" class="p-4 vitreous-card hidden">
                <label for="cake-text" class="block text-sm font-medium text-midnight-navy mb-2">Tekst na torcie:</label>
                <input type="text" id="cake-text" placeholder="np. 'Wszystkiego najlepszego Ania!'" class="w-full p-3 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy focus:border-playful-pink focus:outline-none transition-colors">
                <p class="text-xs text-dove-gray mt-1">Maksymalnie 30 znaków</p>
              </div>
            </div>
          </div>

          <!-- Order Summary -->
          <div class="vitreous-card p-8">
            <h3 class="text-xl font-bold text-midnight-navy mb-6">Podsumowanie zamówienia</h3>
            <div id="order-summary" class="space-y-4">
              <!-- Order summary will be populated by JavaScript -->
            </div>
            <div class="mt-6 pt-6 border-t border-dove-gray/20">
              <div class="flex justify-between items-center">
                <span class="text-lg font-bold text-midnight-navy">Razem:</span>
                <span id="total-price" class="text-2xl font-bold icon-gradient-gold-pink">0 zł</span>
              </div>
            </div>
            <button id="finalize-order" class="w-full mt-6 pill-button-pink flex items-center justify-center text-lg font-medium px-8 py-4 shadow-lg text-white no-underline">
              <i class="fa-solid fa-shopping-cart h-5 w-5 mr-3"></i>
              Złóż zamówienie
            </button>
          </div>
        </div>
      </div>

      <div class="text-center mt-12">
        <button id="back-to-gallery" class="pill-button-secondary flex items-center justify-center text-lg font-medium px-8 py-4 mx-auto no-underline">
          <i class="fa-solid fa-arrow-left h-5 w-5 mr-3"></i>
          Wróć do galerii
        </button>

      </div>
    </div>
  </section>

  <!-- Customer Data (Hidden by default) -->
  <section id="customer-data" class="py-20 bg-porcelain-white relative overflow-hidden hidden">
    <!-- Art Deco Elements -->
    <div class="parallax-element" data-speed="0.3" style="position: absolute; left: 32px; top: 80px; z-index: 0;">
      <div class="art-deco-line"></div>
    </div>
    <div class="parallax-element" data-speed="0.4" style="position: absolute; right: 32px; bottom: 80px; z-index: 0;">
      <div class="art-deco-line"></div>
    </div>
    
    <div class="max-w-4xl mx-auto px-6 lg:px-8 relative z-10">
      <div class="text-center mb-16">
        <h2 class="font-display text-3xl md:text-4xl font-bold text-midnight-navy mb-6">Dane kontaktowe</h2>
        <p class="text-xl text-dove-gray max-w-3xl mx-auto leading-relaxed">
          Podaj swoje dane, abyśmy mogli skontaktować się z Tobą w sprawie zamówienia.
        </p>
      </div>

      <div class="vitreous-card p-8">
        <form id="customer-form" class="space-y-6">
          <!-- Personal Information -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label for="firstName" class="block text-sm font-medium text-midnight-navy mb-2">Imię *</label>
              <input type="text" id="firstName" name="firstName" required class="w-full p-4 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy placeholder-dove-gray focus:border-playful-pink focus:outline-none transition-colors">
            </div>
            <div>
              <label for="lastName" class="block text-sm font-medium text-midnight-navy mb-2">Nazwisko *</label>
              <input type="text" id="lastName" name="lastName" required class="w-full p-4 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy placeholder-dove-gray focus:border-playful-pink focus:outline-none transition-colors">
            </div>
          </div>

          <!-- Contact Information -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label for="email" class="block text-sm font-medium text-midnight-navy mb-2">Email *</label>
              <input type="email" id="email" name="email" required class="w-full p-4 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy placeholder-dove-gray focus:border-playful-pink focus:outline-none transition-colors">
            </div>
            <div>
              <label for="phone" class="block text-sm font-medium text-midnight-navy mb-2">Telefon *</label>
              <input type="tel" id="phone" name="phone" required class="w-full p-4 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy placeholder-dove-gray focus:border-playful-pink focus:outline-none transition-colors">
            </div>
          </div>

          <!-- Delivery Option -->
          <div>
            <label class="block text-sm font-medium text-midnight-navy mb-4">Sposób odbioru *</label>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="delivery-option vitreous-card p-4 cursor-pointer border-2 border-transparent hover:border-playful-pink transition-colors" data-delivery="pickup">
                <div class="flex items-center">
                  <div class="w-8 h-8 rounded-full mr-3 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--playful-pink));">
                    <i class="fa-solid fa-store text-sm text-midnight-navy"></i>
                  </div>
                  <div>
                    <h4 class="font-bold text-midnight-navy">Odbór własny</h4>
                    <p class="text-sm text-dove-gray">Bezpłatnie</p>
                  </div>
                </div>
              </div>
              <div class="delivery-option vitreous-card p-4 cursor-pointer border-2 border-transparent hover:border-playful-pink transition-colors" data-delivery="delivery">
                <div class="flex items-center">
                  <div class="w-8 h-8 rounded-full mr-3 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--playful-pink));">
                    <i class="fa-solid fa-truck text-sm text-midnight-navy"></i>
                  </div>
                  <div>
                    <h4 class="font-bold text-midnight-navy">Dostawa</h4>
                    <p class="text-sm text-dove-gray">+15 zł</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Delivery Address (Hidden by default) -->
          <div id="delivery-address" class="space-y-6 hidden">
            <h3 class="text-lg font-bold text-midnight-navy mb-4">Adres dostawy</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="md:col-span-2">
                <label for="street" class="block text-sm font-medium text-midnight-navy mb-2">Ulica i numer *</label>
                <input type="text" id="street" name="street" class="w-full p-4 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy placeholder-dove-gray focus:border-playful-pink focus:outline-none transition-colors">
              </div>
              <div>
                <label for="postalCode" class="block text-sm font-medium text-midnight-navy mb-2">Kod pocztowy *</label>
                <input type="text" id="postalCode" name="postalCode" class="w-full p-4 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy placeholder-dove-gray focus:border-playful-pink focus:outline-none transition-colors">
              </div>
              <div>
                <label for="city" class="block text-sm font-medium text-midnight-navy mb-2">Miasto *</label>
                <input type="text" id="city" name="city" class="w-full p-4 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy placeholder-dove-gray focus:border-playful-pink focus:outline-none transition-colors">
              </div>
            </div>
          </div>

          <div class="flex flex-col sm:flex-row gap-4 pt-6 justify-between">
            <button type="button" id="back-to-configuration" class="pill-button-secondary flex items-center justify-center text-lg font-medium px-8 py-4 no-underline">
              <i class="fa-solid fa-arrow-left h-5 w-5 mr-3"></i>
              Wróć do konfiguracji
            </button>
            <button type="button" id="proceed-to-summary" class="pill-button-pink flex items-center justify-center text-lg font-medium px-8 py-4 no-underline">
              <i class="fa-solid fa-arrow-right h-5 w-5 mr-3"></i>
              Przejdź do podsumowania
            </button>
          </div>
        </form>
      </div>
    </div>
  </section>

  <!-- Order Summary (Hidden by default) -->
  <section id="order-summary-page" class="py-20 bg-porcelain-white relative overflow-hidden hidden">
    <!-- Art Deco Elements -->
    <div class="parallax-element" data-speed="0.3" style="position: absolute; left: 32px; top: 80px; z-index: 0; opacity: 0.5;">
      <div class="art-deco-line"></div>
    </div>
    <div class="parallax-element" data-speed="0.4" style="position: absolute; right: 32px; bottom: 80px; z-index: 0; opacity: 0.5;">
      <div class="art-deco-line"></div>
    </div>
    
    <div class="max-w-4xl mx-auto px-6 lg:px-8 relative z-10">
      <div class="text-center mb-16">
        <h2 class="font-display text-3xl md:text-4xl font-bold text-midnight-navy mb-6">Podsumowanie zamówienia</h2>
        <p class="text-xl text-dove-gray max-w-3xl mx-auto leading-relaxed">
          Sprawdź szczegóły zamówienia przed finalizacją.
        </p>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
        <!-- Order Details -->
        <div class="space-y-6">
          <div class="vitreous-card p-8">
            <h3 class="text-2xl font-bold text-midnight-navy mb-6">Szczegóły zamówienia</h3>
            <div id="final-order-summary" class="space-y-4">
              <!-- Order details will be populated by JavaScript -->
            </div>
            <div class="mt-6 pt-6 border-t border-dove-gray/20">
              <div class="flex justify-between items-center">
                <span class="text-lg font-bold text-midnight-navy">Razem:</span>
                <span id="final-total-price" class="text-2xl font-bold icon-gradient-gold-pink">0 zł</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Customer Information -->
        <div class="space-y-6">
          <div class="vitreous-card p-8">
            <h3 class="text-2xl font-bold text-midnight-navy mb-6">Dane kontaktowe</h3>
            <div id="customer-summary" class="space-y-4">
              <!-- Customer details will be populated by JavaScript -->
            </div>
          </div>

          <div class="vitreous-card p-8">
            <h3 class="text-2xl font-bold text-midnight-navy mb-6">Sposób odbioru</h3>
            <div id="delivery-summary" class="space-y-4">
              <!-- Delivery details will be populated by JavaScript -->
            </div>
          </div>
        </div>
      </div>

      <div class="flex flex-col sm:flex-row gap-4 justify-center mt-12">
        <button id="back-to-customer-data" class="pill-button-secondary flex items-center justify-center text-lg font-medium px-8 py-4 no-underline">
          <i class="fa-solid fa-arrow-left h-5 w-5 mr-3"></i>
          Wróć do danych
        </button>
        <button id="confirm-order" class="pill-button-pink flex items-center justify-center text-lg font-medium px-8 py-4 no-underline">
          <i class="fa-solid fa-check h-5 w-5 mr-3"></i>
          Potwierdź zamówienie
        </button>
      </div>
    </div>
  </section>



  <!-- Footer -->
  <footer class="bg-midnight-navy text-dove-gray py-12">
    <div class="max-w-7xl mx-auto px-6 lg:px-8">
      <div class="grid grid-cols-1 lg:grid-cols-5 gap-8 mb-8">
        <!-- Brand -->
        <div class="lg:col-span-2">
          <div class="flex items-center mb-4">
            <a href="index.html" aria-label="CakeBooking - Strona główna" class="flex items-center">
              <i class="fa-solid fa-cake-candles icon-gradient-gold-pink text-3xl mr-3"></i>
              <span class="font-display font-bold text-3xl text-pure-white">CakeBooking</span>
            </a>
          </div>
          <p class="text-dove-gray leading-relaxed mb-6 max-w-md">
            Koncepcja aplikacji łączącej miłośników tortów z najlepszymi cukierniami. Projektuj, zamawiaj i ciesz się wymarzonym tortem.
          </p>
          <div class="flex space-x-3">
            <a href="#" aria-label="Facebook" class="text-dove-gray hover:text-playful-pink transition-colors">
              <i class="fa-brands fa-facebook-f h-5 w-5"></i>
            </a>
            <a href="#" aria-label="Twitter" class="text-dove-gray hover:text-playful-pink transition-colors">
              <i class="fa-brands fa-x-twitter h-5 w-5"></i>
            </a>
            <a href="#" aria-label="Instagram" class="text-dove-gray hover:text-playful-pink transition-colors">
              <i class="fa-brands fa-instagram h-5 w-5"></i>
            </a>
          </div>
        </div>

        <!-- Produkty -->
        <div>
          <h4 class="text-pure-white font-medium mb-4 flex items-center">
            <i class="fa-solid fa-cube mr-2 icon-gradient-gold-pink"></i>
            Produkty
          </h4>
          <ul class="space-y-2">
            <li><a href="wizualizator-tortow.html" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-palette mr-2 text-xs"></i>
              Wizualizator 3D
            </a></li>
            <li><a href="gotowy-tort.html" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-thumbs-up mr-2 text-xs"></i>
              Gotowe torty
            </a></li>
            <li><a href="index.html#features" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-star mr-2 text-xs"></i>
              Funkcje
            </a></li>
            <li><a href="zamowienie.html" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-cake-candles mr-2 text-xs"></i>
              Zamów tort
            </a></li>
          </ul>
        </div>

        <!-- Firma -->
        <div>
          <h4 class="text-pure-white font-medium mb-4 flex items-center">
            <i class="fa-solid fa-building mr-2 icon-gradient-gold-pink"></i>
            Firma
          </h4>
          <ul class="space-y-2">
            <li><a href="o-nas.html" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-users mr-2 text-xs"></i>
              O nas
            </a></li>
            <li><a href="index.html#for-bakers-section" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-store mr-2 text-xs"></i>
              Dla cukierników
            </a></li>
            <li><a href="blog.html" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-blog mr-2 text-xs"></i>
              Blog
            </a></li>
            <li><a href="#" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-handshake mr-2 text-xs"></i>
              Partnerzy
            </a></li>
          </ul>
        </div>

        <!-- Pomoc -->
        <div>
          <h4 class="text-pure-white font-medium mb-4 flex items-center">
            <i class="fa-solid fa-life-ring mr-2 icon-gradient-gold-pink"></i>
            Pomoc
          </h4>
          <ul class="space-y-2">
            <li><a href="index.html#how-it-works" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-circle-info mr-2 text-xs"></i>
              Jak to działa
            </a></li>
            <li><a href="index.html#faq" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-question-circle mr-2 text-xs"></i>
              FAQ
            </a></li>
            <li><a href="#" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-headset mr-2 text-xs"></i>
              Wsparcie
            </a></li>
            <li><a href="kontakt.html" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-envelope mr-2 text-xs"></i>
              Kontakt
            </a></li>
          </ul>
        </div>
      </div>

      <!-- Legal Links -->
      <div class="pt-6 border-t border-dove-gray/20 mb-6">
        <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
          <div class="flex flex-wrap justify-center md:justify-start space-x-6 text-sm">
            <a href="polityka-prywatnosci.html" class="hover:text-playful-pink transition-colors">Polityka prywatności</a>
            <a href="warunki-uzytkowania.html" class="hover:text-playful-pink transition-colors">Warunki użytkowania</a>
            <a href="regulamin.html" class="hover:text-playful-pink transition-colors">Regulamin</a>
            <a href="cookies.html" class="hover:text-playful-pink transition-colors">Cookies</a>
          </div>
          <div class="flex space-x-3">
            <a href="#" aria-label="LinkedIn" class="text-dove-gray hover:text-playful-pink transition-colors">
              <i class="fa-brands fa-linkedin h-4 w-4"></i>
            </a>
            <a href="#" aria-label="YouTube" class="text-dove-gray hover:text-playful-pink transition-colors">
              <i class="fa-brands fa-youtube h-4 w-4"></i>
            </a>
          </div>
        </div>
      </div>

      <!-- Copyright -->
      <div class="pt-6 border-t border-dove-gray/20 text-center md:text-left">
        <p class="text-dove-gray text-sm">
          © <span id="current-year">2025</span> CakeBooking. Koncepcja aplikacji - prezentacja projektu.
        </p>
      </div>
    </div>
  </footer>

  <script src="cookies.js"></script>
  <script>
    // Cake data with image mappings
    const cakeData = {
      communion: {
        name: "Tort komunijny",
        imagePrefix: "komunia",
        imageCount: 4,
        decorations: [
          "Delikatne, eleganckie motywy – hostia, krzyżyk, złocenia",
          "Opłatki z imieniem dziecka",
          "Kwiaty z masy cukrowej i żywe kwiaty",
          "Papier jadalny, ozdoby w bieli i pastelach"
        ],
        tastes: [
          "Wanilia z maliną",
          "Sezonowe owoce z białą czekoladą",
          "Mleczna czekolada z chrupką i malinami",
          "Klasyczny śmietankowo-truskawkowy"
        ]
      },
      baptism: {
        name: "Tort na chrzest",
        imagePrefix: "chrzest",
        imageCount: 20,
        decorations: [
          "Urocze i subtelne ozdoby – aniołki",
          "Papier jadalny, makaroniki, żywe kwiaty",
          "Imię dziecka",
          "Pastelowe kolory (błękit, pudrowy róż, beż)",
          "Figurki niemowląt"
        ],
        tastes: [
          "Biała czekolada z maliną",
          "Śmietankowy z borówkami",
          "Delikatna wanilia z musem owocowym",
          "Kokosowy z mango"
        ]
      },
      wedding: {
        name: "Tort weselny",
        imagePrefix: "weselny",
        imageCount: 20,
        decorations: [
          "Wielopiętrowe torty z żywymi lub cukrowymi kwiatami",
          "Złote/srebrne akcenty, koronki z masy cukrowej",
          "Minimalistyczne białe torty lub romantyczne ombré",
          "Dekoracje rustykalne (suszone kwiaty i dodatki)",
          "Dekoracje pod motyw dekoracyjny wesela"
        ],
        tastes: [
          "Czekoladowy z wiśnią",
          "Tiramisu",
          "Pistacjowy z maliną",
          "Mango z białą czekoladą",
          "Szampanowy krem z maliną"
        ]
      },
      children: {
        name: "Tort dziecięcy",
        imagePrefix: "dzieci",
        imageCount: 0, // No children category in images yet
        decorations: [
          "Postacie z bajek, jednorożce, samochody",
          "Zwierzaki, piłki, dinozaury",
          "Kolory intensywne lub pastelowe",
          "Toppery z imieniem dziecka i cyfrą wieku"
        ],
        tastes: [
          "Nutella z bananem",
          "Czekoladowy z truskawką",
          "Mleczna czekolada z maliną",
          "Waniliowy z dostępnymi w danym sezonie owocami"
        ]
      },
      babyshower: {
        name: "Tort na baby shower",
        imagePrefix: "babyshower",
        imageCount: 4,
        decorations: [
          "Motywy \"It's a boy/girl\"",
          "Małe ubranka, bociany, baloniki, body",
          "Pastelowe kolory",
          "Dekoracje w różu, błękicie lub neutralnych odcieniach"
        ],
        tastes: [
          "Krem śmietankowy z maliną",
          "Biała czekolada z lemon curd",
          "Jogurtowo-owocowy",
          "Kokosowy z mango"
        ]
      },
      bachelorette: {
        name: "Tort na wieczór panieński",
        imagePrefix: "panienski",
        imageCount: 8,
        decorations: [
          "Żywe kwiaty, toppery z napisem \"Bride to be\"",
          "Usta, szpilki, koronki, kokardki",
          "Złote i różowe detale",
          "Czasem zabawne lub odważne dekoracje"
        ],
        tastes: [
          "Malina z pistacją-truskawkowy",
          "Słony karmel z kremem mascarpone",
          "Oreo z kremem waniliowym"
        ]
      },
      women: {
        name: "Tort dla kobiet",
        imagePrefix: "kobieta",
        imageCount: 30,
        decorations: [
          "Kwiaty (żywe), eleganckie wzory",
          "Złoto, brokat, minimalizm",
          "Toppery z imieniem lub liczbą lat",
          "Pastelowe lub klasyczne kolory"
        ],
        tastes: [
          "Malina z mascarpone",
          "Pistacja z białą czekoladą",
          "Tiramisu",
          "Cytrynowy z kremem z białej czekolady",
          "Różany z maliną"
        ]
      },
      men: {
        name: "Tort dla mężczyzn",
        imagePrefix: "mezczyzna",
        imageCount: 14,
        decorations: [
          "Minimalistyczne, eleganckie",
          "Często tematyczne (motoryzacja, alkohol, sport, garnitury, zegarki)",
          "Czernie, granat, grafit"
        ],
        tastes: [
          "Mleczna czekolada",
          "Słony karmel",
          "Orzechowy z nutą rumu",
          "Brownie z kremem kawowym",
          "Czekolada z wiśnią bądź maliną"
        ]
      }
    };

    let selectedOccasion = null;
    let selectedTaste = null;
    let selectedCake = null;
    let selectedSize = null;
    let selectedDecorations = [];
    let selectedDelivery = null;
    let customerData = {};
    let basePrice = 0;

    // Step management for browser navigation
    const STEPS = {
      OCCASION: 'occasion',
      GALLERY: 'gallery', 
      CONFIGURATION: 'configuration',
      CUSTOMER_DATA: 'customer-data',
      ORDER_SUMMARY: 'order-summary'
    };
    
    let currentStep = STEPS.OCCASION;

    // Initialize the page
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize browser history
      initializeBrowserHistory();
      
      // Handle browser back/forward buttons
      window.addEventListener('popstate', handlePopState);
      
      // Mobile menu toggle
      const mobileMenuButton = document.getElementById('mobile-menu-button');
      const mobileMenu = document.getElementById('mobile-menu');
      
      mobileMenuButton.addEventListener('click', function() {
        const isExpanded = mobileMenuButton.getAttribute('aria-expanded') === 'true';
        mobileMenuButton.setAttribute('aria-expanded', !isExpanded);
        mobileMenu.classList.toggle('hidden');
      });

      // Occasion selection
      const occasionCards = document.querySelectorAll('.occasion-card');
      occasionCards.forEach(card => {
        card.addEventListener('click', function() {
          const occasion = this.dataset.occasion;
          selectOccasion(occasion);
        });
      });

      // Back to occasions buttons
      document.getElementById('back-to-occasions-from-gallery').addEventListener('click', function() {
        navigateToStep(STEPS.OCCASION);
      });

      document.getElementById('back-to-gallery').addEventListener('click', function() {
        navigateToStep(STEPS.GALLERY);
      });

      // Finalize order button
      document.getElementById('finalize-order').addEventListener('click', function() {
        const tasteSelect = document.getElementById('taste-select');
        const selectedTasteValue = tasteSelect.value;
        
        if (!selectedSize || !selectedTasteValue) {
          alert('Proszę wybrać rozmiar i smak tortu przed złożeniem zamówienia.');
          return;
        }
        
        // Update selectedTaste if it's not set
        if (!selectedTaste) {
          selectedTaste = selectedTasteValue;
        }
        
        navigateToStep(STEPS.CUSTOMER_DATA);
      });

      // Custom text input
      document.getElementById('cake-text').addEventListener('input', function() {
        // Limit to 30 characters
        if (this.value.length > 30) {
          this.value = this.value.substring(0, 30);
        }
        updateOrderSummary();
        updateBrowserHistory();
      });

      document.getElementById('back-to-configuration').addEventListener('click', function() {
        navigateToStep(STEPS.CONFIGURATION);
      });

      document.getElementById('proceed-to-summary').addEventListener('click', function() {
        if (!validateCustomerForm()) {
          return;
        }
        collectCustomerData();
        navigateToStep(STEPS.ORDER_SUMMARY);
      });

      document.getElementById('back-to-customer-data').addEventListener('click', function() {
        navigateToStep(STEPS.CUSTOMER_DATA);
      });

      document.getElementById('confirm-order').addEventListener('click', function() {
        submitOrder();
      });

      // Initialize delivery options
      initializeDeliveryOptions();

      // Initialize customer form field listeners
      initializeCustomerFormListeners();

      // Set current year in footer
      document.getElementById('current-year').textContent = new Date().getFullYear();
    });

    function initializeBrowserHistory() {
      // Set initial state
      const state = {
        step: STEPS.OCCASION,
        occasion: null,
        cake: null,
        size: null,
        taste: null,
        decorations: [],
        delivery: null,
        customerData: {}
      };
      
      history.replaceState(state, '', window.location.pathname);
    }

    function handlePopState(event) {
      if (event.state) {
        const state = event.state;
        
        // Restore state
        selectedOccasion = state.occasion;
        selectedCake = state.cake;
        selectedSize = state.size;
        selectedTaste = state.taste;
        selectedDecorations = state.decorations || [];
        selectedDelivery = state.delivery;
        customerData = state.customerData || {};
        
        // Navigate to the step
        navigateToStep(state.step, false); // false = don't update history
      } else {
        // Fallback to occasion selector
        navigateToStep(STEPS.OCCASION, false);
      }
    }

    function navigateToStep(step, updateHistory = true) {
      currentStep = step;
      
      // Update history if needed
      if (updateHistory) {
        const state = {
          step: step,
          occasion: selectedOccasion,
          cake: selectedCake,
          size: selectedSize,
          taste: selectedTaste,
          decorations: selectedDecorations,
          delivery: selectedDelivery,
          customerData: customerData
        };
        
        const url = step === STEPS.OCCASION ? 
          window.location.pathname : 
          `${window.location.pathname}#${step}`;
        
        history.pushState(state, '', url);
      }
      
      // Show appropriate section
      switch (step) {
        case STEPS.OCCASION:
          showOccasionSelector();
          break;
        case STEPS.GALLERY:
          showCakeGallery();
          break;
        case STEPS.CONFIGURATION:
          showCakeConfiguration();
          break;
        case STEPS.CUSTOMER_DATA:
          showCustomerData();
          break;
        case STEPS.ORDER_SUMMARY:
          showOrderSummary();
          break;
      }
    }

    function selectOccasion(occasion) {
      selectedOccasion = occasion;
      navigateToStep(STEPS.GALLERY);
      loadCakeImages(occasion);
    }

    function loadCakeImages(occasion) {
      const cakeImages = document.getElementById('cake-images');
      cakeImages.innerHTML = '';
      
      const occasionData = cakeData[occasion];
      
      if (occasionData.imageCount === 0) {
        // No images available for this category
        cakeImages.innerHTML = `
          <div class="col-span-full text-center py-12">
            <i class="fa-solid fa-image text-6xl text-dove-gray mb-4"></i>
            <h3 class="text-xl font-bold text-midnight-navy mb-2">Brak zdjęć</h3>
            <p class="text-dove-gray">Zdjęcia dla tej kategorii będą dostępne wkrótce.</p>
          </div>
        `;
        return;
      }
      
      // Load images for the occasion
      for (let i = 1; i <= occasionData.imageCount; i++) {
        const imageCard = document.createElement('div');
        imageCard.className = 'vitreous-card p-4 cursor-pointer border-2 border-transparent hover:border-playful-pink transition-colors';
        imageCard.onclick = () => selectCake(occasion, i);
        
        // Map occasion to correct directory name
        const directoryMap = {
          'men': 'dal',
          'women': 'dla_kobiet',
          'baptism': 'chrzestne',
          'wedding': 'weselne',
          'bachelorette': 'wieczorpanienski',
          'babyshower': 'babyshower',
          'communion': 'komunia'
        };
        
        const directoryName = directoryMap[occasion] || occasionData.imagePrefix;
        let imageSrc = `images/${directoryName}/${occasionData.imagePrefix}_${i.toString().padStart(2, '0')}.jpeg`;
        
        imageCard.innerHTML = `
          <div class="aspect-[3/4] rounded-lg overflow-hidden mb-4 bg-gradient-to-br from-champagne-gold/10 to-blush-rose/10">
            <img src="${imageSrc}" alt="Tort ${occasionData.name} ${i}" class="w-full h-full object-cover hover:scale-105 transition-transform duration-300" onerror="handleImageError(this, '${occasionData.imagePrefix}', ${i})">
            <div class="w-full h-full flex items-center justify-center" style="display: none;">
              <i class="fa-solid fa-cake-candles text-4xl icon-gradient-gold-pink opacity-50"></i>
            </div>
          </div>
          <h3 class="text-lg font-bold text-midnight-navy text-center">Tort ${i}</h3>
          <p class="text-sm text-dove-gray text-center">Kliknij aby wybrać</p>
        `;
        
        cakeImages.appendChild(imageCard);
      }
    }

    function selectCake(occasion, cakeNumber) {
      selectedCake = { occasion, cakeNumber };
      navigateToStep(STEPS.CONFIGURATION);
      updateCakeConfiguration();
    }

    function updateCakeConfiguration() {
      const occasionData = cakeData[selectedCake.occasion];
      
      // Map occasion to correct directory name
      const directoryMap = {
        'men': 'dal',
        'women': 'dla_kobiet',
        'baptism': 'chrzestne',
        'wedding': 'weselne',
        'bachelorette': 'wieczorpanienski',
        'babyshower': 'babyshower',
        'communion': 'komunia'
      };
      
      const directoryName = directoryMap[selectedCake.occasion] || occasionData.imagePrefix;
      const cakeImageSrc = `images/${directoryName}/${occasionData.imagePrefix}_${selectedCake.cakeNumber.toString().padStart(2, '0')}.jpeg`;
      
      // Update cake preview
      const previewContainer = document.getElementById('selected-cake-preview');
      previewContainer.innerHTML = `
        <img src="${cakeImageSrc}" alt="Wybrany tort" class="w-full h-full object-cover rounded-lg" onerror="handleConfigImageError(this, '${occasionData.imagePrefix}', ${selectedCake.cakeNumber})">
        <div class="w-full h-full flex items-center justify-center" style="display: none;">
          <i class="fa-solid fa-cake-candles text-6xl icon-gradient-gold-pink opacity-50"></i>
        </div>
      `;
      
      // Update cake info
      const cakeInfo = document.getElementById('cake-info');
      cakeInfo.innerHTML = `
        <div>
          <h4 class="font-bold text-midnight-navy">${occasionData.name}</h4>
          <p class="text-sm text-dove-gray">Tort ${selectedCake.cakeNumber}</p>
        </div>
      `;
      
      // Populate taste options
      const tasteSelect = document.getElementById('taste-select');
      tasteSelect.innerHTML = '<option value="">Wybierz smak tortu</option>';
      
      occasionData.tastes.forEach((taste, index) => {
        const option = document.createElement('option');
        option.value = taste;
        option.textContent = taste;
        tasteSelect.appendChild(option);
      });
      
      // Initialize size selection
      initializeSizeSelection();
      
      // Initialize decoration checkboxes
      initializeDecorationCheckboxes();
      
      // Initialize taste select
      initializeTasteSelect();
      
      // Update order summary
      updateOrderSummary();
    }



    function initializeSizeSelection() {
      const sizeOptions = document.querySelectorAll('.size-option');
      sizeOptions.forEach(option => {
        option.onclick = () => {
          // Remove selection from all options
          sizeOptions.forEach(opt => {
            opt.classList.remove('selected', 'border-playful-pink', 'bg-playful-pink/5', 'ring-2', 'ring-playful-pink/20');
            opt.classList.add('border-transparent');
            opt.style.backgroundColor = '';
            opt.style.borderColor = '';
          });
          
          // Select clicked option
          option.classList.remove('border-transparent');
          option.classList.add('selected', 'border-playful-pink', 'bg-playful-pink/5', 'ring-2', 'ring-playful-pink/20');
          option.style.backgroundColor = 'rgba(212, 175, 55, 0.1)';
          option.style.borderColor = 'rgb(212, 175, 55)';
          
          selectedSize = option.dataset.size;
          updateOrderSummary();
          updateBrowserHistory();
        };
      });
    }

    function initializeDecorationCheckboxes() {
      const checkboxes = document.querySelectorAll('.decoration-checkbox');
      checkboxes.forEach(checkbox => {
        checkbox.onchange = () => {
          const decoration = checkbox.dataset.decoration;
          const price = parseInt(checkbox.dataset.price);
          
          if (checkbox.checked) {
            if (!selectedDecorations.find(d => d.name === decoration)) {
              selectedDecorations.push({ name: decoration, price: price });
            }
            
            // Show text input if text decoration is selected
            if (decoration === 'text') {
              document.getElementById('custom-text-input').classList.remove('hidden');
            }
          } else {
            selectedDecorations = selectedDecorations.filter(d => d.name !== decoration);
            
            // Hide text input if text decoration is deselected
            if (decoration === 'text') {
              document.getElementById('custom-text-input').classList.add('hidden');
              document.getElementById('cake-text').value = '';
            }
          }
          
          updateOrderSummary();
          updateBrowserHistory();
        };
      });
    }

    function initializeTasteSelect() {
      const tasteSelect = document.getElementById('taste-select');
      tasteSelect.onchange = () => {
        selectedTaste = tasteSelect.value;
        updateOrderSummary();
        updateBrowserHistory();
      };
    }

    function updateBrowserHistory() {
      // Update the current history entry with new state
      const state = {
        step: currentStep,
        occasion: selectedOccasion,
        cake: selectedCake,
        size: selectedSize,
        taste: selectedTaste,
        decorations: selectedDecorations,
        delivery: selectedDelivery,
        customerData: customerData
      };
      
      const url = currentStep === STEPS.OCCASION ? 
        window.location.pathname : 
        `${window.location.pathname}#${currentStep}`;
      
      history.replaceState(state, '', url);
    }

    function updateOrderSummary() {
      const summary = document.getElementById('order-summary');
      const totalPrice = document.getElementById('total-price');
      
      let total = 0;
      let summaryHTML = '';
      
      // Base cake
      if (selectedCake) {
        const occasionData = cakeData[selectedCake.occasion];
        summaryHTML += `
          <div class="flex justify-between items-center">
            <span class="text-midnight-navy">${occasionData.name} - Tort ${selectedCake.cakeNumber}</span>
            <span class="icon-gradient-gold-pink">-</span>
          </div>
        `;
      }
      
      // Size
      if (selectedSize) {
        const sizePrices = { small: 120, medium: 180, large: 250 };
        const sizeNames = { small: 'Mały', medium: 'Średni', large: 'Duży' };
        total += sizePrices[selectedSize];
        
        summaryHTML += `
          <div class="flex justify-between items-center">
            <span class="text-midnight-navy">Rozmiar: ${sizeNames[selectedSize]}</span>
            <span class="icon-gradient-gold-pink">${sizePrices[selectedSize]} zł</span>
          </div>
        `;
      }
      
      // Taste
      if (selectedTaste) {
        summaryHTML += `
          <div class="flex justify-between items-center">
            <span class="text-midnight-navy">Smak: ${selectedTaste}</span>
            <span class="icon-gradient-gold-pink">-</span>
          </div>
        `;
      }
      
      // Decorations
      selectedDecorations.forEach(decoration => {
        total += decoration.price;
        let decorationName = decoration.name;
        
        // Add custom text if available
        if (decoration.name === 'text') {
          const customText = document.getElementById('cake-text').value;
          if (customText) {
            decorationName = `Napisy: "${customText}"`;
          }
        }
        
        summaryHTML += `
          <div class="flex justify-between items-center">
            <span class="text-midnight-navy">+ ${decorationName}</span>
            <span class="icon-gradient-gold-pink">+${decoration.price} zł</span>
          </div>
        `;
      });
      
      summary.innerHTML = summaryHTML;
      totalPrice.textContent = `${total} zł`;
    }

    function showOccasionSelector() {
      document.getElementById('occasion-selector').classList.remove('hidden');
      document.getElementById('cake-gallery').classList.add('hidden');
      document.getElementById('cake-configuration').classList.add('hidden');
      document.getElementById('customer-data').classList.add('hidden');
      document.getElementById('order-summary-page').classList.add('hidden');
      
      // Scroll to occasion selector
      const anchor = document.getElementById('occasion-selector');
      if (anchor) {
        anchor.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    }

    function showCakeGallery() {
      document.getElementById('occasion-selector').classList.add('hidden');
      document.getElementById('cake-gallery').classList.remove('hidden');
      document.getElementById('cake-configuration').classList.add('hidden');
      document.getElementById('customer-data').classList.add('hidden');
      document.getElementById('order-summary-page').classList.add('hidden');
      
      // Scroll to cake gallery
      const anchor = document.getElementById('cake-gallery');
      if (anchor) {
        anchor.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
      
      // Load images if we have an occasion selected
      if (selectedOccasion) {
        loadCakeImages(selectedOccasion);
      }
    }

    function showCakeConfiguration() {
      document.getElementById('occasion-selector').classList.add('hidden');
      document.getElementById('cake-gallery').classList.add('hidden');
      document.getElementById('cake-configuration').classList.remove('hidden');
      document.getElementById('customer-data').classList.add('hidden');
      document.getElementById('order-summary-page').classList.add('hidden');
      
      // Scroll to configurator header
      const anchor = document.getElementById('cake-config-anchor');
      if (anchor) {
        anchor.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
      
      // Update configuration if we have a cake selected
      if (selectedCake) {
        updateCakeConfiguration();
      }
    }

    function showCustomerData() {
      document.getElementById('occasion-selector').classList.add('hidden');
      document.getElementById('cake-gallery').classList.add('hidden');
      document.getElementById('cake-configuration').classList.add('hidden');
      document.getElementById('customer-data').classList.remove('hidden');
      document.getElementById('order-summary-page').classList.add('hidden');
      
      // Scroll to customer data section
      const anchor = document.getElementById('customer-data');
      if (anchor) {
        anchor.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
      
      // Restore form data if available
      if (customerData.firstName) {
        document.getElementById('firstName').value = customerData.firstName;
        document.getElementById('lastName').value = customerData.lastName;
        document.getElementById('email').value = customerData.email;
        document.getElementById('phone').value = customerData.phone;
        
        if (customerData.address) {
          document.getElementById('street').value = customerData.address.street;
          document.getElementById('postalCode').value = customerData.address.postalCode;
          document.getElementById('city').value = customerData.address.city;
        }
        
        // Restore delivery selection
        if (selectedDelivery) {
          document.querySelectorAll('.delivery-option').forEach(opt => {
            opt.classList.remove('selected', 'border-playful-pink', 'bg-playful-pink/5');
            opt.classList.add('border-transparent');
          });
          
          const selectedOption = document.querySelector(`[data-delivery="${selectedDelivery}"]`);
          if (selectedOption) {
            selectedOption.classList.remove('border-transparent');
            selectedOption.classList.add('selected', 'border-playful-pink', 'bg-playful-pink/5');
            
            if (selectedDelivery === 'delivery') {
              document.getElementById('delivery-address').classList.remove('hidden');
            }
          }
        }
      }
    }

    function showOrderSummary() {
      // Hide all other sections and show order summary
      document.getElementById('occasion-selector').classList.add('hidden');
      document.getElementById('cake-gallery').classList.add('hidden');
      document.getElementById('cake-configuration').classList.add('hidden');
      document.getElementById('customer-data').classList.add('hidden');
      document.getElementById('order-summary-page').classList.remove('hidden');
      
      // Scroll to order summary section
      const anchor = document.getElementById('order-summary-page');
      if (anchor) {
        anchor.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
      
      // Populate order summary
      const finalOrderSummary = document.getElementById('final-order-summary');
      const finalTotalPrice = document.getElementById('final-total-price');
      
      let total = 0;
      let summaryHTML = '';
      
      // Base cake
      if (selectedCake) {
        const occasionData = cakeData[selectedCake.occasion];
        summaryHTML += `
          <div class="flex justify-between items-center">
            <span class="text-midnight-navy">${occasionData.name} - Tort ${selectedCake.cakeNumber}</span>
            <span class="icon-gradient-gold-pink">-</span>
          </div>
        `;
      }
      
      // Size
      if (selectedSize) {
        const sizePrices = { small: 120, medium: 180, large: 250 };
        const sizeNames = { small: 'Mały', medium: 'Średni', large: 'Duży' };
        total += sizePrices[selectedSize];
        
        summaryHTML += `
          <div class="flex justify-between items-center">
            <span class="text-midnight-navy">Rozmiar: ${sizeNames[selectedSize]}</span>
            <span class="icon-gradient-gold-pink">${sizePrices[selectedSize]} zł</span>
          </div>
        `;
      }
      
      // Taste
      if (selectedTaste) {
        summaryHTML += `
          <div class="flex justify-between items-center">
            <span class="text-midnight-navy">Smak: ${selectedTaste}</span>
            <span class="icon-gradient-gold-pink">-</span>
          </div>
        `;
      }
      
      // Decorations
      selectedDecorations.forEach(decoration => {
        total += decoration.price;
        let decorationName = decoration.name;
        
        if (decoration.name === 'text') {
          const customText = document.getElementById('cake-text').value;
          if (customText) {
            decorationName = `Napisy: "${customText}"`;
          }
        }
        
        summaryHTML += `
          <div class="flex justify-between items-center">
            <span class="text-midnight-navy">+ ${decorationName}</span>
            <span class="icon-gradient-gold-pink">+${decoration.price} zł</span>
          </div>
        `;
      });
      
      // Delivery
      if (selectedDelivery === 'delivery') {
        total += 15;
        summaryHTML += `
          <div class="flex justify-between items-center">
            <span class="text-midnight-navy">Dostawa</span>
            <span class="icon-gradient-gold-pink">+15 zł</span>
          </div>
        `;
      }
      
      finalOrderSummary.innerHTML = summaryHTML;
      finalTotalPrice.textContent = `${total} zł`;
      
      // Populate customer summary
      const customerSummary = document.getElementById('customer-summary');
      if (customerData.firstName) {
        customerSummary.innerHTML = `
          <div class="space-y-2">
            <div><strong>Imię i nazwisko:</strong> ${customerData.firstName} ${customerData.lastName}</div>
            <div><strong>Email:</strong> ${customerData.email}</div>
            <div><strong>Telefon:</strong> ${customerData.phone}</div>
          </div>
        `;
      }
      
      // Populate delivery summary
      const deliverySummary = document.getElementById('delivery-summary');
      if (selectedDelivery === 'pickup') {
        deliverySummary.innerHTML = `
          <div class="space-y-2">
            <div><strong>Sposób:</strong> Odbór własny</div>
            <div class="text-sm text-dove-gray">Bezpłatnie</div>
          </div>
        `;
      } else if (selectedDelivery === 'delivery' && customerData.address) {
        deliverySummary.innerHTML = `
          <div class="space-y-2">
            <div><strong>Sposób:</strong> Dostawa</div>
            <div><strong>Adres:</strong></div>
            <div class="text-sm text-dove-gray">
              ${customerData.address.street}<br>
              ${customerData.address.postalCode} ${customerData.address.city}
            </div>
            <div class="text-sm text-dove-gray">Koszt: +15 zł</div>
          </div>
        `;
      }
    }

    function initializeDeliveryOptions() {
      const deliveryOptions = document.querySelectorAll('.delivery-option');
      deliveryOptions.forEach(option => {
        option.onclick = () => {
          // Remove selection from all options
          deliveryOptions.forEach(opt => {
            opt.classList.remove('selected', 'border-playful-pink', 'bg-playful-pink/5');
            opt.classList.add('border-transparent');
          });
          
          // Select clicked option
          option.classList.remove('border-transparent');
          option.classList.add('selected', 'border-playful-pink', 'bg-playful-pink/5');
          
          selectedDelivery = option.dataset.delivery;
          
          // Show/hide delivery address
          const deliveryAddress = document.getElementById('delivery-address');
          if (selectedDelivery === 'delivery') {
            deliveryAddress.classList.remove('hidden');
            // Make address fields required
            document.getElementById('street').required = true;
            document.getElementById('postalCode').required = true;
            document.getElementById('city').required = true;
          } else {
            deliveryAddress.classList.add('hidden');
            // Remove required from address fields
            document.getElementById('street').required = false;
            document.getElementById('postalCode').required = false;
            document.getElementById('city').required = false;
          }
          
          updateBrowserHistory();
        };
      });
    }

    function validateCustomerForm() {
      const requiredFields = ['firstName', 'lastName', 'email', 'phone'];
      let isValid = true;
      
      requiredFields.forEach(fieldId => {
        const field = document.getElementById(fieldId);
        if (!field.value.trim()) {
          field.style.borderColor = '#ef4444';
          isValid = false;
        } else {
          field.style.borderColor = '';
        }
      });
      
      if (!selectedDelivery) {
        alert('Proszę wybrać sposób odbioru.');
        isValid = false;
      }
      
      if (selectedDelivery === 'delivery') {
        const addressFields = ['street', 'postalCode', 'city'];
        addressFields.forEach(fieldId => {
          const field = document.getElementById(fieldId);
          if (!field.value.trim()) {
            field.style.borderColor = '#ef4444';
            isValid = false;
          } else {
            field.style.borderColor = '';
          }
        });
      }
      
      if (!isValid) {
        alert('Proszę wypełnić wszystkie wymagane pola.');
      }
      
      return isValid;
    }

    function collectCustomerData() {
      customerData = {
        firstName: document.getElementById('firstName').value,
        lastName: document.getElementById('lastName').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        delivery: selectedDelivery,
        address: selectedDelivery === 'delivery' ? {
          street: document.getElementById('street').value,
          postalCode: document.getElementById('postalCode').value,
          city: document.getElementById('city').value
        } : null
      };
    }

    function submitOrder() {
      // Here you would typically send the order data to your backend
      const orderData = {
        cake: selectedCake,
        size: selectedSize,
        taste: selectedTaste,
        decorations: selectedDecorations,
        delivery: selectedDelivery,
        customer: customerData,
        total: calculateTotal()
      };
      
      console.log('Order submitted:', orderData);
      alert('Dziękujemy za zamówienie! Skontaktujemy się z Tobą wkrótce, aby potwierdzić szczegóły.');
      
      // Reset form and go back to start
      resetForm();
      showOccasionSelector();
    }

    function calculateTotal() {
      let total = 0;
      
      if (selectedSize) {
        const sizePrices = { small: 120, medium: 180, large: 250 };
        total += sizePrices[selectedSize];
      }
      
      selectedDecorations.forEach(decoration => {
        total += decoration.price;
      });
      
      if (selectedDelivery === 'delivery') {
        total += 15;
      }
      
      return total;
    }

    function resetForm() {
      // Reset all selections
      selectedOccasion = null;
      selectedTaste = null;
      selectedCake = null;
      selectedSize = null;
      selectedDecorations = [];
      selectedDelivery = null;
      customerData = {};
      
      // Reset form fields
      document.getElementById('customer-form').reset();
      document.getElementById('delivery-address').classList.add('hidden');
      
      // Reset size selection
      document.querySelectorAll('.size-option').forEach(opt => {
        opt.classList.remove('selected', 'border-champagne-gold', 'bg-champagne-gold/5');
        opt.classList.add('border-transparent');
      });
      
      // Reset delivery selection
      document.querySelectorAll('.delivery-option').forEach(opt => {
        opt.classList.remove('selected', 'border-champagne-gold', 'bg-champagne-gold/5');
        opt.classList.add('border-transparent');
      });
      
      // Reset taste selection
      document.getElementById('taste-select').value = '';
      
      // Reset decoration checkboxes
      document.querySelectorAll('.decoration-checkbox').forEach(checkbox => {
        checkbox.checked = false;
      });
      
      document.getElementById('custom-text-input').classList.add('hidden');
      document.getElementById('cake-text').value = '';
    }

    function handleImageError(img, prefix, number) {
      const extensions = ['jpg', 'png'];
      const currentSrc = img.src;
      const currentExt = currentSrc.split('.').pop();
      
      // Extract directory from current path
      const pathParts = currentSrc.split('/');
      const directory = pathParts[pathParts.length - 2];
      
      // Remove current extension from tried extensions
      const remainingExtensions = extensions.filter(ext => ext !== currentExt);
      
      if (remainingExtensions.length > 0) {
        // Try next extension
        const nextExt = remainingExtensions[0];
        const newSrc = `images/${directory}/${prefix}_${number.toString().padStart(2, '0')}.${nextExt}`;
        img.src = newSrc;
      } else {
        // All extensions failed, show placeholder
        img.style.display = 'none';
        img.nextElementSibling.style.display = 'flex';
      }
    }

    function handleConfigImageError(img, prefix, number) {
      const extensions = ['jpg', 'png'];
      const currentSrc = img.src;
      const currentExt = currentSrc.split('.').pop();
      
      // Extract directory from current path
      const pathParts = currentSrc.split('/');
      const directory = pathParts[pathParts.length - 2];
      
      // Remove current extension from tried extensions
      const remainingExtensions = extensions.filter(ext => ext !== currentExt);
      
      if (remainingExtensions.length > 0) {
        // Try next extension
        const nextExt = remainingExtensions[0];
        const newSrc = `images/${directory}/${prefix}_${number.toString().padStart(2, '0')}.${nextExt}`;
        img.src = newSrc;
      } else {
        // All extensions failed, show placeholder
        img.style.display = 'flex';
        img.nextElementSibling.style.display = 'flex';
      }
    }

    function initializeCustomerFormListeners() {
      const formFields = ['firstName', 'lastName', 'email', 'phone', 'street', 'postalCode', 'city'];
      
      formFields.forEach(fieldId => {
        const field = document.getElementById(fieldId);
        if (field) {
          field.addEventListener('input', function() {
            // Update customerData object
            if (fieldId === 'street' || fieldId === 'postalCode' || fieldId === 'city') {
              if (!customerData.address) {
                customerData.address = {};
              }
              customerData.address[fieldId] = this.value;
            } else {
              customerData[fieldId] = this.value;
            }
            
            updateBrowserHistory();
          });
        }
      });
    }
  </script>
</body>
</html> 