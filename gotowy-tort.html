<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gotowy Tort - Wybierz idealny tort dla swojej okazji | CakeBooking</title>
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="styles.css">
  <style>
    body {
      scrollbar-width: thin;
      scrollbar-color: rgba(191, 202, 217, 0.7) transparent;
    }

    body::-webkit-scrollbar {
      width: 12px;
    }

    body::-webkit-scrollbar-track {
      background: transparent;
    }

    body::-webkit-scrollbar-thumb {
      background-color: rgba(191, 202, 217, 0);
      border-radius: 20px;
      border: 3px solid transparent;
      background-clip: content-box;
    }

    body:hover::-webkit-scrollbar-thumb {
      background-color: rgba(191, 202, 217, 0.7);
    }

    .occasion-card {
      transition: all 0.3s ease;
    }

    .occasion-card:hover {
      transform: translateY(-2px);
    }

    .occasion-card.selected {
      border-color: var(--champagne-gold-start);
      background: linear-gradient(135deg, rgba(247, 245, 242, 0.1), rgba(247, 245, 242, 0.05));
    }

    .taste-option {
      transition: all 0.3s ease;
    }

    .taste-option:hover {
      background-color: rgba(247, 245, 242, 0.1);
    }

    .taste-option.selected {
      background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));
      color: var(--midnight-navy);
    }

    .delivery-option.selected {
      border-color: rgb(212, 175, 55) !important;
      background-color: rgba(212, 175, 55, 0.1) !important;
      box-shadow: 0 0 0 2px rgba(212, 175, 55, 0.2) !important;
    }

    .delivery-option:hover {
      border-color: rgb(212, 175, 55) !important;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(212, 175, 55, 0.15);
    }

    /* Ensure sticky positioning works properly */
    .sticky {
      position: -webkit-sticky;
      position: sticky;
    }

    /* Navigation Dropdown Styles */
    .group:hover .group-hover\:rotate-180 {
      transform: rotate(180deg);
    }

    /* Ensure dropdowns appear above other content */
    .relative.group {
      z-index: 50;
    }

    /* Smooth dropdown animations */
    .group:hover .group-hover\:opacity-100 {
      transition-delay: 0.1s;
    }

    /* Mobile menu improvements */
    #mobile-menu {
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    /* Modal animations */
    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: scale(0.9) translateY(-20px);
      }
      to {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }

    #success-modal .transform,
    #error-modal .transform {
      animation: modalSlideIn 0.3s ease-out;
    }

    /* Success modal gradient text */
    #success-modal h3 {
      color: #1f2937 !important; /* Dark gray */
    }

    #success-modal p {
      color: #374151 !important; /* Medium gray */
    }

    #success-modal .fa-check {
      color: #1f2937 !important; /* Dark gray for success icon */
    }

    #error-modal h3 {
      color: #1f2937 !important; /* Dark gray */
    }

    #error-modal p {
      color: #374151 !important; /* Medium gray */
    }

    /* Ensure all modal text is visible */
    #success-modal,
    #error-modal {
      color: #1f2937;
    }

    #success-modal p,
    #error-modal p {
      color: #374151 !important;
    }

    /* Error modal styling */
    #error-modal .bg-red-50 {
      border: 1px solid rgba(239, 68, 68, 0.1);
    }
  </style>
</head>
<body class="font-sans text-midnight-navy pb-24 md:pb-0">
  <!-- Navigation -->
  <nav class="fixed w-full nav-midnight shadow-sm z-50">
    <div class="max-w-7xl mx-auto px-6 lg:px-8">
      <div class="flex items-center justify-between header-height">
        <div class="flex items-center">
          <a href="index.html" aria-label="CakeBooking - Strona główna" class="flex-shrink-0 flex items-center">
            <img src="sygnet-cakebooking.svg" alt="CakeBooking" class="logo-signet mr-3">
            <span class="font-display font-bold text-3xl brand-mark">
              <span class="brand-word text-pure-white">Cake</span>
              <span class="brand-word text-gradient-gold-pink">Booking</span>
            </span>
          </a>
        </div>
        
        <!-- Desktop Navigation -->
        <div class="hidden lg:flex items-center space-x-6">
          <!-- Main Menu Items -->
          <div class="relative group">
            <button class="flex items-center text-dove-gray hover:text-playful-pink px-3 py-2 text-sm font-medium transition-colors">
              <span>Produkty</span>
              <i class="fa-solid fa-chevron-down ml-1 text-xs transition-transform group-hover:rotate-180"></i>
            </button>
            <!-- Dropdown Menu -->
            <div class="absolute top-full left-0 mt-2 w-64 bg-white rounded-xl shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 transform origin-top scale-95 group-hover:scale-100 border border-gray-100">
              <div class="py-2">
                <a href="wizualizator-tortow.html" class="flex items-center px-4 py-3 text-sm text-midnight-navy hover:bg-playful-pink/10 transition-colors">
                  <i class="fa-solid fa-palette w-5 h-5 mr-3 icon-gradient-gold-pink"></i>
                  <div>
                    <div class="font-medium">Wizualizator 3D</div>
                    <div class="text-xs text-dove-gray">Projektuj własny tort</div>
                  </div>
                </a>
                <a href="gotowy-tort.html" class="flex items-center px-4 py-3 text-sm text-midnight-navy hover:bg-playful-pink/10 transition-colors">
                  <i class="fa-solid fa-thumbs-up w-5 h-5 mr-3 icon-gradient-gold-pink"></i>
                  <div>
                    <div class="font-medium">Gotowe torty</div>
                    <div class="text-xs text-dove-gray">Wybierz z gotowych propozycji</div>
                  </div>
                </a>
                <a href="index.html#features" class="flex items-center px-4 py-3 text-sm text-midnight-navy hover:bg-playful-pink/10 transition-colors">
                  <i class="fa-solid fa-star w-5 h-5 mr-3 icon-gradient-gold-pink"></i>
                  <div>
                    <div class="font-medium">Funkcje</div>
                    <div class="text-xs text-dove-gray">Poznaj możliwości</div>
                  </div>
                </a>
              </div>
            </div>
          </div>

          <div class="relative group">
            <button class="flex items-center text-dove-gray hover:text-playful-pink px-3 py-2 text-sm font-medium transition-colors">
              <span>Firma</span>
              <i class="fa-solid fa-chevron-down ml-1 text-xs transition-transform group-hover:rotate-180"></i>
            </button>
            <!-- Dropdown Menu -->
            <div class="absolute top-full left-0 mt-2 w-64 bg-white rounded-xl shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 transform origin-top scale-95 group-hover:scale-100 border border-gray-100">
              <div class="py-2">
                <a href="o-nas.html" class="flex items-center px-4 py-3 text-sm text-midnight-navy hover:bg-playful-pink/10 transition-colors">
                  <i class="fa-solid fa-users w-5 h-5 mr-3 icon-gradient-gold-pink"></i>
                  <div>
                    <div class="font-medium">O nas</div>
                    <div class="text-xs text-dove-gray">Poznaj naszą historię</div>
                  </div>
                </a>
                <a href="dla-cukiernikow.html" class="flex items-center px-4 py-3 text-sm text-midnight-navy hover:bg-playful-pink/10 transition-colors">
                  <i class="fa-solid fa-store w-5 h-5 mr-3 icon-gradient-gold-pink"></i>
                  <div>
                    <div class="font-medium">Dla cukierników</div>
                    <div class="text-xs text-dove-gray">Dołącz do platformy</div>
                  </div>
                </a>
                <a href="blog.html" class="flex items-center px-4 py-3 text-sm text-midnight-navy hover:bg-playful-pink/10 transition-colors">
                  <i class="fa-solid fa-blog w-5 h-5 mr-3 icon-gradient-gold-pink"></i>
                  <div>
                    <div class="font-medium">Blog</div>
                    <div class="text-xs text-dove-gray">Inspiracje i porady</div>
                  </div>
                </a>
              </div>
            </div>
          </div>

          <a href="index.html#how-it-works" class="text-dove-gray hover:text-playful-pink px-3 py-2 text-sm font-medium transition-colors">Jak to działa</a>
          <a href="index.html#faq" class="text-dove-gray hover:text-playful-pink px-3 py-2 text-sm font-medium transition-colors">FAQ</a>
          <a href="kontakt.html" class="text-dove-gray hover:text-playful-pink px-3 py-2 text-sm font-medium transition-colors">Kontakt</a>
          
          <!-- CTA Button -->
          <a href="zamowienie.html" class="pill-button-pink flex items-center justify-center text-white no-underline">
            <img src="sygnet-cakebooking.svg" alt="CakeBooking" class="w-4 h-4 mr-2">
            Zamów tort
          </a>
        </div>

        <!-- Mobile menu button -->
        <div class="lg:hidden flex items-center">
          <button id="mobile-menu-button"
                  aria-label="Otwórz menu nawigacyjne"
                  aria-expanded="false"
                  aria-controls="mobile-menu"
                  class="inline-flex items-center justify-center p-2 rounded-md text-dove-gray hover:text-playful-pink hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-playful-pink transition-colors">
            <i class="fa-solid fa-bars h-6 w-6"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Mobile menu -->
    <div id="mobile-menu" class="hidden lg:hidden bg-midnight-navy shadow-lg">
      <div class="px-4 py-6 space-y-4">
        <!-- Products Section -->
        <div class="space-y-2">
          <div class="text-xs font-semibold icon-gradient-gold-pink uppercase tracking-wider mb-3">Produkty</div>
          <a href="wizualizator-tortow.html" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-palette w-5 h-5 mr-3"></i>
            Wizualizator 3D
          </a>
          <a href="gotowy-tort.html" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-thumbs-up w-5 h-5 mr-3"></i>
            Gotowe torty
          </a>
          <a href="index.html#features" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-star w-5 h-5 mr-3"></i>
            Funkcje
          </a>
        </div>

        <!-- Company Section -->
        <div class="space-y-2">
          <div class="text-xs font-semibold icon-gradient-gold-pink uppercase tracking-wider mb-3">Firma</div>
          <a href="o-nas.html" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-users w-5 h-5 mr-3"></i>
            O nas
          </a>
          <a href="dla-cukiernikow.html" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-store w-5 h-5 mr-3"></i>
            Dla cukierników
          </a>
          <a href="blog.html" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-blog w-5 h-5 mr-3"></i>
            Blog
          </a>
        </div>

        <!-- Other Links -->
        <div class="space-y-2">
          <div class="text-xs font-semibold icon-gradient-gold-pink uppercase tracking-wider mb-3">Pomoc</div>
          <a href="index.html#how-it-works" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-circle-info w-5 h-5 mr-3"></i>
            Jak to działa
          </a>
          <a href="index.html#faq" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-question-circle w-5 h-5 mr-3"></i>
            FAQ
          </a>
          <a href="kontakt.html" class="flex items-center px-3 py-3 rounded-lg text-base font-medium text-dove-gray hover:text-playful-pink hover:bg-white/10 transition-colors">
            <i class="fa-solid fa-envelope w-5 h-5 mr-3"></i>
            Kontakt
          </a>
        </div>

        <!-- CTA Button -->
        <div class="pt-4 border-t border-dove-gray/20">
          <a href="zamowienie.html" class="w-full pill-button-pink flex items-center justify-center text-white text-base font-medium px-6 py-3 shadow-lg no-underline">
            <img src="sygnet-cakebooking.svg" alt="CakeBooking" class="logo-signet mr-3">
            Zamów tort
          </a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="pt-32 pb-20 md:pb-32 hero-gradient relative overflow-hidden">
    <!-- Art Deco Elements -->
    <div class="parallax-element" data-speed="0.3" style="position: absolute; left: 48px; top: 128px; z-index: 1;">
      <div class="art-deco-line"></div>
    </div>
    <div class="parallax-element" data-speed="0.4" style="position: absolute; right: 48px; top: 160px; z-index: 1;">
      <div class="art-deco-line"></div>
    </div>
    <div class="parallax-element" data-speed="0.2" style="position: absolute; left: 64px; top: 208px; z-index: 1;">
      <div class="art-deco-dot"></div>
    </div>
    <div class="parallax-element" data-speed="0.6" style="position: absolute; right: 64px; top: 240px; z-index: 1;">
      <div class="art-deco-dot"></div>
    </div>
    
    <!-- Sparkles -->
    <div class="parallax-element" data-speed="0.5" style="position: absolute; top: 20%; left: 10%;">
      <div class="sparkle sparkle-enhanced" style="animation-delay: 0s;">✦</div>
    </div>
    <div class="parallax-element" data-speed="0.3" style="position: absolute; top: 30%; right: 15%;">
      <div class="sparkle sparkle-enhanced" style="animation-delay: 0.3s;">✧</div>
    </div>
    <div class="parallax-element" data-speed="0.7" style="position: absolute; top: 50%; left: 20%;">
      <div class="sparkle sparkle-enhanced" style="animation-delay: 0.6s;">✦</div>
    </div>
    
    <div class="max-w-7xl mx-auto px-6 lg:px-8 relative z-10">
      <div class="text-center max-w-4xl mx-auto">
                  <div class="font-script text-gradient-gold text-2xl mb-4">Gotowe torty dla każdej okazji</div>
        <h1 class="font-display text-4xl md:text-5xl lg:text-6xl font-bold text-pure-white leading-tight mb-6">
          Wybierz idealny tort <span class="icon-gradient-gold-pink">w kilka kliknięć</span>
        </h1>
        <p class="text-xl text-dove-gray max-w-2xl mx-auto leading-relaxed mb-8">
          Sprawdzone smaki, eleganckie dekoracje i szybka dostawa. Znajdź tort idealny dla swojej okazji.
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a href="#occasion-selector" class="pill-button-pink flex items-center justify-center text-white no-underline">
            <i class="fa-solid fa-thumbs-up h-5 w-5 mr-3"></i>
            Wybierz okazję
          </a>
          <a href="wizualizator-tortow.html" class="pill-button-secondary ghost-button flex items-center justify-center text-lg font-medium px-8 py-4 no-underline">
            <i class="fa-solid fa-palette h-5 w-5 mr-3"></i>
            Projektuj własny
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Occasion Selector -->
  <section id="occasion-selector" class="py-20 bg-porcelain-white relative overflow-hidden">
    <!-- Art Deco Elements -->
    <div class="parallax-element" data-speed="0.3" style="position: absolute; left: 32px; top: 80px; z-index: 0; opacity: 0.5;">
      <div class="art-deco-line"></div>
    </div>
    <div class="parallax-element" data-speed="0.4" style="position: absolute; right: 32px; bottom: 80px; z-index: 0; opacity: 0.5;">
      <div class="art-deco-line"></div>
    </div>
    
    <div class="max-w-7xl mx-auto px-6 lg:px-8 relative z-10">
      <div class="text-center mb-16">
        <h2 class="font-display text-3xl md:text-4xl font-bold text-midnight-navy mb-6">Wybierz okazję</h2>
        <p class="text-xl text-dove-gray max-w-3xl mx-auto leading-relaxed">
          Każda okazja ma swój charakter. Wybierz kategorię, która najlepiej pasuje do Twojej uroczystości.
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-16">
        <!-- Communion Cakes -->
        <div class="occasion-card vitreous-card p-6 text-center cursor-pointer" data-occasion="communion">
          <div class="w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));">
            <i class="fa-solid fa-church text-2xl text-midnight-navy"></i>
          </div>
          <h3 class="text-lg font-bold text-midnight-navy mb-2">Torty komunijne</h3>
          <p class="text-sm text-dove-gray">Delikatne i eleganckie</p>
        </div>

        <!-- Baptism Cakes -->
        <div class="occasion-card vitreous-card p-6 text-center cursor-pointer" data-occasion="baptism">
          <div class="w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));">
            <i class="fa-solid fa-baby text-2xl text-midnight-navy"></i>
          </div>
          <h3 class="text-lg font-bold text-midnight-navy mb-2">Torty na chrzest</h3>
          <p class="text-sm text-dove-gray">Urocze i subtelne</p>
        </div>

        <!-- Wedding Cakes -->
        <div class="occasion-card vitreous-card p-6 text-center cursor-pointer" data-occasion="wedding">
          <div class="w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));">
            <i class="fa-solid fa-heart text-2xl text-midnight-navy"></i>
          </div>
          <h3 class="text-lg font-bold text-midnight-navy mb-2">Torty weselne</h3>
          <p class="text-sm text-dove-gray">Wielopiętrowe i eleganckie</p>
        </div>

        <!-- Children's Cakes -->
        <div class="occasion-card vitreous-card p-6 text-center cursor-pointer" data-occasion="children">
          <div class="w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));">
            <i class="fa-solid fa-child text-2xl text-midnight-navy"></i>
          </div>
          <h3 class="text-lg font-bold text-midnight-navy mb-2">Torty dziecięce</h3>
          <p class="text-sm text-dove-gray">Kolorowe i zabawne</p>
        </div>

        <!-- Baby Shower Cakes -->
        <div class="occasion-card vitreous-card p-6 text-center cursor-pointer" data-occasion="babyshower">
          <div class="w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));">
            <i class="fa-solid fa-baby-carriage text-2xl text-midnight-navy"></i>
          </div>
          <h3 class="text-lg font-bold text-midnight-navy mb-2">Baby shower</h3>
          <p class="text-sm text-dove-gray">Pastelowe i urocze</p>
        </div>

        <!-- Bachelorette Cakes -->
        <div class="occasion-card vitreous-card p-6 text-center cursor-pointer" data-occasion="bachelorette">
          <div class="w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));">
            <i class="fa-solid fa-glass-cheers text-2xl text-midnight-navy"></i>
          </div>
          <h3 class="text-lg font-bold text-midnight-navy mb-2">Wieczór panieński</h3>
          <p class="text-sm text-dove-gray">Zabawne i eleganckie</p>
        </div>

        <!-- Women's Cakes -->
        <div class="occasion-card vitreous-card p-6 text-center cursor-pointer" data-occasion="women">
          <div class="w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));">
            <i class="fa-solid fa-female text-2xl text-midnight-navy"></i>
          </div>
          <h3 class="text-lg font-bold text-midnight-navy mb-2">Dla kobiet</h3>
          <p class="text-sm text-dove-gray">Eleganckie i wyrafinowane</p>
        </div>

        <!-- Men's Cakes -->
        <div class="occasion-card vitreous-card p-6 text-center cursor-pointer" data-occasion="men">
          <div class="w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--champagne-gold-end));">
            <i class="fa-solid fa-male text-2xl text-midnight-navy"></i>
          </div>
          <h3 class="text-lg font-bold text-midnight-navy mb-2">Dla mężczyzn</h3>
          <p class="text-sm text-dove-gray">Minimalistyczne i eleganckie</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Cake Gallery (Hidden by default) -->
  <section id="cake-gallery" class="py-20 bg-porcelain-white relative overflow-hidden hidden">
    <!-- Art Deco Elements -->
    <div class="parallax-element" data-speed="0.3" style="position: absolute; left: 32px; top: 80px; z-index: 0; opacity: 0.5;">
      <div class="art-deco-line"></div>
    </div>
    <div class="parallax-element" data-speed="0.4" style="position: absolute; right: 32px; bottom: 80px; z-index: 0; opacity: 0.5;">
      <div class="art-deco-line"></div>
    </div>
    
    <div class="max-w-7xl mx-auto px-6 lg:px-8 relative z-10">
      <div class="text-center mb-16">
        <h2 class="font-display text-3xl md:text-4xl font-bold text-midnight-navy mb-6">Wybierz swój tort</h2>
        <p class="text-xl text-dove-gray max-w-3xl mx-auto leading-relaxed">
          Przejrzyj nasze propozycje i wybierz tort, który najbardziej Ci się podoba.
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-16" id="cake-images">
        <!-- Cake images will be populated by JavaScript -->
      </div>

      <div class="text-center">
        <button id="back-to-occasions-from-gallery" class="pill-button-secondary flex items-center justify-center text-lg font-medium px-8 py-4 mx-auto no-underline">
          <i class="fa-solid fa-arrow-left h-5 w-5 mr-3"></i>
          Wróć do okazji
        </button>
      </div>
    </div>
  </section>

  <!-- Cake Configuration (Hidden by default) -->
  <section id="cake-configuration" class="py-20 bg-porcelain-white relative hidden">
    <div id="cake-config-anchor"></div>
    <!-- Art Deco Elements -->
    <div class="parallax-element" data-speed="0.3" style="position: absolute; left: 32px; top: 80px; z-index: 0; opacity: 0.5;">
      <div class="art-deco-line"></div>
    </div>
    <div class="parallax-element" data-speed="0.4" style="position: absolute; right: 32px; bottom: 80px; z-index: 0; opacity: 0.5;">
      <div class="art-deco-line"></div>
    </div>
    
    <div class="max-w-7xl mx-auto px-6 lg:px-8 relative z-10">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-start">
        <!-- Cake Preview -->
        <div class="lg:sticky lg:top-32 lg:self-start">
          <div class="vitreous-card p-8">
            <h3 class="text-2xl font-bold text-midnight-navy mb-6">Twój wybrany tort</h3>
                         <div id="selected-cake-preview" class="w-full aspect-[3/4] rounded-lg bg-gradient-to-br from-champagne-gold/10 to-blush-rose/10 flex items-center justify-center mb-6">
               <img src="sygnet-cakebooking.svg" alt="CakeBooking" class="w-16 h-16 icon-gradient-gold-pink opacity-50">
             </div>
            <div id="cake-info" class="space-y-4">
              <!-- Cake info will be populated by JavaScript -->
            </div>
          </div>
        </div>

        <!-- Configuration Options -->
        <div class="space-y-8">
          <!-- Taste Selection -->
          <div class="vitreous-card p-8">
            <h3 class="text-xl font-bold text-midnight-navy mb-6">Wybierz smak</h3>
            <div class="relative">
              <select id="taste-select" class="w-full p-4 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy font-medium focus:border-playful-pink focus:outline-none transition-colors">
                <option value="">Wybierz smak tortu</option>
                <!-- Taste options will be populated by JavaScript -->
              </select>
              <div class="absolute inset-y-0 right-0 flex items-center pr-4 pointer-events-none">
                <i class="fa-solid fa-chevron-down icon-gradient-gold-pink"></i>
              </div>
            </div>
          </div>

          <!-- Additional Decorations -->
          <div class="vitreous-card p-8">
            <h3 class="text-xl font-bold text-midnight-navy mb-6">Dodatkowe dekoracje</h3>
            <div class="space-y-4" id="decoration-options">
              <div class="flex items-center justify-between p-4 vitreous-card">
                <div>
                  <h4 class="font-bold text-midnight-navy">Żywe kwiaty</h4>
                  <p class="text-sm text-dove-gray">Dodaj świeże kwiaty do dekoracji</p>
                </div>
                <div class="flex items-center space-x-4">
                  <span class="text-lg font-bold icon-gradient-gold-pink">+30 zł</span>
                  <input type="checkbox" class="decoration-checkbox w-5 h-5 icon-gradient-gold-pink bg-transparent border-2 border-playful-pink rounded focus:ring-playful-pink" data-decoration="flowers" data-price="30">
                </div>
              </div>
              <div class="flex items-center justify-between p-4 vitreous-card">
                <div>
                  <h4 class="font-bold text-midnight-navy">Figurki z masy cukrowej</h4>
                  <p class="text-sm text-dove-gray">Spersonalizowane figurki</p>
                </div>
                <div class="flex items-center space-x-4">
                  <span class="text-lg font-bold icon-gradient-gold-pink">+25 zł</span>
                  <input type="checkbox" class="decoration-checkbox w-5 h-5 icon-gradient-gold-pink bg-transparent border-2 border-playful-pink rounded focus:ring-playful-pink" data-decoration="figures" data-price="25">
                </div>
              </div>
              <div class="flex items-center justify-between p-4 vitreous-card">
                <div>
                  <h4 class="font-bold text-midnight-navy">Napisy personalizowane</h4>
                  <p class="text-sm text-dove-gray">Imię, data, życzenia</p>
                </div>
                <div class="flex items-center space-x-4">
                  <span class="text-lg font-bold icon-gradient-gold-pink">+15 zł</span>
                  <input type="checkbox" class="decoration-checkbox w-5 h-5 icon-gradient-gold-pink bg-transparent border-2 border-playful-pink rounded focus:ring-playful-pink" data-decoration="text" data-price="15">
                </div>
              </div>
              <div id="custom-text-input" class="p-4 vitreous-card hidden">
                <label for="cake-text" class="block text-sm font-medium text-midnight-navy mb-2">Tekst na torcie:</label>
                <input type="text" id="cake-text" placeholder="np. 'Wszystkiego najlepszego Ania!'" class="w-full p-3 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy focus:border-playful-pink focus:outline-none transition-colors">
                <p class="text-xs text-dove-gray mt-1">Maksymalnie 30 znaków</p>
              </div>
            </div>
          </div>

          <!-- Order Summary -->
          <div class="vitreous-card p-8">
            <h3 class="text-xl font-bold text-midnight-navy mb-6">Podsumowanie zamówienia</h3>
            <div id="order-summary" class="space-y-4">
              <!-- Order summary will be populated by JavaScript -->
            </div>
            <div class="mt-6 pt-6 border-t border-dove-gray/20">
              <div class="flex justify-between items-center">
                <span class="text-lg font-bold text-midnight-navy">Razem:</span>
                <span id="total-price" class="text-2xl font-bold icon-gradient-gold-pink">0 zł</span>
              </div>
            </div>
            <button id="finalize-order" class="w-full mt-6 pill-button-pink flex items-center justify-center text-lg font-medium px-8 py-4 shadow-lg text-white no-underline">
              <i class="fa-solid fa-shopping-cart h-5 w-5 mr-3"></i>
              Złóż zamówienie
            </button>
          </div>
        </div>
      </div>

      <div class="text-center mt-12">
        <button id="back-to-gallery" class="pill-button-secondary flex items-center justify-center text-lg font-medium px-8 py-4 mx-auto no-underline">
          <i class="fa-solid fa-arrow-left h-5 w-5 mr-3"></i>
          Wróć do galerii
        </button>

      </div>
    </div>
  </section>

  <!-- Customer Data (Hidden by default) -->
  <section id="customer-data" class="py-20 bg-porcelain-white relative overflow-hidden hidden">
    <!-- Art Deco Elements -->
    <div class="parallax-element" data-speed="0.3" style="position: absolute; left: 32px; top: 80px; z-index: 0;">
      <div class="art-deco-line"></div>
    </div>
    <div class="parallax-element" data-speed="0.4" style="position: absolute; right: 32px; bottom: 80px; z-index: 0;">
      <div class="art-deco-line"></div>
    </div>
    
    <div class="max-w-4xl mx-auto px-6 lg:px-8 relative z-10">
      <div class="text-center mb-16">
        <h2 class="font-display text-3xl md:text-4xl font-bold text-midnight-navy mb-6">Dane kontaktowe</h2>
        <p class="text-xl text-dove-gray max-w-3xl mx-auto leading-relaxed">
          Podaj swoje dane, abyśmy mogli skontaktować się z Tobą w sprawie zamówienia.
        </p>
      </div>

      <div class="vitreous-card p-8">
        <form id="customer-form" class="space-y-6">
          <!-- Personal Information -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label for="firstName" class="block text-sm font-medium text-midnight-navy mb-2">Imię *</label>
              <input type="text" id="firstName" name="firstName" required class="w-full p-4 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy placeholder-dove-gray focus:border-playful-pink focus:outline-none transition-colors">
            </div>
            <div>
              <label for="lastName" class="block text-sm font-medium text-midnight-navy mb-2">Nazwisko *</label>
              <input type="text" id="lastName" name="lastName" required class="w-full p-4 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy placeholder-dove-gray focus:border-playful-pink focus:outline-none transition-colors">
            </div>
          </div>

          <!-- Contact Information -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label for="email" class="block text-sm font-medium text-midnight-navy mb-2">Email *</label>
              <input type="email" id="email" name="email" required class="w-full p-4 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy placeholder-dove-gray focus:border-playful-pink focus:outline-none transition-colors">
            </div>
            <div>
              <label for="phone" class="block text-sm font-medium text-midnight-navy mb-2">Telefon *</label>
              <input type="tel" id="phone" name="phone" required class="w-full p-4 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy placeholder-dove-gray focus:border-playful-pink focus:outline-none transition-colors">
            </div>
          </div>

          <!-- Order Notes -->
          <div>
            <label for="orderNotes" class="block text-sm font-medium text-midnight-navy mb-2">Uwagi do zamówienia</label>
            <textarea id="orderNotes" name="orderNotes" rows="3" placeholder="Dodatkowe uwagi do zamówienia..." class="w-full p-4 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy placeholder-dove-gray focus:border-playful-pink focus:outline-none transition-colors resize-none"></textarea>
          </div>

          <!-- Completion Date and Time -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label for="completionDate" class="block text-sm font-medium text-midnight-navy mb-2">Termin realizacji zamówienia *</label>
              <input type="date" id="completionDate" name="completionDate" required class="w-full p-4 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy placeholder-dove-gray focus:border-playful-pink focus:outline-none transition-colors">
            </div>
            <div>
              <label for="completionTime" class="block text-sm font-medium text-midnight-navy mb-2">Preferowana godzina odbioru *</label>
              <input type="time" id="completionTime" name="completionTime" required class="w-full p-4 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy placeholder-dove-gray focus:border-playful-pink focus:outline-none transition-colors">
            </div>
          </div>

          <!-- Delivery Information Box -->
          <div class="bg-white border border-playful-pink/20 rounded-xl p-4 mb-6">
            <h5 class="font-semibold text-midnight-navy mb-3 flex items-center">
              <i class="fa-solid fa-truck mr-2 text-playful-pink"></i>
              Dostawa dla klientów
            </h5>
            <p class="text-sm text-dove-gray leading-relaxed mb-3">Warunki dostawy mogą różnić się w zależności od cukierni lub pracowni, z którą współpracujesz.</p>
            <ul class="space-y-2 text-sm text-dove-gray leading-relaxed">
              <li class="flex"><span class="mr-2 text-playful-pink">•</span>Zawsze bezpłatny odbiór osobisty w cukierni/pracowni.</li>
              <li class="flex"><span class="mr-2 text-playful-pink">•</span>Dla cukierni Pan Tort Zielonka, ul. Marecka 17 oferujemy dostawę na terenie Warszawy.</li>
              <li class="flex"><span class="mr-2 text-playful-pink">•</span>Dostawa w promieniu 30 km od Warszawy (miejscowości ościenne) w cenie 40 zł.</li>
            </ul>
          </div>

          <!-- Delivery Option -->
          <div>
            <label class="block text-sm font-medium text-midnight-navy mb-4">Sposób odbioru *</label>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="delivery-option vitreous-card p-4 cursor-pointer border-2 border-transparent hover:border-playful-pink transition-colors" data-delivery="pickup">
                <div class="flex items-center">
                  <div class="w-8 h-8 rounded-full mr-3 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--playful-pink));">
                    <i class="fa-solid fa-store text-sm text-midnight-navy"></i>
                  </div>
                  <div>
                    <h4 class="font-bold text-midnight-navy">Odbór własny</h4>
                    <p class="text-sm text-dove-gray">Bezpłatnie</p>
                  </div>
                </div>
              </div>
              <div class="delivery-option vitreous-card p-4 cursor-pointer border-2 border-transparent hover:border-playful-pink transition-colors" data-delivery="delivery">
                <div class="flex items-center">
                  <div class="w-8 h-8 rounded-full mr-3 flex items-center justify-center" style="background: linear-gradient(135deg, var(--champagne-gold-start), var(--playful-pink));">
                    <i class="fa-solid fa-truck text-sm text-midnight-navy"></i>
                  </div>
                  <div>
                    <h4 class="font-bold text-midnight-navy">Dostawa</h4>
                    <p class="text-sm text-dove-gray">ok. 40zł w okolicach Warszawy</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Delivery Address (Hidden by default) -->
          <div id="delivery-address" class="space-y-6 hidden">
            <h3 class="text-lg font-bold text-midnight-navy mb-4">Adres dostawy</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="md:col-span-2">
                <label for="street" class="block text-sm font-medium text-midnight-navy mb-2">Ulica i numer *</label>
                <input type="text" id="street" name="street" class="w-full p-4 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy placeholder-dove-gray focus:border-playful-pink focus:outline-none transition-colors">
              </div>
              <div>
                <label for="postalCode" class="block text-sm font-medium text-midnight-navy mb-2">Kod pocztowy *</label>
                <input type="text" id="postalCode" name="postalCode" class="w-full p-4 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy placeholder-dove-gray focus:border-playful-pink focus:outline-none transition-colors">
              </div>
              <div>
                <label for="city" class="block text-sm font-medium text-midnight-navy mb-2">Miasto *</label>
                <input type="text" id="city" name="city" class="w-full p-4 border-2 border-dove-gray/20 rounded-lg bg-transparent text-midnight-navy placeholder-dove-gray focus:border-playful-pink focus:outline-none transition-colors">
              </div>
            </div>
          </div>

          <div class="flex flex-col sm:flex-row gap-4 pt-6 justify-between">
            <button type="button" id="back-to-configuration" class="pill-button-secondary flex items-center justify-center text-lg font-medium px-8 py-4 no-underline">
              <i class="fa-solid fa-arrow-left h-5 w-5 mr-3"></i>
              Wróć do konfiguracji
            </button>
            <button type="button" id="proceed-to-summary" class="pill-button-pink flex items-center justify-center text-lg font-medium px-8 py-4 no-underline">
              <i class="fa-solid fa-arrow-right h-5 w-5 mr-3"></i>
              Przejdź do podsumowania
            </button>
          </div>
        </form>
      </div>
    </div>
  </section>

  <!-- Order Summary (Hidden by default) -->
  <section id="order-summary-page" class="py-20 bg-porcelain-white relative overflow-hidden hidden">
    <!-- Art Deco Elements -->
    <div class="parallax-element" data-speed="0.3" style="position: absolute; left: 32px; top: 80px; z-index: 0; opacity: 0.5;">
      <div class="art-deco-line"></div>
    </div>
    <div class="parallax-element" data-speed="0.4" style="position: absolute; right: 32px; bottom: 80px; z-index: 0; opacity: 0.5;">
      <div class="art-deco-line"></div>
    </div>
    
    <div class="max-w-4xl mx-auto px-6 lg:px-8 relative z-10">
      <div class="text-center mb-16">
        <h2 class="font-display text-3xl md:text-4xl font-bold text-midnight-navy mb-6">Podsumowanie zamówienia</h2>
        <p class="text-xl text-dove-gray max-w-3xl mx-auto leading-relaxed">
          Sprawdź szczegóły zamówienia przed finalizacją.
        </p>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
        <!-- Order Details -->
        <div class="space-y-6">
          <div class="vitreous-card p-8">
            <h3 class="text-2xl font-bold text-midnight-navy mb-6">Szczegóły zamówienia</h3>
            <div id="final-order-summary" class="space-y-4">
              <!-- Order details will be populated by JavaScript -->
            </div>
            <div class="mt-6 pt-6 border-t border-dove-gray/20">
              <div class="flex justify-between items-center">
                <span class="text-lg font-bold text-midnight-navy">Razem:</span>
                <span id="final-total-price" class="text-2xl font-bold icon-gradient-gold-pink">0 zł</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Customer Information -->
        <div class="space-y-6">
          <div class="vitreous-card p-8">
            <h3 class="text-2xl font-bold text-midnight-navy mb-6">Dane kontaktowe</h3>
            <div id="customer-summary" class="space-y-4">
              <!-- Customer details will be populated by JavaScript -->
            </div>
          </div>

          <div class="vitreous-card p-8">
            <h3 class="text-2xl font-bold text-midnight-navy mb-6">Sposób odbioru</h3>
            <div id="delivery-summary" class="space-y-4">
              <!-- Delivery details will be populated by JavaScript -->
            </div>
          </div>
        </div>
      </div>

      <div class="flex flex-col sm:flex-row gap-4 justify-center mt-12">
        <button id="back-to-customer-data" class="pill-button-secondary flex items-center justify-center text-lg font-medium px-8 py-4 no-underline">
          <i class="fa-solid fa-arrow-left h-5 w-5 mr-3"></i>
          Wróć do danych
        </button>
        <button id="confirm-order" class="pill-button-pink flex items-center justify-center text-lg font-medium px-8 py-4 no-underline">
          <i class="fa-solid fa-check h-5 w-5 mr-3"></i>
          Potwierdź zamówienie
        </button>
      </div>
    </div>
  </section>



  <!-- Footer -->
  <footer class="bg-midnight-navy text-dove-gray py-12">
    <div class="max-w-7xl mx-auto px-6 lg:px-8">
      <div class="grid grid-cols-1 lg:grid-cols-5 gap-8 mb-8">
        <!-- Brand -->
        <div class="lg:col-span-2">
          <div class="flex items-center mb-4">
            <a href="index.html" aria-label="CakeBooking - Strona główna" class="flex items-center">
              <img src="sygnet-cakebooking.svg" alt="CakeBooking" class="logo-signet mr-3">
              <span class="font-display font-bold text-3xl brand-mark">
                <span class="brand-word text-pure-white">Cake</span>
                <span class="brand-word text-gradient-gold-pink">Booking</span>
              </span>
            </a>
          </div>
          <p class="text-dove-gray leading-relaxed mb-6 max-w-md">
            Koncepcja aplikacji łączącej miłośników tortów z najlepszymi cukierniami. Projektuj, zamawiaj i ciesz się wymarzonym tortem.
          </p>
          <div class="flex space-x-3">
            <a href="#" aria-label="Facebook" class="text-dove-gray hover:text-playful-pink transition-colors">
              <i class="fa-brands fa-facebook-f h-5 w-5"></i>
            </a>
            <a href="#" aria-label="Twitter" class="text-dove-gray hover:text-playful-pink transition-colors">
              <i class="fa-brands fa-x-twitter h-5 w-5"></i>
            </a>
            <a href="#" aria-label="Instagram" class="text-dove-gray hover:text-playful-pink transition-colors">
              <i class="fa-brands fa-instagram h-5 w-5"></i>
            </a>
          </div>
        </div>

        <!-- Produkty -->
        <div>
          <h4 class="text-pure-white font-medium mb-4 flex items-center">
            <i class="fa-solid fa-cube mr-2 icon-gradient-gold-pink"></i>
            Produkty
          </h4>
          <ul class="space-y-2">
            <li><a href="wizualizator-tortow.html" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-palette mr-2 text-xs"></i>
              Wizualizator 3D
            </a></li>
            <li><a href="gotowy-tort.html" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-thumbs-up mr-2 text-xs"></i>
              Gotowe torty
            </a></li>
            <li><a href="index.html#features" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-star mr-2 text-xs"></i>
              Funkcje
            </a></li>
            <li><a href="zamowienie.html" class="hover:text-playful-pink transition-colors flex items-center">
              <img src="sygnet-cakebooking.svg" alt="CakeBooking" class="w-4 h-4 mr-2">
              Zamów tort
            </a></li>
          </ul>
        </div>

        <!-- Firma -->
        <div>
          <h4 class="text-pure-white font-medium mb-4 flex items-center">
            <i class="fa-solid fa-building mr-2 icon-gradient-gold-pink"></i>
            Firma
          </h4>
          <ul class="space-y-2">
            <li><a href="o-nas.html" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-users mr-2 text-xs"></i>
              O nas
            </a></li>
            <li><a href="dla-cukiernikow.html" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-store mr-2 text-xs"></i>
              Dla cukierników
            </a></li>
            <li><a href="blog.html" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-blog mr-2 text-xs"></i>
              Blog
            </a></li>
            <li><a href="#" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-handshake mr-2 text-xs"></i>
              Partnerzy
            </a></li>
          </ul>
        </div>

        <!-- Pomoc -->
        <div>
          <h4 class="text-pure-white font-medium mb-4 flex items-center">
            <i class="fa-solid fa-life-ring mr-2 icon-gradient-gold-pink"></i>
            Pomoc
          </h4>
          <ul class="space-y-2">
            <li><a href="index.html#how-it-works" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-circle-info mr-2 text-xs"></i>
              Jak to działa
            </a></li>
            <li><a href="index.html#faq" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-question-circle mr-2 text-xs"></i>
              FAQ
            </a></li>
            <li><a href="#" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-headset mr-2 text-xs"></i>
              Wsparcie
            </a></li>
            <li><a href="kontakt.html" class="hover:text-playful-pink transition-colors flex items-center">
              <i class="fa-solid fa-envelope mr-2 text-xs"></i>
              Kontakt
            </a></li>
          </ul>
        </div>
      </div>

      <!-- Legal Links -->
      <div class="pt-6 border-t border-dove-gray/20 mb-6">
        <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
          <div class="flex flex-wrap justify-center md:justify-start space-x-6 text-sm">
            <a href="polityka-prywatnosci.html" class="hover:text-playful-pink transition-colors">Polityka prywatności</a>
            <a href="warunki-uzytkowania.html" class="hover:text-playful-pink transition-colors">Warunki użytkowania</a>
            <a href="regulamin.html" class="hover:text-playful-pink transition-colors">Regulamin</a>
            <a href="cookies.html" class="hover:text-playful-pink transition-colors">Cookies</a>
          </div>
          <div class="flex space-x-3">
            <a href="#" aria-label="LinkedIn" class="text-dove-gray hover:text-playful-pink transition-colors">
              <i class="fa-brands fa-linkedin h-4 w-4"></i>
            </a>
            <a href="#" aria-label="YouTube" class="text-dove-gray hover:text-playful-pink transition-colors">
              <i class="fa-brands fa-youtube h-4 w-4"></i>
            </a>
          </div>
        </div>
      </div>

      <!-- Copyright -->
      <div class="pt-6 border-t border-dove-gray/20 text-center md:text-left">
        <p class="text-dove-gray text-sm">
          © <span id="current-year">2025</span> CakeBooking. Koncepcja aplikacji - prezentacja projektu.
        </p>
      </div>
    </div>
  </footer>

  <!-- Success Modal -->
  <div id="success-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden opacity-0 transition-opacity duration-300">
    <div class="flex items-center justify-center min-h-screen p-4">
      <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full transform scale-95 transition-transform duration-300">
        <div class="p-8 text-center">
          <!-- Success Icon -->
          <div class="w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-r from-playful-pink to-champagne-gold flex items-center justify-center">
            <i class="fa-solid fa-check text-3xl text-gray-900"></i>
          </div>

          <!-- Title -->
          <h3 class="text-2xl font-display font-bold text-gray-900 mb-4">
            Zamówienie złożone!
          </h3>

          <!-- Message -->
          <p class="text-gray-700 leading-relaxed mb-6">
            Dziękujemy za zamówienie! Nasz zespół przygotuje Twój tort zgodnie z wybranymi opcjami i skontaktuje się wkrótce w sprawie potwierdzenia zamówienia.
          </p>

          <!-- Contact Info -->
          <div class="bg-gray-50 rounded-xl p-4 mb-6">
            <p class="text-sm text-gray-700 mb-2">
              <i class="fa-solid fa-clock mr-2 text-playful-pink"></i>
              <strong class="text-gray-900">Czas realizacji:</strong> 2-3 dni robocze
            </p>
            <p class="text-sm text-gray-700">
              <i class="fa-solid fa-envelope mr-2 text-playful-pink"></i>
              <strong class="text-gray-900">Kontakt:</strong> kontakt@cakebooking.pl
            </p>
          </div>

          <!-- Close Button -->
          <button id="close-success-modal" class="w-full pill-button-pink text-white font-medium py-3 px-6 shadow-lg">
            <i class="fa-solid fa-check mr-2"></i>
            Rozumiem
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Error Modal -->
  <div id="error-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden opacity-0 transition-opacity duration-300">
    <div class="flex items-center justify-center min-h-screen p-4">
      <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full transform scale-95 transition-transform duration-300">
        <div class="p-8 text-center">
          <!-- Error Icon -->
          <div class="w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-r from-red-400 to-red-600 flex items-center justify-center">
            <i class="fa-solid fa-exclamation-triangle text-3xl text-white"></i>
          </div>

          <!-- Title -->
          <h3 class="text-2xl font-display font-bold text-gray-900 mb-4">
            Błąd zamówienia
          </h3>

          <!-- Message -->
          <p id="error-message" class="text-gray-700 leading-relaxed mb-6">
            Przepraszamy, wystąpił błąd podczas składania zamówienia. Spróbuj ponownie lub skontaktuj się z nami telefonicznie.
          </p>

          <!-- Contact Info -->
          <div class="bg-red-50 rounded-xl p-4 mb-6">
            <p class="text-sm text-red-800 mb-2">
              <i class="fa-solid fa-phone mr-2"></i>
              <strong class="text-red-900">Telefon:</strong> +48 123 456 789
            </p>
            <p class="text-sm text-red-800">
              <i class="fa-solid fa-envelope mr-2"></i>
              <strong class="text-red-900">Email:</strong> kontakt@cakebooking.pl
            </p>
          </div>

          <!-- Close Button -->
          <button id="close-error-modal" class="w-full bg-gradient-to-r from-red-400 to-red-600 hover:from-red-500 hover:to-red-700 text-white font-medium py-3 px-6 rounded-xl shadow-lg transition-all duration-300">
            <i class="fa-solid fa-redo mr-2"></i>
            Spróbuj ponownie
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Management Functions -->
  <script>
    // Modal management functions
    function showModal(modalId) {
      const modal = document.getElementById(modalId);
      if (modal) {
        modal.classList.remove('hidden');
        // Trigger animation
        setTimeout(() => {
          modal.classList.remove('opacity-0');
          modal.querySelector('.transform').classList.remove('scale-95');
        }, 10);
        // Prevent body scroll
        document.body.style.overflow = 'hidden';
      }
    }

    function hideModal(modalId) {
      const modal = document.getElementById(modalId);
      if (modal) {
        modal.classList.add('opacity-0');
        modal.querySelector('.transform').classList.add('scale-95');
        setTimeout(() => {
          modal.classList.add('hidden');
          // Restore body scroll
          document.body.style.overflow = '';
        }, 300);
      }
    }

    // Modal event listeners
    document.addEventListener('DOMContentLoaded', function() {
      // Modal close buttons
      document.getElementById('close-success-modal')?.addEventListener('click', () => {
        hideModal('success-modal');
      });

      document.getElementById('close-error-modal')?.addEventListener('click', () => {
        hideModal('error-modal');
      });

      // Close modals when clicking outside
      document.getElementById('success-modal')?.addEventListener('click', (e) => {
        if (e.target.id === 'success-modal') {
          hideModal('success-modal');
        }
      });

      document.getElementById('error-modal')?.addEventListener('click', (e) => {
        if (e.target.id === 'error-modal') {
          hideModal('error-modal');
        }
      });
    });
  </script>

  <script>


    // Cake data with image mappings
    const cakeData = {
      communion: {
        name: "Tort komunijny",
        imagePrefix: "komunia",
        imageCount: 4,
        decorations: [
          "Delikatne, eleganckie motywy – hostia, krzyżyk, złocenia",
          "Opłatki z imieniem dziecka",
          "Kwiaty z masy cukrowej i żywe kwiaty",
          "Papier jadalny, ozdoby w bieli i pastelach"
        ],
        tastes: [
          "Wanilia z maliną",
          "Sezonowe owoce z białą czekoladą",
          "Mleczna czekolada z chrupką i malinami",
          "Klasyczny śmietankowo-truskawkowy"
        ]
      },
      baptism: {
        name: "Tort na chrzest",
        imagePrefix: "chrzest",
        imageCount: 20,
        decorations: [
          "Urocze i subtelne ozdoby – aniołki",
          "Papier jadalny, makaroniki, żywe kwiaty",
          "Imię dziecka",
          "Pastelowe kolory (błękit, pudrowy róż, beż)",
          "Figurki niemowląt"
        ],
        tastes: [
          "Biała czekolada z maliną",
          "Śmietankowy z borówkami",
          "Delikatna wanilia z musem owocowym",
          "Kokosowy z mango"
        ]
      },
      wedding: {
        name: "Tort weselny",
        imagePrefix: "weselny",
        imageCount: 20,
        decorations: [
          "Wielopiętrowe torty z żywymi lub cukrowymi kwiatami",
          "Złote/srebrne akcenty, koronki z masy cukrowej",
          "Minimalistyczne białe torty lub romantyczne ombré",
          "Dekoracje rustykalne (suszone kwiaty i dodatki)",
          "Dekoracje pod motyw dekoracyjny wesela"
        ],
        tastes: [
          "Czekoladowy z wiśnią",
          "Tiramisu",
          "Pistacjowy z maliną",
          "Mango z białą czekoladą",
          "Szampanowy krem z maliną"
        ]
      },
      children: {
        name: "Tort dziecięcy",
        imagePrefix: "dzieci",
        imageCount: 0, // No children category in images yet
        decorations: [
          "Postacie z bajek, jednorożce, samochody",
          "Zwierzaki, piłki, dinozaury",
          "Kolory intensywne lub pastelowe",
          "Toppery z imieniem dziecka i cyfrą wieku"
        ],
        tastes: [
          "Nutella z bananem",
          "Czekoladowy z truskawką",
          "Mleczna czekolada z maliną",
          "Waniliowy z dostępnymi w danym sezonie owocami"
        ]
      },
      babyshower: {
        name: "Tort na baby shower",
        imagePrefix: "babyshower",
        imageCount: 4,
        decorations: [
          "Motywy \"It's a boy/girl\"",
          "Małe ubranka, bociany, baloniki, body",
          "Pastelowe kolory",
          "Dekoracje w różu, błękicie lub neutralnych odcieniach"
        ],
        tastes: [
          "Krem śmietankowy z maliną",
          "Biała czekolada z lemon curd",
          "Jogurtowo-owocowy",
          "Kokosowy z mango"
        ]
      },
      bachelorette: {
        name: "Tort na wieczór panieński",
        imagePrefix: "panienski",
        imageCount: 8,
        decorations: [
          "Żywe kwiaty, toppery z napisem \"Bride to be\"",
          "Usta, szpilki, koronki, kokardki",
          "Złote i różowe detale",
          "Czasem zabawne lub odważne dekoracje"
        ],
        tastes: [
          "Malina z pistacją-truskawkowy",
          "Słony karmel z kremem mascarpone",
          "Oreo z kremem waniliowym"
        ]
      },
      women: {
        name: "Tort dla kobiet",
        imagePrefix: "kobieta",
        imageCount: 30,
        decorations: [
          "Kwiaty (żywe), eleganckie wzory",
          "Złoto, brokat, minimalizm",
          "Toppery z imieniem lub liczbą lat",
          "Pastelowe lub klasyczne kolory"
        ],
        tastes: [
          "Malina z mascarpone",
          "Pistacja z białą czekoladą",
          "Tiramisu",
          "Cytrynowy z kremem z białej czekolady",
          "Różany z maliną"
        ]
      },
      men: {
        name: "Tort dla mężczyzn",
        imagePrefix: "mezczyzna",
        imageCount: 14,
        decorations: [
          "Minimalistyczne, eleganckie",
          "Często tematyczne (motoryzacja, alkohol, sport, garnitury, zegarki)",
          "Czernie, granat, grafit"
        ],
        tastes: [
          "Mleczna czekolada",
          "Słony karmel",
          "Orzechowy z nutą rumu",
          "Brownie z kremem kawowym",
          "Czekolada z wiśnią bądź maliną"
        ]
      }
    };

    // Static cake data from cakes-details.docx
    const cakeDetails = {
      communion: {
        1: { name: "Tort komunijny – z pudrowym różem i kremowymi szlaczkami", description: "Dwupiętrowy tort pełen subtelności i klasy. Delikatne zdobienia z kremu, połączenie bieli i pudrowego różu oraz złoty, personalizowany topper tworzą wyjątkową, dziewczęcą kompozycję. Idealny na tak ważny dzień — pełen uroku, wdzięku i elegancji.", flavor: "cytrynowy orzeżwiający z lemon curd i kremem z serka mascarpone", portions: 30, price: 650 },
        2: { name: "Tort komunijny – z kwiatową dekoracją", description: "Dwupiętrowa elegancja w najpiękniejszym wydaniu. Biała baza ozdobiona kwiatami i złotym topperem z imieniem dziecka to połączenie prostoty i delikatnego przepychu. Tort, który zachwyci zarówno smakiem, jak i wyglądem.", flavor: "pistacja z malinami", portions: 30, price: 700 },
        3: { name: "Tort komunijny – klasyczna biel z kwiatowym akcentem", description: "Subtelny, biały tort z delikatnymi kwiatami i złotym, personalizowanym topperem. Symbol czystości i niewinności w eleganckim wydaniu — idealny wybór na Pierwszą Komunię Świętą.", flavor: "mleczna czekolada z chrupką i malinami", portions: 30, price: 680 },
        4: { name: "Tort komunijny – z piórkami i złotym akcentem", description: "Wyjątkowy tort o lekkiej, niemal anielskiej dekoracji. Białe piórka, jadalne złotko i personalizowany topper tworzą elegancką, pełną blasku kompozycję. Idealny dla małej damy lub młodego dżentelmena w ten wyjątkowy dzień.", flavor: "serniczkowy ze świeżymi owocami", portions: 30, price: 670 }
      },
      baptism: {
        1: { name: "Delikatny tort na Chrzest Święty", description: "Subtelny, kremowy dwupiętrowy tort ozdobiony świeżymi makaronikami i eleganckim złotym napisem.", flavor: "pistacja z malinami", portions: 30, price: 750 },
        2: { name: "Tort w stylu boho", description: "Pastelowe bezowe i czekoladowe barwy, proste zdobienia i kuleczki z masy cukrowej tworzą idealną kompozycję na ten wyjątkowy dzień.", flavor: "mleczna czekolada z czarną porzeczką i chrupką", portions: 35, price: 800 },
        3: { name: "Pastelowa elegancja", description: "Tort w odcieniach różu i fioletu, ozdobiony kwiatami, symbolizujący czystość i niewinność do tego złoty personalizowany napis, który dodaje elegancji.", flavor: "serniczkowy z truskawkami", portions: 25, price: 550 },
        4: { name: "Trzy piętrowy tort na Chrzest", description: "Delikatny, w jasnych kolorach, z minimalistycznymi dekoracjami kwiatowymi oraz personalizowanym złotym napisem.", flavor: "rafaello z chrupką z białej czekolady oraz mango", portions: 60, price: 1300 },
        5: { name: "Tort z kwiatową kompozycją", description: "Piękne kwiaty nadają mu lekkości i subtelności, idealny dla dziewczynki lub chłopca. Złoty personalizowany topper.", flavor: "cytrynowy orzeżwiający z lemon curd i kremem z serka mascarpone", portions: 30, price: 650 },
        6: { name: "Tort z personalizowanym topperem", description: "Klasyczny, z eleganckim napisem i delikatnymi ozdobami w tonacji pastelowej. Kolory do ustalenia tak aby pasowały zarówno dla chłopca jak i dla dziewczynki.", flavor: "serniczkowy z truskawkami", portions: 25, price: 550 },
        7: { name: "Tort w stylu delikatnym kwiatowym", description: "Prosty, ozdobiony zielenią i kwiatami, idealny dla miłośników naturalnych dekoracji.", flavor: "pistacja z malinami", portions: 15, price: 400 },
        8: { name: "Tort z nutą złota", description: "Kremowy tort z delikatnym złotym akcentem i kwiatami – subtelny, ale wyjątkowy idealny zarówno dla chłopca jak i dla dziewczynki.", flavor: "lemon curd z kremem z serka mascarpone", portions: 35, price: 750 },
        9: { name: "Minimalistyczny tort na Chrzest Święty", description: "Lekka dekoracja z makaronikami i eleganckim wykończeniem, idealny zarówno dla chłopca jak i dla dziewczynki. Personalizowany topper dodaje elegancji.", flavor: "serniczkowy z malinami", portions: 25, price: 580 },
        10: { name: "Podwójny tort z kwiatami", description: "Prosty, ale efektowny, z mostem z kwiatów i delikatną fakturą kremu. Dwa personalizowane toppery.", flavor: "pistacja z malinami", portions: 30, price: 800 },
        11: { name: "Tort z delikatnymi kwiatami", description: "Pastelowy, ozdobiony drobnymi kwiatami z delikatnym złotkiem, doskonały na chrzest dziewczynki.", flavor: "mleczna czekolada z chrupką i malinami", portions: 30, price: 750 },
        12: { name: "Chrzest w bieli i błękicie", description: "Klasyczny tort w delikatnych, pastelowych odcieniach błękitu, ozdobiony papierem jadalnym oraz złotym personalizowanym topperem.", flavor: "cytrynowy orzeżwiający z lemon curd i kremem z serka mascarpone", portions: 70, price: 1500 },
        13: { name: "Subtelny tort w bardzo eleganckiej tonacji", description: "Biały krem z dodatkiem złota, białych kwiatów dla świeżego, naturalnego efektu.", flavor: "mleczna czekolada z czarną porzeczką i chrupką", portions: 30, price: 750 },
        14: { name: "Tort w stylu boho (wariacja)", description: "Z dodatkiem makaroników i ozdoby z papieru jadalnego, delikatne boho dodatki – prosty, a zarazem wyjątkowy.", flavor: "pistacja z malinami", portions: 30, price: 750 },
        15: { name: "Tort z anielską lekkością", description: "Jasny, kremowy tort z niebieskim akcentem z delikatną dekoracją z papieru jadalnego i złotym personalizowanym napisem.", flavor: "serniczkowy z truskawkami", portions: 35, price: 800 },
        16: { name: "Elegancki tort z personalizacją", description: "Klasyczny wygląd z dodatkiem imienia dziecka, idealny na pamiątkę Chrztu Świętego w odcieniach różu z dodatkiem żywych kwiatów tworzy niesamowitą kompozycję wizualną.", flavor: "rafaello z chrupką z białej czekolady oraz mango", portions: 25, price: 550 },
        18: { name: "Tort lekki wiosenny", description: "Dzięki żywym kwiatom w delikatnej tonacji bardzo subtelny - do tego złoty personalizowany topper który nada elegancji.", flavor: "rafaello z chrupką z białej czekolady oraz mango", portions: 15, price: 380 },
        19: { name: "Pastelowy tort w odcieniach różu", description: "Z kremowymi kwiatami i personalizowanym złotym topperem.", flavor: "rafaello z chrupką z białej czekolady oraz mango", portions: 15, price: 350 },
        20: { name: "Delikatny tort dla dziewczynki", description: "Idealny w kolorystyce pudrowego różu z dodatkiem żywych i kremowych kwiatów nadaje temu tortu klasy, a dopełnieniem elegancji jest złoty personalizowany topper.", flavor: "pistacja z malinami", portions: 30, price: 700 }
      },
      wedding: {
        1: { name: "Klasyczny tort weselny", description: "Elegancki, biało-różowy tort o gładkim wykończeniu, z dodatkiem jadalnego złota i kwiatów idealny na eleganckie przyjęcie weselne.", flavor: "pistacja z malinami", portions: 150, price: 3300 },
        2: { name: "Elegancki tort w kolorach butelkowej zieleni", description: "Delikatne zdobienia z jadalnego złota i świeże zielone dodatki tworzą wyjątkową, romantyczną kompozycję.", flavor: "rafaello z chrupką z białej czekolady oraz mango", portions: 110, price: 2300 },
        3: { name: "Tort w stylu glamour", description: "Lśniący, ozdobiony złotymi akcentami i dużymi kwiatami – dla par ceniących elegancję.", flavor: "mleczna czekolada z chrupką oraz wkładką z wiśni", portions: 100, price: 2100 },
        4: { name: "Bardzo subtelny i elegancki tort weselny", description: "Prosty styl z białymi kwiatami, oraz złotymi personalizowanymi inicjałami idealny do przyjęcia również w plenerze.", flavor: "serniczkowy z truskawkami", portions: 150, price: 3100 },
        5: { name: "Minimalistyczny tort ślubny", description: "Prosta forma, pastelowe kolory i elegancki urok w nowoczesnym wydaniu z żywymi delikatnymi różami oraz personalizowanym topperem.", flavor: "rafaello z chrupką z białej czekolady oraz mango", portions: 130, price: 2700 },
        6: { name: "Tort z żywymi kwiatami", description: "Klasyczny biały tort udekorowany sezonowymi kwiatami w naturalnej aranżacji z dodatkiem jadalnego złota oraz złotym personalizowanym topperem.", flavor: "pistacja z malinami", portions: 130, price: 2700 },
        7: { name: "Tort w stylu boho", description: "Kremowy tort ozdobiony suszonymi kwiatami i delikatnymi listkami, w duchu natury do tego delikatny złoty personalizowany topper - całość kompozycji tworzy naturalny boho klimat.", flavor: "rafaello z chrupką z białej czekolady oraz mango", portions: 130, price: 2700 },
        8: { name: "Nowoczesny tort z geometrycznymi akcentami", description: "Elegancki, stylowy, idealny dla par ceniących oryginalność. Kolory błękit i biel z dodatkiem żywych kwiatów, makaroników oraz jadalnego złota wykończony lustrzanym personalizowanym topperem.", flavor: "serniczkowy z truskawkami", portions: 140, price: 2800 },
        9: { name: "Tort weselny w stylu glamour", description: "Lekki, świeży tort ozdobiony makaronikami i czarnym cieniowaniowaniem z kremu z dodatkiem jadalnego złota i personalizowany złoty topper. Idealny dla Pary, która szuka czegoś oryginalnego dopasowanego pod kolorystykę przyjęcia.", flavor: "rafaello z chrupką z białej czekolady oraz mango", portions: 130, price: 2850 },
        10: { name: "Tort w stylu boho (wariacja)", description: "Kremowe wykończenie, naturalne kwiaty i rustykalne detale – idealny na wesele w plenerze- złoty personalizowany topper.", flavor: "pistacja z malinami", portions: 130, price: 2800 },
        11: { name: "Romantyczny tort z białymi żywymi peoniami", description: "Delikatne białe peonie dodają mu wyjątkowego, klasycznego uroku, a srebrny personalizowany topper dodaje całej kompozycji nutkę elegancji.", flavor: "serniczkowy ze świeżymi sezonowymi owocami", portions: 100, price: 2000 },
        12: { name: "Tort z jadalnym złotem", description: "Żywe kwiaty oraz personalizowane inicjały tworzą naturalny, subtelny wygląd pasujący do każdej przestrzeni.", flavor: "pistacja z malinami", portions: 150, price: 3000 },
        13: { name: "Tort z nutą złota", description: "Delikatne, kremowe wykończenie i kremowa faktura tworzą elegancki, luksusowy efekt wykończony personalizowanymi złotymi inicjałami.", flavor: "rafaello z chrupką z białej czekolady oraz mango", portions: 35, price: 750 },
        14: { name: "Tort kwiatowy w stylu garden", description: "Lekki, pastelowy tort z kompozycją kwiatów przypominających ogrodową aranżację wykończony srebrnym personalizowanym topperem.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 130, price: 2800 },
        15: { name: "Tort z motywem ogrodu z motylami", description: "Elegancki, kwiatowy tort z jadalnymi motylami dopasowany do charakteru wesela.", flavor: "pistacja z malinami", portions: 130, price: 2800 },
        16: { name: "Tort babeczkowy „Zielony Ogród”", description: "Wyjątkowa kompozycja babeczek w odcieniach zieleni, udekorowanych kremem i roślinnymi motywami na górze mały torcik wykończony złotym personalizowanym topperem.", flavor: "jogurtowy z kremem z białej czekolady", portions: 100, price: 1500 },
        17: { name: "Tort weselny z trzema piętrami", description: "Klasyczna forma, eleganckie wykończenie i delikatne zdobienia w kremowym kolorze. Całość kolorystyki to butelkowa zieleń wykończony naturalnymi świeczkami, kompozycjami w styli boho oraz personalizowanym złotym topperem.", flavor: "rafaello z chrupką z białej czekolady oraz mango", portions: 150, price: 3300 },
        18: { name: "Romantyczny tort z dekoracją z papieru jadalnego", description: "Prosty, biały tort ozdobiony dekoracją z papieru jadalnego z dodatkiem jadalnego złota, wykończony personalizowanym lustrzanym topperem.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 160, price: 3300 },
        19: { name: "Tort z efektem marmuru", description: "Stylowy, nowoczesny tort z subtelnym wzorem marmuru i srebrnymi detalami jak również srebrnymi personalizowanymi inicjałami.", flavor: "mleczna czekolada z chrupką i malinami", portions: 180, price: 3600 },
        20: { name: "Tort babeczkowy „Kremowe Marzenie”", description: "Delikatne, jasne babeczki z kremem waniliowym i kwiatową dekoracją w odcieniach bieli i beżu z małym torcikiem na górze wykończony srebrnym personalizowanym topperem oraz srebrnymi papilotkami.", flavor: "wanilia z malinami i kremem z białej czekolady", portions: 120, price: 1700 }
      },
      babyshower: {
        1: { name: "Różowe marzenie", description: "Subtelny tort w pastelowych odcieniach różu, ozdobiony delikatnymi kwiatami i kremem o lekkiej strukturze ze złotym napisem — idealny na Baby Shower dla przyszłej mamy.", flavor: "serniczkowy ze świeżymi owocami", portions: 12, price: 270 },
        2: { name: "Delikatność w różu", description: "Tort o kremowym wykończeniu z kwiatową dekoracją w odcieniach różu i bieli. Elegancki, lekki i pełen uroku — doskonały na przyjęcie z okazji baby shower.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 16, price: 390 },
        3: { name: "It's a Boy!", description: "Tort w odcieniach błękitu i złota, z dekoracjami inspirowanymi dziecięcym światem. Idealny na Baby Shower dla chłopca – radosny, pastelowy i z przesłaniem.", flavor: "pistacja z malinami", portions: 16, price: 400 },
        4: { name: "Pastelowe spełnienie marzeń", description: "Tort w delikatnych, kremowo-różowych barwach, ozdobiony kwiatami i drobnymi motylkami. Subtelny, elegancki i pełen słodyczy – idealny na powitanie maleństwa.", flavor: "serniczkowy ze świeżymi owocami", portions: 8, price: 250 }
      },
      bachelorette: {
        1: { name: "Tort Panieński – subtelna klasyka", description: "Delikatny, romantyczny i pełen uroku. Ozdobiony kwiatami w pastelowych odcieniach i złotym toperem z imieniem przyszłej Panny Młodej. Idealny na wyjątkowy wieczór w gronie najbliższych przyjaciółek.", flavor: "pistacja z malinami", portions: 15, price: 400 },
        2: { name: "Tort Panieński – w stylu glamour", description: "Kobiecy, elegancki i z nutą blasku! Złoty, personalizowany topper pięknie komponuje się z kwiatową dekoracją w pudrowych tonach. Tort, który doda uroku każdej panieńskiej imprezie.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 15, price: 420 },
        3: { name: "Tort Panieński – kwiatowa romantyczność", description: "Połączenie lekkości i elegancji. Kwiaty w pastelowych kolorach i delikatne wykończenia sprawiają, że ten tort wygląda jak z bajki. Złoty topper dodaje mu szyku i osobistego charakteru.", flavor: "serniczkowy z truskawkami", portions: 15, price: 410 },
        4: { name: "Tort Panieński – delikatny minimalizm", description: "Stonowany, zmysłowy i z klasą. Idealny wybór dla miłośniczek prostoty i elegancji. Jadalny wydruk i złoty napis tworzą perfekcyjny duet na ten wyjątkowy wieczór.", flavor: "czekoladowy z malinami", portions: 15, price: 380 },
        5: { name: "Tort Panieński – romantyczny ogród", description: "Tort jak z marzenia — udekorowany kwiatami niczym z letniego ogrodu i złotym, personalizowanym topperem. Symbol kobiecości, delikatności i radości z nadchodzących chwil.", flavor: "pistacja z malinami", portions: 12, price: 330 },
        6: { name: "Tort Panieński – elegancja w każdym detalu", description: "Wyrafinowany, kobiecy i wyjątkowy. Kwiatowe zdobienia nadają mu lekkości, a złoty topper sprawia, że całość nabiera luksusowego charakteru. Idealny na wieczór pełen śmiechu, wspomnień i miłości.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 12, price: 320 },
        7: { name: "Tort przyjaźni", description: "Pastelowy tort z dekoracją z papieru jadalnego oraz masy cukrowej – symbol wspólnej zabawy i pięknych chwil przed ślubem, bardzo subtelny i tajemniczy.", flavor: "mleczna czekolada z chrupką i malinami", portions: 12, price: 330 },
        8: { name: "Barbie Party Queen", description: "Tort inspirowany Barbie – różowy, błyszczący, z lalką w roli głównej! Pełen blasku, humoru i imprezowego klimatu – idealny dla królowej wieczoru panieńskiego.", flavor: "krem z białej czekolady z czarną porzeczką", portions: 20, price: 480 }
      },
      women: {
        1: { name: "Kwiatowa elegancja", description: "Delikatny, pastelowy tort ozdobiony kwiatami i złotym napisem – idealny dla kobiety z klasą.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 15, price: 420 },
        2: { name: "Różane marzenie", description: "Kremowy tort z dekoracją z róż w odcieniach pasteli z dodatkiem zielonych gałązek – subtelny i romantyczny, jak wspomnienie wiosny.", flavor: "pistacja z malinami", portions: 15, price: 420 },
        3: { name: "Pastelowa lekkość", description: "Lekki, kobiecy tort z kwiatami i złotymi detalami – doskonały na urodziny lub wyjątkowy dzień.", flavor: "serniczkowy ze świeżymi owocami", portions: 25, price: 450 },
        4: { name: "Tort z nutą złota", description: "Elegancki tort z delikatnymi kwiatami i złotymi akcentami, stworzony z myślą o kobiecie, która lubi błysk i oryginalność.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 15, price: 450 },
        5: { name: "Delikatność i styl", description: "Pastelowy tort z subtelnym kwiatowym wykończeniem i złotymi detalami oraz kolorem niebieskimi dodatkiem głęboko niebieskiej hortensji – symbol kobiecej siły i elegancji, ozdobiony złotym personalizowanym topperem.", flavor: "pistacja z malinami", portions: 30, price: 700 },
        6: { name: "Tort „Friends”", description: "Dla fanki serialu Friends! Tort inspirowany kultowym motywem Central Perk – z humorem, sercem i kwiatowym akcentem.", flavor: "czekoladowy z wiśniami", portions: 15, price: 400 },
        7: { name: "Klasyka kobiecości w oryginalnej odsłonie", description: "Bezowo-zielony tort ozdobiony delikatnymi różami i eleganckim napisem, dekoracja z białej czekolady i elementem boho- ponadczasowy wybór.", flavor: "pistacja z malinami", portions: 20, price: 460 },
        8: { name: "Delikatne spełnienie marzeń", description: "Tort w odcieniach delikatnego błękitu, ze złotymi akcentami i suszkami – idealny na urodziny, imieniny, wykończony eleganckim złotym inicjałem.", flavor: "mleczna czekolada z chrupką i czarną porzeczką", portions: 20, price: 460 },
        9: { name: "Kwiaty i blask", description: "Złoty napis, kremowe wykończenie i pastelowe kwiaty – tort, który wygląda jak luksus w słodkiej formie.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 15, price: 390 },
        10: { name: "Romantyczna dusza", description: "Subtelny tort w kremowych barwach, ozdobiony kwiatami – stworzony dla marzycielki i romantyczki. Kolorystyka fioletu i delikatne muśnięcie złotkiem dodaje odwagi i elegancji.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 15, price: 420 },
        11: { name: "Tort w stylu glamour", description: "Złote akcenty, eleganckie kwiaty boho i delikatny krem – dla kobiet, które lubią, gdy tort robi wrażenie. Imienna złota personalizacja.", flavor: "pistacja z malinami", portions: 25, price: 600 },
        12: { name: "Tort z kryształami i księżycem", description: "Mistyczny i wyjątkowy – tort z dekoracją z kryształów i motywem księżyca, idealny dla kobiety z duszą artystki.", flavor: "delikatny orzeźwiający z lemon curd i kremem z serka mascarpone", portions: 10, price: 260 },
        13: { name: "Delikatna klasyka", description: "Tort z kwiatami i złotym topperem – subtelny, lekki i bardzo kobiecy.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 15, price: 400 },
        14: { name: "Złote ptaszki", description: "Symbol wolności i elegancji – tort ozdobiony złotymi ptaszkami i pastelowymi kwiatami.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 15, price: 420 },
        15: { name: "Słodka harmonia", description: "Kwiaty, złoto i kremowe wykończenie tworzą harmonijną kompozycję idealną dla każdej kobiety.", flavor: "pistacja z malinami", portions: 22, price: 480 },
        16: { name: "Malutki tort z delikatnymi różami", description: "Z personalizowaną złotą cyfrą - szyk i elegancja zamknięta w jednym uroczym torcie.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 8, price: 200 },
        17: { name: "Prosty i elegancki tort", description: "Z delikatnymi kwiatkami i personalizowanymi złotymi dodatkami.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 15, price: 400 },
        18: { name: "Tort z bobrem", description: "Zabawny, ale wciąż elegancki – tort z motywem bobra, dla kobiety z poczuciem humoru i dystansem do życia!", flavor: "pistacja z malinami", portions: 15, price: 420 },
        19: { name: "Tort z rowerem", description: "Dla aktywnej duszy – tort z dekoracją roweru, kwiatami. Idealny dla miłośniczki przygód.", flavor: "serniczkowy ze świeżymi owocami", portions: 15, price: 400 },
        20: { name: "Tort ze szminką", description: "Kobiecy, stylowy i z pazurem – tort z dekoracją szminki i złotymi akcentami z dodatkiem świeżych kwiatów, dla prawdziwej fashionistki i kobiety z klasą.", flavor: "pistacja z malinami", portions: 15, price: 420 },
        21: { name: "Subtelne piękno", description: "Pastelowe kwiaty i elegancki napis tworzą idealny tort dla każdej kobiety ceniącej prostotę i styl.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 15, price: 410 },
        22: { name: "Kwiatowy zachwyt", description: "Tort pełen kwiatów i delikatnych zdobień, który przyciąga uwagę i podkreśla wyjątkowość chwili z personalizowaną złotą cyfrą.", flavor: "pistacja z malinami", portions: 12, price: 350 },
        23: { name: "Tort z klasą", description: "Połączenie kremowej elegancji, złotych detali i subtelnych kwiatów – tort dla kobiety z klasą.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 15, price: 420 },
        24: { name: "Tort leśny dla grzybiarki", description: "Wyjątkowy tort inspirowany naturą – ozdobiony grzybkami i jadalnym mchem, wykończony kremem czekoladowym. Idealny dla miłośniczki lasu i natury.", flavor: "mleczna czekolada z chrupką i malinami", portions: 15, price: 400 },
        25: { name: "Elegancja w prostocie", description: "Subtelny tort z delikatnymi kwiatami i minimalistycznym złotym napisem. Idealny dla wrażliwej i delikatnej kobiety.", flavor: "pistacja z malinami", portions: 15, price: 430 },
        26: { name: "Tort jak z bajki", description: "Kwiatowe wykończenie, złote akcenty i pastelowe różowe kwiaty – idealny na wyjątkowe, bajkowe urodziny lub na podziękowanie. (Okrągła złota personalizacja)", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 20, price: 470 },
        27: { name: "Kwiatowy sen z motywem", description: "Tort w odcieniach beżu i różu, ozdobiony delikatnymi kwiatami i eleganckim napisem z jadalnymi wydrukami.", flavor: "pistacja z malinami", portions: 15, price: 400 },
        28: { name: "Złoty blask", description: "Elegancki tort z kwiatami i złotem – idealny dla kobiety, która lubi, gdy jej dzień błyszczy.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 12, price: 350 },
        29: { name: "Tort dla marzycielki", description: "Delikatny i romantyczny, z pastelową dekoracją – stworzony dla kobiety z wyobraźnią.", flavor: "serniczkowy z truskawkami", portions: 12, price: 280 },
        30: { name: "Kobiecy klasyk", description: "Ciemno różowe kwiaty i kremowe wykończenie – tort, który nigdy nie wychodzi z mody.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 12, price: 290 }
      },
      men: {
        1: { name: "Tort dla fana motoryzacji", description: "Idealny dla miłośnika czterech kółek! Nowoczesny, z pazurem, utrzymany w ciemnej tonacji z motoryzacyjnymi akcentami. Doskonały wybór dla tych, którzy kochają prędkość, styl i zapach benzyny.", flavor: "mleczna czekolada z chrupką o czarna porzeczka", portions: 15, price: 430 },
        2: { name: "Tort elegancki", description: "Klasyczna elegancja w męskim wydaniu. Stonowane barwy, prosta forma i dopracowane detale sprawiają, że ten tort to kwintesencja dobrego smaku — dosłownie i wizualnie.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 12, price: 290 },
        3: { name: "Tort elegancki (wariacja)", description: "Dla mężczyzny z klasą — subtelny, nowoczesny i ponadczasowy. Idealny na urodziny, jubileusz czy wyjątkową rocznicę. Minimalizm, który mówi sam za siebie. Personalizowane złote napisy.", flavor: "pistacja z malinami", portions: 10, price: 270 },
        4: { name: "Tort z buteleczką alkoholu", description: "Wyrafinowany tort z nutą luksusu! Ozdobiony mini buteleczką ulubionego trunku, sprawdzi się idealnie dla konesera whisky, rumu lub koniaku. Męski, elegancki i z charakterem.", flavor: "czekolada z wiśniami", portions: 15, price: 400 },
        5: { name: "Tort z samolotem", description: "Dla podróżnika, pilota lub miłośnika przestworzy! Ten tort to symbol wolności i pasji do latania. Idealny na prezent dla kogoś, kto ma głowę w chmurach — dosłownie i w przenośni.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 12, price: 300 },
        6: { name: "Tort z motorem", description: "Dla prawdziwego motocyklisty! Dynamiczny, mocny i pełen energii — tak jak jazda na dwóch kółkach. Świetny pomysł na tort urodzinowy dla fana adrenaliny i dźwięku silnika.", flavor: "serniczkowy z malinami", portions: 15, price: 400 },
        7: { name: "Tort subtelny, elegancki ze złotym napisem", description: "Wyrafinowany w swojej prostocie. Ciemna baza, delikatne czekoladowe zdobienia i złoty napis tworzą idealną harmonię. Dla mężczyzny, który ceni styl i minimalizm.", flavor: "czekolada, toffie i maliny", portions: 10, price: 270 },
        8: { name: "Tort subtelny, elegancki ze złotym napisem (wariacja)", description: "Klasa sama w sobie — połączenie elegancji, minimalizmu i delikatnego połysku. Idealny wybór na urodziny, jubileusz lub eleganckie przyjęcie.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 10, price: 280 },
        9: { name: "Tort czarny", description: "Czarny, odważny, intrygujący. Ten tort to kwintesencja męskiego stylu — prosty, ale z efektem „wow”. Dla mężczyzny, który lubi wyróżniać się z tłumu.", flavor: "czekoladowy z wiśniami", portions: 15, price: 390 },
        10: { name: "Tort dla fana tenisa", description: "Sportowy, stylowy i pełen energii! Dla pasjonata tenisa — czy to zawodnika, czy kibica. Motyw rakiety i piłeczki dodaje mu dynamiki i charakteru.", flavor: "pistacja z malinami", portions: 12, price: 320 },
        11: { name: "Tort bardzo męski", description: "Surowy, wyrazisty i z charakterem. Idealny dla prawdziwego faceta — bez zbędnych ozdób, za to z mocnym akcentem i eleganckim wykończeniem.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 15, price: 400 },
        12: { name: "Tort podróżniczo-tenisowy (trzypiętrowy)", description: "Trzy piętra pasji i stylu! Dla mężczyzny, który kocha odkrywać świat i aktywnie spędzać czas. Połączenie motywów podróży i sportu tworzy wyjątkowy, spersonalizowany tort z charakterem.", flavor: "mleczna czekolada z chrupką i malinami", portions: 80, price: 1800 },
        13: { name: "Tort piętrowy elegancki", description: "Dwupoziomowa elegancja w najlepszym wydaniu. Utrzymany w stonowanych barwach, z subtelnym połyskiem i nowoczesną formą. Dla mężczyzny, który lubi styl i klasę.", flavor: "pistacja z malinami", portions: 25, price: 580 },
        14: { name: "Tort dwupiętrowy dla majsterkowicza", description: "Idealny dla złotej rączki! Dwupoziomowy tort z narzędziowymi akcentami to świetny pomysł na prezent dla pana, który uwielbia tworzyć, naprawiać i majsterkować.", flavor: "lekki i orzeźwiający z lemon curd oraz z kremem z serka mascarpone", portions: 30, price: 680 }
      },
      children: {},
      artistic: {}
    };

    let selectedOccasion = null;
    let selectedTaste = null;
    let selectedCake = null;
    let selectedCakeImageUrl = null; // Store the current cake image URL
    let selectedDecorations = [];
    let selectedDelivery = null;
    let customerData = {};
    let basePrice = 0;

    // Step management for browser navigation
    const STEPS = {
      OCCASION: 'occasion',
      GALLERY: 'gallery', 
      CONFIGURATION: 'configuration',
      CUSTOMER_DATA: 'customer-data',
      ORDER_SUMMARY: 'order-summary'
    };
    
    let currentStep = STEPS.OCCASION;

    // Initialize the page
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize browser history
      initializeBrowserHistory();
      
      // Handle browser back/forward buttons
      window.addEventListener('popstate', handlePopState);
      
      // Mobile menu toggle
      const mobileMenuButton = document.getElementById('mobile-menu-button');
      const mobileMenu = document.getElementById('mobile-menu');
      
      mobileMenuButton.addEventListener('click', function() {
        const isExpanded = mobileMenuButton.getAttribute('aria-expanded') === 'true';
        mobileMenuButton.setAttribute('aria-expanded', !isExpanded);
        mobileMenu.classList.toggle('hidden');
      });

      // Occasion selection
      const occasionCards = document.querySelectorAll('.occasion-card');
      occasionCards.forEach(card => {
        card.addEventListener('click', function() {
          const occasion = this.dataset.occasion;
          selectOccasion(occasion);
        });
      });

      // Back to occasions buttons
      document.getElementById('back-to-occasions-from-gallery').addEventListener('click', function() {
        navigateToStep(STEPS.OCCASION);
      });

      document.getElementById('back-to-gallery').addEventListener('click', function() {
        navigateToStep(STEPS.GALLERY);
      });

      // Finalize order button
      document.getElementById('finalize-order').addEventListener('click', function() {
        const tasteSelect = document.getElementById('taste-select');
        const selectedTasteValue = tasteSelect.value;

        if (!selectedTasteValue) {
          // Set custom error message for taste validation
          const errorMsg = document.getElementById('error-message');
          if (errorMsg) {
            errorMsg.textContent = 'Proszę wybrać smak tortu przed złożeniem zamówienia.';
          }
          // Show error modal for validation
          showModal('error-modal');
          return;
        }
        
        // Update selectedTaste if it's not set
        if (!selectedTaste) {
          selectedTaste = selectedTasteValue;
        }
        
        navigateToStep(STEPS.CUSTOMER_DATA);
      });

      // Custom text input
      document.getElementById('cake-text').addEventListener('input', function() {
        // Limit to 30 characters
        if (this.value.length > 30) {
          this.value = this.value.substring(0, 30);
        }
        updateOrderSummary();
        updateBrowserHistory();
      });

      document.getElementById('back-to-configuration').addEventListener('click', function() {
        navigateToStep(STEPS.CONFIGURATION);
      });

      document.getElementById('proceed-to-summary').addEventListener('click', function() {
        if (!validateCustomerForm()) {
          return;
        }
        collectCustomerData();
        navigateToStep(STEPS.ORDER_SUMMARY);
      });

      document.getElementById('back-to-customer-data').addEventListener('click', function() {
        navigateToStep(STEPS.CUSTOMER_DATA);
      });

      document.getElementById('confirm-order').addEventListener('click', function() {
        submitOrder();
      });

      // Initialize delivery options
      initializeDeliveryOptions();

      // Initialize customer form field listeners
      initializeCustomerFormListeners();

      // Set current year in footer
      document.getElementById('current-year').textContent = new Date().getFullYear();
    });

    function initializeBrowserHistory() {
      // Set initial state
      const state = {
        step: STEPS.OCCASION,
        occasion: null,
        cake: null,
        taste: null,
        decorations: [],
        delivery: null,
        customerData: {}
      };

      history.replaceState(state, '', window.location.pathname);
    }

    function handlePopState(event) {
      if (event.state) {
        const state = event.state;

        // Restore state
        selectedOccasion = state.occasion;
        selectedCake = state.cake;
        selectedTaste = state.taste;
        selectedDecorations = state.decorations || [];
        selectedDelivery = state.delivery;
        customerData = state.customerData || {};
        
        // Navigate to the step
        navigateToStep(state.step, false); // false = don't update history
      } else {
        // Fallback to occasion selector
        navigateToStep(STEPS.OCCASION, false);
      }
    }

    function navigateToStep(step, updateHistory = true) {
      currentStep = step;
      
      // Update history if needed
      if (updateHistory) {
        const state = {
          step: step,
          occasion: selectedOccasion,
          cake: selectedCake,
          taste: selectedTaste,
          decorations: selectedDecorations,
          delivery: selectedDelivery,
          customerData: customerData
        };
        
        const url = step === STEPS.OCCASION ? 
          window.location.pathname : 
          `${window.location.pathname}#${step}`;
        
        history.pushState(state, '', url);
      }
      
      // Show appropriate section
      switch (step) {
        case STEPS.OCCASION:
          showOccasionSelector();
          break;
        case STEPS.GALLERY:
          showCakeGallery();
          break;
        case STEPS.CONFIGURATION:
          showCakeConfiguration();
          break;
        case STEPS.CUSTOMER_DATA:
          showCustomerData();
          break;
        case STEPS.ORDER_SUMMARY:
          showOrderSummary();
          break;
      }
    }

    function selectOccasion(occasion) {
      selectedOccasion = occasion;
      navigateToStep(STEPS.GALLERY);
      loadCakeImages(occasion);
    }

    function loadCakeImages(occasion) {
      const cakeImages = document.getElementById('cake-images');
      cakeImages.innerHTML = '';
      
      const occasionData = cakeData[occasion];
      
      if (occasionData.imageCount === 0) {
        // No images available for this category
        cakeImages.innerHTML = `
          <div class="col-span-full text-center py-12">
            <i class="fa-solid fa-image text-6xl text-dove-gray mb-4"></i>
            <h3 class="text-xl font-bold text-midnight-navy mb-2">Brak zdjęć</h3>
            <p class="text-dove-gray">Zdjęcia dla tej kategorii będą dostępne wkrótce.</p>
          </div>
        `;
        return;
      }
      
      // Load images for the occasion
      for (let i = 1; i <= occasionData.imageCount; i++) {
        const imageCard = document.createElement('div');
        imageCard.className = 'vitreous-card p-4 cursor-pointer border-2 border-transparent hover:border-playful-pink transition-colors';
        imageCard.onclick = () => selectCake(occasion, i);
        
        // Map occasion to correct directory name
        const directoryMap = {
          'men': 'dal',
          'women': 'dla_kobiet',
          'baptism': 'chrzestne',
          'wedding': 'weselne',
          'bachelorette': 'wieczorpanienski',
          'babyshower': 'babyshower',
          'communion': 'komunia'
        };
        
        const directoryName = directoryMap[occasion] || occasionData.imagePrefix;
        const imageIndex = i.toString().padStart(2, '0');
        let imageSrc = `images/${directoryName}/${occasionData.imagePrefix}_${imageIndex}.png`;

        const cakeDetailForOccasion = cakeDetails[occasion];
        const cakeDetail = cakeDetailForOccasion ? cakeDetailForOccasion[i] : null;
        const cakeName = cakeDetail ? cakeDetail.name : `Tort ${i}`;
        const descriptionText = cakeDetail && cakeDetail.description
          ? (cakeDetail.description.length > 140 ? `${cakeDetail.description.slice(0, 137)}...` : cakeDetail.description)
          : 'Kliknij, aby wybrać';
        const metaInfo = cakeDetail
          ? `<div class="flex justify-center gap-3 mt-3 text-xs sm:text-sm text-dove-gray">
              <span class="font-medium">Porcje: ${cakeDetail.portions}</span>
              <span class="font-medium">Cena: ${cakeDetail.price} zł</span>
            </div>`
          : '';

        imageCard.innerHTML = `
          <div class="aspect-[3/4] rounded-lg overflow-hidden mb-4 bg-gradient-to-br from-champagne-gold/10 to-blush-rose/10">
            <img src="${imageSrc}" alt="${cakeName} - ${occasionData.name}" class="w-full h-full object-cover hover:scale-105 transition-transform duration-300" onload="handleImageLoad(this, '${occasionData.imagePrefix}', ${i})" onerror="handleImageError(this, '${occasionData.imagePrefix}', ${i})">
            <div class="w-full h-full flex items-center justify-center" style="display: none;">
              <img src="sygnet-cakebooking.svg" alt="CakeBooking" class="w-10 h-10 icon-gradient-gold-pink opacity-50">
            </div>
          </div>
          <h3 class="text-base font-bold text-midnight-navy text-center leading-snug">${cakeName}</h3>
          <p class="text-sm text-dove-gray text-center leading-relaxed mt-2">${descriptionText}</p>
          ${metaInfo}
        `;
        
        cakeImages.appendChild(imageCard);
      }
    }

    function selectCake(occasion, cakeNumber) {
      selectedCake = { occasion, cakeNumber };
      navigateToStep(STEPS.CONFIGURATION);
      updateCakeConfiguration();
    }

    function updateCakeConfiguration() {
      const occasionData = cakeData[selectedCake.occasion];
      
      // Map occasion to correct directory name
      const directoryMap = {
        'men': 'dal',
        'women': 'dla_kobiet',
        'baptism': 'chrzestne',
        'wedding': 'weselne',
        'bachelorette': 'wieczorpanienski',
        'babyshower': 'babyshower',
        'communion': 'komunia'
      };
      
      const directoryName = directoryMap[selectedCake.occasion] || occasionData.imagePrefix;

      // Try PNG first (as mentioned by user), with JPEG fallback
      const cakeImageBase = `images/${directoryName}/${occasionData.imagePrefix}_${selectedCake.cakeNumber.toString().padStart(2, '0')}`;
      const cakeImageSrc = `${cakeImageBase}.png`;

      // Store the current cake image URL (base path for webhook)
      selectedCakeImageUrl = cakeImageSrc;

      const cakeDetailForOccasion = cakeDetails[selectedCake.occasion];
      const cakeDetail = cakeDetailForOccasion ? cakeDetailForOccasion[selectedCake.cakeNumber] : null;

      // Update cake preview
      const previewContainer = document.getElementById('selected-cake-preview');
      previewContainer.innerHTML = `
        <img src="${cakeImageSrc}" alt="Wybrany tort" class="w-full h-full object-cover rounded-lg" onload="handleConfigImageLoad(this, '${occasionData.imagePrefix}', ${selectedCake.cakeNumber})" onerror="handleConfigImageError(this, '${occasionData.imagePrefix}', ${selectedCake.cakeNumber})">
        <div class="w-full h-full flex items-center justify-center" style="display: none;">
          <img src="sygnet-cakebooking.svg" alt="CakeBooking" class="w-16 h-16 icon-gradient-gold-pink opacity-50">
        </div>
      `;
      
      // Update cake info
      const cakeInfo = document.getElementById('cake-info');
      if (cakeDetail) {
        cakeInfo.innerHTML = `
          <div class="space-y-4">
            <div>
              <p class="text-xs uppercase tracking-widest text-dove-gray mb-1">${occasionData.name}</p>
              <h4 class="font-bold text-xl text-midnight-navy leading-snug">${cakeDetail.name}</h4>
              <p class="text-sm text-dove-gray leading-relaxed mt-2">${cakeDetail.description}</p>
            </div>
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 text-sm text-midnight-navy font-medium">
              <span>Porcje: ${cakeDetail.portions}</span>
              <span>Cena: <span class="icon-gradient-gold-pink font-semibold">${cakeDetail.price} zł</span></span>
            </div>
            <div class="text-sm text-midnight-navy">
              <span class="font-medium block mb-1">Rekomendowany smak</span>
              <span class="text-dove-gray">${cakeDetail.flavor}</span>
            </div>
          </div>
        `;
      } else {
        cakeInfo.innerHTML = `
          <div>
            <h4 class="font-bold text-midnight-navy">${occasionData.name}</h4>
            <p class="text-sm text-dove-gray">Tort ${selectedCake.cakeNumber}</p>
          </div>
        `;
      }
      
      // Populate taste options
      const tasteSelect = document.getElementById('taste-select');
      const tastePlaceholder = cakeDetail && cakeDetail.flavor
        ? `Wybierz smak tortu (rekomendacja: ${cakeDetail.flavor})`
        : 'Wybierz smak tortu';
      tasteSelect.innerHTML = `<option value="">${tastePlaceholder}</option>`;
      selectedTaste = null;
      tasteSelect.value = '';
      
      occasionData.tastes.forEach((taste, index) => {
        const option = document.createElement('option');
        option.value = taste;
        option.textContent = taste;
        tasteSelect.appendChild(option);
      });

      // Initialize decoration checkboxes
      initializeDecorationCheckboxes();
      
      // Initialize taste select
      initializeTasteSelect();
      
      // Update order summary
      updateOrderSummary();
    }

    function initializeDecorationCheckboxes() {
      const checkboxes = document.querySelectorAll('.decoration-checkbox');
      checkboxes.forEach(checkbox => {
        checkbox.onchange = () => {
          const decoration = checkbox.dataset.decoration;
          const price = parseInt(checkbox.dataset.price);
          
          if (checkbox.checked) {
            if (!selectedDecorations.find(d => d.name === decoration)) {
              selectedDecorations.push({ name: decoration, price: price });
            }
            
            // Show text input if text decoration is selected
            if (decoration === 'text') {
              document.getElementById('custom-text-input').classList.remove('hidden');
            }
          } else {
            selectedDecorations = selectedDecorations.filter(d => d.name !== decoration);
            
            // Hide text input if text decoration is deselected
            if (decoration === 'text') {
              document.getElementById('custom-text-input').classList.add('hidden');
              document.getElementById('cake-text').value = '';
            }
          }
          
          updateOrderSummary();
          updateBrowserHistory();
        };
      });
    }

    function initializeTasteSelect() {
      const tasteSelect = document.getElementById('taste-select');
      tasteSelect.onchange = () => {
        selectedTaste = tasteSelect.value;
        updateOrderSummary();
        updateBrowserHistory();
      };
    }

    function updateBrowserHistory() {
      // Update the current history entry with new state
      const state = {
        step: currentStep,
        occasion: selectedOccasion,
        cake: selectedCake,
        taste: selectedTaste,
        decorations: selectedDecorations,
        delivery: selectedDelivery,
        customerData: customerData
      };

      const url = currentStep === STEPS.OCCASION ?
        window.location.pathname :
        `${window.location.pathname}#${currentStep}`;

      history.replaceState(state, '', url);
    }

    function buildCakeSummaryContent(occasionData, cakeDetail, cakeNumber) {
      if (!occasionData) {
        return '';
      }

      if (!cakeDetail) {
        return `
          <div class="flex justify-between items-center">
            <span class="text-midnight-navy">${occasionData.name} - Tort ${cakeNumber}</span>
            <span class="icon-gradient-gold-pink">-</span>
          </div>
        `;
      }

      const portionsBlock = typeof cakeDetail.portions !== 'undefined' && cakeDetail.portions !== null
        ? `<div class="text-sm text-midnight-navy font-medium">Ilość porcji: ${cakeDetail.portions}</div>`
        : '';
      const descriptionBlock = cakeDetail.description
        ? `<p class="text-sm text-dove-gray leading-relaxed">${cakeDetail.description}</p>`
        : '';
      const flavorBlock = cakeDetail.flavor
        ? `<p class="text-sm text-dove-gray"><span class="font-medium text-midnight-navy">Rekomendowany smak:</span> ${cakeDetail.flavor}</p>`
        : '';

      return `
        <div class="space-y-3">
          <div class="flex justify-between items-center">
            <span class="text-midnight-navy font-semibold">${cakeDetail.name}</span>
            <span class="icon-gradient-gold-pink font-semibold">Cena bazowa: ${cakeDetail.price} zł</span>
          </div>
          ${portionsBlock}
          ${descriptionBlock}
          ${flavorBlock}
        </div>
      `;
    }

    function updateOrderSummary() {
      const summary = document.getElementById('order-summary');
      const totalPrice = document.getElementById('total-price');

      let total = 0;
      let summaryHTML = '';

      // Base cake with static price and portions
      if (selectedCake) {
        const occasionData = cakeData[selectedCake.occasion];
        const cakeDetail = cakeDetails[selectedCake.occasion] && cakeDetails[selectedCake.occasion][selectedCake.cakeNumber];

        if (cakeDetail) {
          total += cakeDetail.price;
        }

        summaryHTML += buildCakeSummaryContent(occasionData, cakeDetail, selectedCake.cakeNumber);
      }

      // Taste
      if (selectedTaste) {
        summaryHTML += `
          <div class="flex justify-between items-center">
            <span class="text-midnight-navy">Smak: ${selectedTaste}</span>
            <span class="icon-gradient-gold-pink">-</span>
          </div>
        `;
      }
      
      // Decorations
      selectedDecorations.forEach(decoration => {
        total += decoration.price;
        let decorationName = decoration.name;
        
        // Add custom text if available
        if (decoration.name === 'text') {
          const customText = document.getElementById('cake-text').value;
          if (customText) {
            decorationName = `Napisy: "${customText}"`;
          }
        }
        
        summaryHTML += `
          <div class="flex justify-between items-center">
            <span class="text-midnight-navy">+ ${decorationName}</span>
            <span class="icon-gradient-gold-pink">+${decoration.price} zł</span>
          </div>
        `;
      });
      
      summary.innerHTML = summaryHTML;
      totalPrice.textContent = `${total} zł`;
    }

    function showOccasionSelector() {
      document.getElementById('occasion-selector').classList.remove('hidden');
      document.getElementById('cake-gallery').classList.add('hidden');
      document.getElementById('cake-configuration').classList.add('hidden');
      document.getElementById('customer-data').classList.add('hidden');
      document.getElementById('order-summary-page').classList.add('hidden');
      
      // Scroll to occasion selector
      const anchor = document.getElementById('occasion-selector');
      if (anchor) {
        anchor.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    }

    function showCakeGallery() {
      document.getElementById('occasion-selector').classList.add('hidden');
      document.getElementById('cake-gallery').classList.remove('hidden');
      document.getElementById('cake-configuration').classList.add('hidden');
      document.getElementById('customer-data').classList.add('hidden');
      document.getElementById('order-summary-page').classList.add('hidden');
      
      // Scroll to cake gallery
      const anchor = document.getElementById('cake-gallery');
      if (anchor) {
        anchor.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
      
      // Load images if we have an occasion selected
      if (selectedOccasion) {
        loadCakeImages(selectedOccasion);
      }
    }

    function showCakeConfiguration() {
      document.getElementById('occasion-selector').classList.add('hidden');
      document.getElementById('cake-gallery').classList.add('hidden');
      document.getElementById('cake-configuration').classList.remove('hidden');
      document.getElementById('customer-data').classList.add('hidden');
      document.getElementById('order-summary-page').classList.add('hidden');
      
      // Scroll to configurator header
      const anchor = document.getElementById('cake-config-anchor');
      if (anchor) {
        anchor.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
      
      // Update configuration if we have a cake selected
      if (selectedCake) {
        updateCakeConfiguration();
      }
    }

    function showCustomerData() {
      document.getElementById('occasion-selector').classList.add('hidden');
      document.getElementById('cake-gallery').classList.add('hidden');
      document.getElementById('cake-configuration').classList.add('hidden');
      document.getElementById('customer-data').classList.remove('hidden');
      document.getElementById('order-summary-page').classList.add('hidden');
      
      // Scroll to customer data section
      const anchor = document.getElementById('customer-data');
      if (anchor) {
        anchor.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
      
      // Restore form data if available
      if (customerData.firstName) {
        document.getElementById('firstName').value = customerData.firstName;
        document.getElementById('lastName').value = customerData.lastName;
        document.getElementById('email').value = customerData.email;
        document.getElementById('phone').value = customerData.phone;
        
        if (customerData.address) {
          document.getElementById('street').value = customerData.address.street;
          document.getElementById('postalCode').value = customerData.address.postalCode;
          document.getElementById('city').value = customerData.address.city;
        }
        
        // Restore delivery selection
        if (selectedDelivery) {
          document.querySelectorAll('.delivery-option').forEach(opt => {
            opt.classList.remove('selected', 'border-playful-pink', 'bg-playful-pink/5');
            opt.classList.add('border-transparent');
          });
          
          const selectedOption = document.querySelector(`[data-delivery="${selectedDelivery}"]`);
          if (selectedOption) {
            selectedOption.classList.remove('border-transparent');
            selectedOption.classList.add('selected', 'border-playful-pink', 'bg-playful-pink/5');
            
            if (selectedDelivery === 'delivery') {
              document.getElementById('delivery-address').classList.remove('hidden');
            }
          }
        }
      }
    }

    function showOrderSummary() {
      // Hide all other sections and show order summary
      document.getElementById('occasion-selector').classList.add('hidden');
      document.getElementById('cake-gallery').classList.add('hidden');
      document.getElementById('cake-configuration').classList.add('hidden');
      document.getElementById('customer-data').classList.add('hidden');
      document.getElementById('order-summary-page').classList.remove('hidden');
      
      // Scroll to order summary section
      const anchor = document.getElementById('order-summary-page');
      if (anchor) {
        anchor.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
      
      // Populate order summary
      const finalOrderSummary = document.getElementById('final-order-summary');
      const finalTotalPrice = document.getElementById('final-total-price');

      let total = 0;
      let summaryHTML = '';

      // Base cake with static price and portions
      if (selectedCake) {
        const occasionData = cakeData[selectedCake.occasion];
        const cakeDetail = cakeDetails[selectedCake.occasion] && cakeDetails[selectedCake.occasion][selectedCake.cakeNumber];

        if (cakeDetail) {
          total += cakeDetail.price;
        }

        summaryHTML += buildCakeSummaryContent(occasionData, cakeDetail, selectedCake.cakeNumber);
      }

      // Taste
      if (selectedTaste) {
        summaryHTML += `
          <div class="flex justify-between items-center">
            <span class="text-midnight-navy">Smak: ${selectedTaste}</span>
            <span class="icon-gradient-gold-pink">-</span>
          </div>
        `;
      }
      
      // Decorations
      selectedDecorations.forEach(decoration => {
        total += decoration.price;
        let decorationName = decoration.name;
        
        if (decoration.name === 'text') {
          const customText = document.getElementById('cake-text').value;
          if (customText) {
            decorationName = `Napisy: "${customText}"`;
          }
        }
        
        summaryHTML += `
          <div class="flex justify-between items-center">
            <span class="text-midnight-navy">+ ${decorationName}</span>
            <span class="icon-gradient-gold-pink">+${decoration.price} zł</span>
          </div>
        `;
      });
      
      // Delivery
      if (selectedDelivery === 'delivery') {
        total += 15;
        summaryHTML += `
          <div class="flex justify-between items-center">
            <span class="text-midnight-navy">Dostawa</span>
            <span class="icon-gradient-gold-pink">+15 zł</span>
          </div>
        `;
      }
      
      finalOrderSummary.innerHTML = summaryHTML;
      finalTotalPrice.textContent = `${total} zł`;
      
      // Populate customer summary
      const customerSummary = document.getElementById('customer-summary');
      if (customerData.firstName) {
        customerSummary.innerHTML = `
          <div class="space-y-2">
            <div><strong>Imię i nazwisko:</strong> ${customerData.firstName} ${customerData.lastName}</div>
            <div><strong>Email:</strong> ${customerData.email}</div>
            <div><strong>Telefon:</strong> ${customerData.phone}</div>
          </div>
        `;
      }
      
      // Populate delivery summary
      const deliverySummary = document.getElementById('delivery-summary');
      if (selectedDelivery === 'pickup') {
        deliverySummary.innerHTML = `
          <div class="space-y-2">
            <div><strong>Sposób:</strong> Odbór własny</div>
            <div class="text-sm text-dove-gray">Bezpłatnie</div>
          </div>
        `;
      } else if (selectedDelivery === 'delivery' && customerData.address) {
        deliverySummary.innerHTML = `
          <div class="space-y-2">
            <div><strong>Sposób:</strong> Dostawa</div>
            <div><strong>Adres:</strong></div>
            <div class="text-sm text-dove-gray">
              ${customerData.address.street}<br>
              ${customerData.address.postalCode} ${customerData.address.city}
            </div>
            <div class="text-sm text-dove-gray">Koszt: +15 zł</div>
          </div>
        `;
      }
    }

    function initializeDeliveryOptions() {
      const deliveryOptions = document.querySelectorAll('.delivery-option');
      deliveryOptions.forEach(option => {
        option.onclick = () => {
          // Remove selection from all options
          deliveryOptions.forEach(opt => {
            opt.classList.remove('selected', 'border-playful-pink', 'bg-playful-pink/5');
            opt.classList.add('border-transparent');
          });
          
          // Select clicked option
          option.classList.remove('border-transparent');
          option.classList.add('selected', 'border-playful-pink', 'bg-playful-pink/5');
          
          selectedDelivery = option.dataset.delivery;
          
          // Show/hide delivery address
          const deliveryAddress = document.getElementById('delivery-address');
          if (selectedDelivery === 'delivery') {
            deliveryAddress.classList.remove('hidden');
            // Make address fields required
            document.getElementById('street').required = true;
            document.getElementById('postalCode').required = true;
            document.getElementById('city').required = true;
          } else {
            deliveryAddress.classList.add('hidden');
            // Remove required from address fields
            document.getElementById('street').required = false;
            document.getElementById('postalCode').required = false;
            document.getElementById('city').required = false;
          }
          
          updateBrowserHistory();
        };
      });
    }

    function validateCustomerForm() {
      const requiredFields = ['firstName', 'lastName', 'email', 'phone', 'completionDate', 'completionTime'];
      let isValid = true;

      requiredFields.forEach(fieldId => {
        const field = document.getElementById(fieldId);
        if (!field.value.trim()) {
          field.style.borderColor = '#ef4444';
          isValid = false;
        } else {
          field.style.borderColor = '';
        }
      });

      if (!selectedDelivery) {
        // Set custom error message for delivery validation
        const errorMsg = document.getElementById('error-message');
        if (errorMsg) {
          errorMsg.textContent = 'Proszę wybrać sposób odbioru zamówienia.';
        }
        // Show error modal for validation
        showModal('error-modal');
        isValid = false;
      }

      if (selectedDelivery === 'delivery') {
        const addressFields = ['street', 'postalCode', 'city'];
        addressFields.forEach(fieldId => {
          const field = document.getElementById(fieldId);
          if (!field.value.trim()) {
            field.style.borderColor = '#ef4444';
            isValid = false;
          } else {
            field.style.borderColor = '';
          }
        });
      }

      if (!isValid) {
        // Set custom error message for required fields validation
        const errorMsg = document.getElementById('error-message');
        if (errorMsg) {
          errorMsg.textContent = 'Proszę wypełnić wszystkie wymagane pola.';
        }
        // Show error modal for validation
        showModal('error-modal');
      }

      return isValid;
    }

    function collectCustomerData() {
      customerData = {
        firstName: document.getElementById('firstName').value,
        lastName: document.getElementById('lastName').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        orderNotes: document.getElementById('orderNotes').value,
        completionDate: document.getElementById('completionDate').value,
        completionTime: document.getElementById('completionTime').value,
        delivery: selectedDelivery,
        address: selectedDelivery === 'delivery' ? {
          street: document.getElementById('street').value,
          postalCode: document.getElementById('postalCode').value,
          city: document.getElementById('city').value
        } : null
      };
    }

    async function submitOrder() {
      // Get cake details
      const cakeDetail = selectedCake ? cakeDetails[selectedCake.occasion] && cakeDetails[selectedCake.occasion][selectedCake.cakeNumber] : null;

      // Prepare order data
      const orderData = {
        cake: selectedCake,
        cakeDetail: cakeDetail, // Include static cake details (name, flavor, portions, price)
        taste: selectedTaste,
        decorations: selectedDecorations,
        delivery: selectedDelivery,
        customer: customerData,
        total: calculateTotal(),
        cakeImageUrl: selectedCakeImageUrl, // Use stored relative path
        orderType: 'ready_cake' // Specify this is from ready cake selection
      };

      console.log('Submitting order:', orderData);

      // Show loading state
      const confirmButton = document.getElementById('confirm-order');
      const originalText = confirmButton.innerHTML;
      confirmButton.disabled = true;
      confirmButton.innerHTML = '<i class="fa-solid fa-spinner fa-spin h-5 w-5 mr-3"></i>Przetwarzanie...';

      try {
        // Send order data to webhook
        const success = await sendOrderFormToWebhook(orderData, {
          cakeDetails: selectedCake,
          cakeStaticDetails: cakeDetail,
          tasteDetails: selectedTaste,
          decorationDetails: selectedDecorations
        });

        if (success) {
          // Show success modal
          showModal('success-modal');

          // Reset form and go back to start
          resetForm();
          showOccasionSelector();
        } else {
          // Reset error message to default for submission errors
          const errorMsg = document.getElementById('error-message');
          if (errorMsg) {
            errorMsg.textContent = 'Wystąpił błąd podczas składania zamówienia. Spróbuj ponownie lub skontaktuj się z nami telefonicznie.';
          }
          // Show error modal
          showModal('error-modal');
        }
      } catch (error) {
        console.error('Order submission error:', error);
        // Reset error message to default for submission errors
        const errorMsg = document.getElementById('error-message');
        if (errorMsg) {
          errorMsg.textContent = 'Wystąpił błąd podczas składania zamówienia. Spróbuj ponownie lub skontaktuj się z nami telefonicznie.';
        }
        // Show error modal
        showModal('error-modal');
      } finally {
        // Reset button state
        confirmButton.disabled = false;
        confirmButton.innerHTML = originalText;
      }
    }

    function calculateTotal() {
      let total = 0;

      if (selectedCake) {
        const cakeDetail = cakeDetails[selectedCake.occasion] && cakeDetails[selectedCake.occasion][selectedCake.cakeNumber];
        if (cakeDetail) {
          total += cakeDetail.price;
        }
      }
      
      selectedDecorations.forEach(decoration => {
        total += decoration.price;
      });
      
      if (selectedDelivery === 'delivery') {
        total += 15;
      }
      
      return total;
    }

    function resetForm() {
      // Reset all selections
      selectedOccasion = null;
      selectedTaste = null;
      selectedCake = null;
      selectedDecorations = [];
      selectedDelivery = null;
      customerData = {};
      
      // Reset form fields
      document.getElementById('customer-form').reset();
      document.getElementById('delivery-address').classList.add('hidden');
      
      // Reset delivery selection
      document.querySelectorAll('.delivery-option').forEach(opt => {
        opt.classList.remove('selected', 'border-champagne-gold', 'bg-champagne-gold/5');
        opt.classList.add('border-transparent');
      });
      
      // Reset taste selection
      document.getElementById('taste-select').value = '';
      
      // Reset decoration checkboxes
      document.querySelectorAll('.decoration-checkbox').forEach(checkbox => {
        checkbox.checked = false;
      });
      
      document.getElementById('custom-text-input').classList.add('hidden');
      document.getElementById('cake-text').value = '';
    }

    function handleImageLoad(img, prefix, number) {
      // Store the successful image URL for webhook messages
      const imageUrl = img.src;
      const cakeKey = `${prefix}_${number}`;
      if (window.successfulCakeImages) {
        window.successfulCakeImages[cakeKey] = imageUrl;
      } else {
        window.successfulCakeImages = {};
        window.successfulCakeImages[cakeKey] = imageUrl;
      }
    }

    function handleConfigImageLoad(img, prefix, number) {
      // Update the selected cake image URL with the correct extension
      selectedCakeImageUrl = img.src;
    }

    function handleImageError(img, prefix, number) {
      const extensions = ['png', 'jpg', 'jpeg']; // Try all formats
      const currentSrc = img.src;
      const currentExt = currentSrc.split('.').pop();

      // Extract directory from current path
      const pathParts = currentSrc.split('/');
      const directory = pathParts[pathParts.length - 2];

      // Get all tried extensions from onerror calls
      const triedExtensions = img.dataset.triedExtensions ? img.dataset.triedExtensions.split(',') : [];

      // Add current extension to tried list
      triedExtensions.push(currentExt);
      img.dataset.triedExtensions = triedExtensions.join(',');

      // Find next extension to try
      const nextExt = extensions.find(ext => !triedExtensions.includes(ext));

      if (nextExt) {
        // Try next extension
        const newSrc = `images/${directory}/${prefix}_${number.toString().padStart(2, '0')}.${nextExt}`;
        img.src = newSrc;
      } else {
        // All extensions failed, show placeholder
        img.style.display = 'none';
        img.nextElementSibling.style.display = 'flex';
      }
    }

    function handleConfigImageError(img, prefix, number) {
      const extensions = ['png', 'jpg', 'jpeg']; // Try all formats
      const currentSrc = img.src;
      const currentExt = currentSrc.split('.').pop();

      // Extract directory from current path
      const pathParts = currentSrc.split('/');
      const directory = pathParts[pathParts.length - 2];

      // Get all tried extensions from onerror calls
      const triedExtensions = img.dataset.triedExtensions ? img.dataset.triedExtensions.split(',') : [];

      // Add current extension to tried list
      triedExtensions.push(currentExt);
      img.dataset.triedExtensions = triedExtensions.join(',');

      // Find next extension to try
      const nextExt = extensions.find(ext => !triedExtensions.includes(ext));

      if (nextExt) {
        // Try next extension
        const newSrc = `images/${directory}/${prefix}_${number.toString().padStart(2, '0')}.${nextExt}`;
        img.src = newSrc;
      } else {
        // All extensions failed, show placeholder
        img.style.display = 'none';
        img.nextElementSibling.style.display = 'flex';
      }
    }

    function initializeCustomerFormListeners() {
      const formFields = ['firstName', 'lastName', 'email', 'phone', 'street', 'postalCode', 'city'];
      
      formFields.forEach(fieldId => {
        const field = document.getElementById(fieldId);
        if (field) {
          field.addEventListener('input', function() {
            // Update customerData object
            if (fieldId === 'street' || fieldId === 'postalCode' || fieldId === 'city') {
              if (!customerData.address) {
                customerData.address = {};
              }
              customerData.address[fieldId] = this.value;
            } else {
              customerData[fieldId] = this.value;
            }
            
            updateBrowserHistory();
          });
        }
      });
    }
  </script>

  <script src="scripts.js"></script>
  <script src="cookies.js"></script>
</body>
</html> 
